var magellan=angular.module("magellan",["ui.router","ngProgress","ngAnimate"],["$httpProvider",function(e){e.interceptors.push("AuthInterceptor")}]);magellan.constant("AppConfig",{"log.info":!0,"log.error":!0,"quiz.country.questions":3,"quiz.country.types":{1:"CAPITAL_OF_COUNTRY",2:"COUNTRY_OF_CAPITAL",3:"POPULATION_OF_COUNTRY",4:"AREA_OF_COUNTRY",5:"FLAG_OF_COUNTRY"},"settings.user.colors":["soft_red","thunderbird","old_brick","new_york_pink","snuff","honey_flower","san_marino","shakespeare","ming","gossip","eucalyptus","mountain_meadow","jade","confetti","california","burnt_orange","jaffa","gallery","edward","lynch"]}),magellan.controller("AppCtrl",["$scope","$state","UserSrv","CountrySrv","QuizSrv",function(e,n,t,r,i){e.app={config:{title:"Magellan",subtitle:"Test your knowledge about the countries of our world",author:"Michael Stifter"}},t.getUserFromStorage().then(function(n){e.user=n,e.$broadcast("user.loaded"),r.init().then(function(n){e.$broadcast("countries.loaded",n),i.setCountries(n)})})["catch"](function(e){}),e.isProgressBarVisible=function(){return n.is("quiz")},e.$on("app.login",function(t,o){e.user=o,r.init().then(function(n){e.$broadcast("countries.loaded",n),i.setCountries(n)}),n.go("quiz")}),e.$on("app.logout",function(t,r){e.user=null,n.go("home")})}]);var Quiz=function(){var e=null,n=[];this.start=function(){if(n.length<=0)throw Error("Cannot start a quiz without questions");return this.nextQuestion()},this.isActive=function(){return this.hasStarted()&&!this.hasEnded()},this.hasStarted=function(){return null!==e},this.hasEnded=function(){return this.hasStarted()&&e>=n.length},this.submitted=!1,this.addQuestion=function(e){if(void 0===e)throw Error("No question object passed");var t=!0,r=["config","hint","solution","answer","question","getInfo","info","points","answered","hintsAllowed","hintsRemaining"];r.forEach(function(n){if(!e.hasOwnProperty(n))throw t=!1,new Error("Question must have property '"+n+"'")}),t&&n.push(e)},this.nextQuestion=function(){return null===e?e=0:e++,!this.hasEnded()&&n[e]},this.currentQuestion=function(){return this.isActive()?n[e]:null},this.getTotalPoints=function(){if(!this.hasStarted())return null;var e=0;return n.forEach(function(n){var t=n.points();void 0!==t&&(e+=t)}),e},this.getCurrentQuestionNumber=function(){return null===e?null:e+1},this.getNumberOfQuestions=function(){return n.length}},Question=function(e){var n=null,t=null,r=null,i=null,o=0,u=null,a=null,s=!1,l=function(e){n=e.text,t=e.info||{},r=e.answer,u=e.checkAnswer||null,i=e.hints||{allowed:!1,maximum:0,cost:0,give:null}};e&&l(e),this.config=function(e){l(e)},this.question=function(){return n},this.info=function(e,n){return void 0===n?t[e]:void(t[e]=n)},this.getInfo=function(){return t},this.solution=function(){return s?r:null},this.hint=function(){if(!i.allowed)return null;if(i.allowed&&!i.give)throw new Error("Hints allowed but no give method passed");return o<i.maximum&&o++,i.give(o,r)},this.answer=function(e){if(!s&&u)return s=!0,a=u(r,e,o,i.cost,t),a=Math.max(0,a),a=Math.floor(a)},this.points=function(){if(s&&null!==a)return a},this.answered=function(){return s},this.hintsAllowed=function(){return null!==i?i.allowed:null},this.hintsRemaining=function(){var e=this.hintsAllowed();return null===e||e===!1?null:i.maximum-o}},getRandomInt=function(e,n){return Math.floor(Math.random()*(n-e+1))+e},getStringBetween=function(e,n,t){var r=e.indexOf(n),i=e.indexOf(t);return r>=0&&i>=0&&i>r?e.substr(r+1,i-r-1):null};"undefined"!=typeof module&&module.exports&&(module.exports.Question=Question,module.exports.Quiz=Quiz),angular.module("magellan").config(["$locationProvider","$stateProvider","$urlRouterProvider",function(e,n,t){e.html5Mode(!0),t.otherwise("/home"),n.state("home",{url:"/home",templateUrl:"/build/views/partials/home.partial.html",params:{action:null}}).state("quiz",{url:"/quiz",templateUrl:"/build/views/partials/quiz.partial.html"}).state("countries",{url:"/countries",templateUrl:"/build/views/partials/countries.partial.html"}).state("countries.detail",{url:"/:alpha3Code",templateUrl:"/build/views/partials/countries-detail.partial.html"}).state("login",{url:"/login",templateUrl:"/build/views/partials/login.partial.html"}).state("logout",{url:"/logout",controller:"LogoutCtrl"}).state("register",{url:"/register",templateUrl:"/build/views/partials/register.partial.html"}).state("settings",{url:"/settings",templateUrl:"/build/views/partials/settings.partial.html"}).state("about",{url:"/about",templateUrl:"/build/views/partials/about.partial.html"}).state("highscore",{url:"/highscore",templateUrl:"/build/views/partials/highscore.partial.html"}).state("countries-difficulty",{url:"/countries-difficulty",templateUrl:"/build/views/partials/country-difficulty.partial.html"})}]),angular.module("magellan").controller("CountriesCtrl",["$scope","CountrySrv",function(e,n){var t=null,r=null,i=function(){t=n.getCountriesByLetter(),r=Object.keys(t),e.$$phase?(e.countryKeys=r,e.countriesByLetter=t):e.$apply(function(){e.countryKeys=r,e.countriesByLetter=t})};n.areCountriesLoaded()&&i(),e.$on("countries.loaded",function(){i()})}]),angular.module("magellan").controller("CountryDetailCtrl",["$scope","CountrySrv","$stateParams",function(e,n,t){var r=t.alpha3Code;n.areCountriesLoaded()&&(e.country=n.getCountryByAlpha3(r)),e.$on("countries.loaded",function(){e.$apply(function(){e.country=n.getCountryByAlpha3(r)})});var i=function(e){return n.getCountryByAlpha3(e)};e.getCountryFromService=i}]),angular.module("magellan").controller("CountryDifficultyCtrl",["$scope","CountrySrv",function(e,n){var t=function(){var t=n.getCountries(),r={easy:[],medium:[],hard:[],unassigned:[]};t.sort(function(e,n){return n.population-e.population}).forEach(function(e){e.subregion.indexOf("Europe")>=0||e.subregion.indexOf("Australia and New Zealand")>=0||e.subregion.indexOf("South America")>=0&&e.population>=25e6||e.subregion.indexOf("Northern America")>=0||e.subregion.indexOf("Central America")>=0&&e.population>=1e8||e.subregion.indexOf("Africa")>=0&&e.population>=1e8||e.subregion.indexOf("Asia")>=0&&e.population>=5e8||"Türkei"===e.name?e.difficulty="easy":e.subregion.indexOf("Africa")>=0&&e.population>=15e6||e.subregion.indexOf("Asia")>=0&&e.population>=1e7||e.subregion.indexOf("South America")>=0&&e.population>=1e6||e.subregion.indexOf("Central America")>=0&&e.population>=1e7||e.subregion.indexOf("Caribbean")>=0&&e.population>=1e6||["Tunesien","Aserbaidschan","Vereinigte Arabische Emirate","Georgien","Armenien"].indexOf(e.name)>=0?e.difficulty="medium":e.subregion.indexOf("South America")>=0&&e.population<1e6||e.subregion.indexOf("Africa")>=0&&e.population<15e6||e.subregion.indexOf("Asia")>=0&&e.population<1e7||e.subregion.indexOf("Central America")>=0&&e.population<1e7||e.subregion.indexOf("Caribbean")>=0&&e.population<1e6||e.region.indexOf("Oceania")>=0&&"Australia and New Zealand"!==e.subregion?e.difficulty="hard":e.difficulty="unassigned",r[e.difficulty].push(e)}),e.$$phase?(e.difficulties=r,e.difficultyKeys=Object.keys(r)):e.$apply(function(){e.difficulties=r,e.difficultyKeys=Object.keys(r)})};n.areCountriesLoaded()&&t(),e.$on("countries.loaded",function(e,n){t()})}]),angular.module("magellan").controller("DropdownCtrl",["$scope",function(e){function n(){o=!o}function t(){o=!0}function r(){o=!1}function i(){return o}var o=!1;e.toggleDropdown=n,e.showDropdown=t,e.hideDropdown=r,e.isDropdownVisible=i,e.handleClickOutside=function(e){console.log("CLICKED OUTSIDE")}}]),angular.module("magellan").controller("HighscoreCtrl",["$scope","ScoreSrv","LogSrv",function(e,n,t){e.scoreList=[],n.getHighscoreList().then(function(n){e.$$phase?e.scoreList=i(n):e.$apply(function(){e.scoreList=i(n)})})["catch"](function(e){t.error(e)});var r=function(n){return e.user._id===n},i=function(e){var n=0,t=null;return e.forEach(function(e){t&&e.score===t||(n++,e.rank=n+"."),t=e.score}),e};e.isMyself=r}]),angular.module("magellan").controller("HomeCtrl",["$scope","LogSrv","$stateParams",function(e,n,t){if(e.message=null,t.action){var r=t.action;switch(r){case"register.successful":e.message={type:"success",text:"Gratulation! Die Anmeldung war erfolgreich. Herzlich willkommen bei Magellan."};break;default:e.message=null}}}]),angular.module("magellan").controller("LoginCtrl",["$scope","UserSrv","FocusSrv",function(e,n,t){e.message=null,e.login=function(t,r){n.login(t,r).then(function(n){e.message=null,e.$emit("app.login",n.data)})["catch"](function(n){console.error(n);var t;t=401===n.status?"Falscher Benutzername oder Passwort":"Beim Einloggen scheint etwas schief gegangen zu sein",e.message={type:"error",text:t}})},t("#username")}]),angular.module("magellan").controller("LogoutCtrl",["$scope","UserSrv",function(e,n){n.logout().then(function(){e.$emit("app.logout")})}]),angular.module("magellan").controller("QuizDirectiveController",["$scope","QuizSrv","LogSrv","FocusSrv","ngProgressFactory","$filter",function(e,n,t,r,i,o){var u,a=function(){e.progressbar=i.createInstance(),e.progressbar.setParent(document.getElementById("quiz-progress")),e.progressbar.setAbsolute(),e.progressbar.setColor("#336e7b"),e.isResultsPageVisible=!1,e.achievements=[],e.bests=[],e.answerInput={},e.hint=null,e.multiplierOptions=[{value:1,label:""},{value:1e3,label:"Tsd."},{value:1e6,label:"Mio."}],u=null},s=function(){if(u=n.getCurrentQuestion(),e.hint=null,null!==u){if(u.getInfo().input&&0===u.getInfo().input.indexOf("number"))switch(u.getInfo().input){case"number.high":e.answerInput.multiplier={value:1e6,label:"Mio."};break;case"number.medium":e.answerInput.multiplier={value:1e3,label:"Tsd."};break;default:e.answerInput.multiplier={value:1,label:""}}else e.answerInput.multiplier=null;A(),r(".answerInput")}else e.progressbar.set(0)},l=function(){return u},c=function(){return n.getCurrentQuestionNumber()},f=function(){return n.getNumberOfQuizQuestions()},d=function(){return C(l().question(),"question-highlight")+"?"},g=function(){return u&&u.getInfo().media?u.getInfo().media:null},p=function(){e.isResultsPageVisible=!0},h=function(){e.$$phase?e.isResultsPageVisible=!1:e.$apply(function(){e.isResultsPageVisible=!1})},m=function(){return null!==u&&(null!==u.hintsRemaining()&&u.hintsRemaining()>0)},v=function(){if(e.answerInput.answer&&!u.answered()){var n=String(e.answerInput.answer);u.getInfo().input&&0===u.getInfo().input.indexOf("number")&&(n=n.replace(",",".")),e.answerInput.multiplier&&(n*=e.answerInput.multiplier.value),t.info("submitting answer",n),e.answerInput.points=u.answer(n),r(_()?"#btnContinueFinished  ":"#btnNextQuestion")}},b=function(){return!(!n.isQuizRunning()||null===u)&&u.answered()},w=function(){n.nextQuestion(),e.answerInput.answer="",s()},O=function(){e.hint=u.hint(),r(".answerInput")},C=function(e,n){return e.replace("[","<span class='"+n+"'>").replace("]","</span>")},y=function(e){13==e.which&&v()},A=function(){var n=c()/f()*100;e.progressbar.set(n)},_=function(){return c()>=f()},S=function(n,t,r){var i=[],o=!0;if(n.indexOf("overall_best")>=0&&(i.push({text:"Du hast einen neuen absoluten Rekord geschafft!"}),o=!1),n.indexOf("overall_best_equalised")>=0&&(i.push({text:"Du hast den aktuellen absoluten Rekord eingestellt!"}),o=!1),n.indexOf("personal_best")>=0&&n.indexOf("overall_best")<0&&(i.push({text:"Du hast einen neuen persönlichen Rekord geschafft!"}),o=!1),n.indexOf("personal_best_equalised")>=0&&n.indexOf("overall_best_equalised")<0&&(i.push({text:"Du hast gleich viele Punkte geschafft wie bei deinem persönlichen Rekord!"}),o=!1),n.indexOf("new_daily_best")>=0&&0===i.length&&i.push({text:"Du hast einen neuen persönlichen Tagesrekord geschafft!"}),e.achievements=i,o&&t&&t.id&&t.date&&t.score&&r&&r.id&&r.date&&r.score){var u=[];r.type="overall",u.push(r),t.id!==r.id&&(t.type="personal",u.push(t)),e.bests=u}else e.bests=null},T=function(){p(),w(),n.conclude().then(function(e){S(e.events||[],e.personalBest,e.overallBest)})["catch"](function(e){t.error(e)})},P=function(n){var t;if("personal"===n.type)t="Dein persönlicher Rekord liegt bei <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}.";else{var r=n.id===e.user._id;t=r?"Du hältst den absoluten Rekord mit <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}.":"<span class='highlight'>{USERNAME}</span> hält den absoluten Rekord mit <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}."}return t.replace("{POINTS}",o("number")(n.score)).replace("{DATE}",x(n.date)).replace("{USERNAME}",n.username)},x=function(e){return e=new Date(e),R(e.getDate(),"00")+"."+R(e.getMonth()+1,"00")+"."+(e.getYear()+1900)},R=function(e,n){return String(n+e).slice(-n.length)},I=function(){quiz=null,e.$emit("quiz.restart"),a(),s()},U=function(e,n){if(13==e.which)switch(n){case"next_question":w();break;case"continue_finished":T()}};e.$on("quiz.start",function(e,n){h()}),e.$on("$destroy",function(e,t){n.hasQuizStarted()&&n.hasQuizEnded()&&n.dispose()}),a(),s(),e.getQuestion=l,e.getCurrentQuestionNumber=c,e.renderQuestionText=d,e.submitAnswer=v,e.questionAnswered=b,e.nextQuestion=w,e.handleKeyPress=y,e.getQuestionMedia=g,e.requestHint=O,e.wasLastQuestion=_,e.continueFinished=T,e.getBestText=P,e.restartQuiz=I,e.hintsAvailable=m,e.enterListener=U}]),angular.module("magellan").controller("QuizCtrl",["$scope","QuizSrv","LogSrv",function(e,n,t){var r=function(e){n.init().then(function(){e&&"function"==typeof e&&e(),t.info("Quiz started")})["catch"](function(e){t.error(e)})},i=function(){return n.isQuizRunning()},o=function(){return n.hasQuizStarted()},u=function(){return n.hasQuizEnded()},a=function(){return n.getTotalPoints()};e.$on("quiz.restart",function(i,o){t.info("quiz restart"),n.dispose(),r(function(){e.$broadcast("quiz.start")})}),e.startQuiz=r,e.isQuizRunning=i,e.hasQuizStarted=o,e.hasQuizEnded=u,e.getTotalPoints=a}]),angular.module("magellan").controller("RegisterCtrl",["$scope","LogSrv","FocusSrv","UserSrv","$state","$window",function(e,n,t,r,i,o){e.newUser={},e.message=null;var u=function(t){return!!t&&void(a()&&r.register(e.newUser).then(function(n){200===n.status?(e.$emit("app.login",n.data),i.go("home",{action:"register.successful"})):e.message={type:"error",text:"Bei der Anmeldung scheint etwas schief gegangen zu sein"}})["catch"](function(t){n.error(t);var r;switch(t.message){case"Username already exists":r="Der Benutzername existiert bereits";break;default:r="Bei der Anmeldung scheint etwas schief gegangen zu sein"}e.$$phase?e.message={type:"error",text:r}:e.$apply(function(){e.message={type:"error",text:r}})}))},a=function(){e.message=null;var n=e.newUser.password,t=e.newUser.password2;return e.newUser.username&&e.newUser.email&&n&&t?""===n||""===t?e.message={type:"error",text:"Die Passwörter können nicht leer sein"}:n!==t&&(e.message={type:"error",text:"Die Passwörter stimmen nicht überein"}):e.message={type:"error",text:"Alle Felder müssen ausgefüllt sein"},!e.message},s=function(){u(!0)};e.delegateSubmit=s,e.register=u,t("#username")}]),angular.module("magellan").controller("SettingsCtrl",["$scope","AppConfig","FocusSrv","LogSrv","UserSrv",function(e,n,t,r,i){var o=function(){e.message=null;var o=n["settings.user.colors"];e.userObj={username:e.user.username,email:e.user.email,color:e.user.color},e.userColors=o;var u=function(n){e.userObj.color=n},a=function(){i.updateBasic(e.userObj).then(function(n){e.user.username=e.userObj.username,e.user.email=e.userObj.email,e.user.color=e.userObj.color,e.$apply(function(){e.message={type:"success",text:"Einstellungen wurden erfolgreich gespeichert"}})})["catch"](function(n){r.error("Update user",n);var t;switch(n.message){case"Username already exists":t="Der Benutzername ist bereits vergeben";break;default:t="Die Einstellungen konnten nicht gespeichert werden"}e.$apply(function(){e.message={type:"error",text:t}})})},s=function(){a(!0)};e.setColor=u,e.updateUser=a,e.delegateSubmit=s,t("#username")};e.user&&o(),e.$on("user.loaded",function(e,n){o()})}]),angular.module("magellan").directive("quiz",function(){return{templateUrl:"build/views/templates/quiz-directive.template.html",scope:!0,controller:"QuizDirectiveController",restrict:"E",link:function(e,n,t){}}}),angular.module("magellan").filter("renderHtml",["$sce",function(e){return function(n){return e.trustAsHtml(n)}}]),angular.module("magellan").filter("textOrNumber",["$filter",function(e){return function(n,t){return t=void 0!==t?0:t,isNaN(n)?n:e("number")(n,t)}}]),angular.module("magellan").factory("AuthInterceptor",["AuthTokenSrv",function(e){var n=function(n){var t=e.getToken();return t&&(n.headers=n.headers||{},n.headers["X-Auth"]=t),n};return{request:n}}]),angular.module("magellan").factory("AuthTokenSrv",["$window",function(e){var n=e.sessionStorage,t="auth-token",r=function(){return n.getItem(t)},i=function(e){e?n.setItem(t,e):n.removeItem(t)};return{getToken:r,setToken:i}}]),angular.module("magellan").factory("CountrySrv",["$http","IndexedDBSrv","LogSrv",function(e,n,t){var r=null,i=null,o=null,u="magellan",a="countryStore",s="countries",l="version",c=n.indexedDBAvailable(),f=function(){return d()},d=function(){return c?new Promise(function(e,s){n.createDatabase(u,a).then(h).then(m).then(v).then(g).then(p).then(function(n){r=n.countries,t.info("loaded countries from",n.loadStrategy.toUpperCase()),i={},o={},r.forEach(function(e){i[e.alpha3Code]=e;var n=e.name.substr(0,1).toUpperCase();switch(n){case"Ä":n="A";break;case"Ö":n="O";break;case"Ü":n="U"}void 0===o[n]&&(o[n]=[]),o[n].push({alpha3Code:e.alpha3Code,name:e.name})}),e(r)})["catch"](function(e){t.error("failed to load countries",e),s(e)})}):w()},g=function(e){return new Promise(function(n,t){var r,i=e.internalVersion,o=e.externalVersion;r=null===i?"api":o>i?"api":"db",e.loadStrategy=r,n(e)})},p=function(e){return new Promise(function(t,r){var i=e.loadStrategy;switch(i){case"api":w().then(function(r){e.countries=r,n.putItem(u,a,{name:s,value:r}),n.putItem(u,a,{name:l,value:e.externalVersion}),t(e)})["catch"](function(e){r(e)});break;case"db":b(e).then(function(e){t(e)})["catch"](function(e){r(e)});break;default:r("Unknown load strategy")}})},h=function(){return new Promise(function(e,n){e({})})},m=function(e){return new Promise(function(t,r){n.retrieveItem(u,a,l).then(function(n){e.internalVersion=n.value,t(e)})["catch"](function(n){e.internalVersion=null,t(e)})})},v=function(e){return O().then(function(n){return e.externalVersion=n,e})},b=function(e){return new Promise(function(t,r){n.retrieveItem(u,a,s).then(function(n){e.countries=n.value,t(e)})["catch"](function(e){t(null)})})},w=function(){return new Promise(function(n,t){e.get("/api/countries").then(function(e){n(e.data)})["catch"](function(e){t(e)})})},O=function(){return new Promise(function(n,t){e.get("/api/countries/version").then(function(e){n(e.data.version||0)})["catch"](function(e){n(0)})})},C=function(e){return null===i?null:i[e]},y=function(){return r},A=function(){return null===o?null:o},_=function(){return null!==r&&r.length>0};return{init:f,getCountries:y,getCountryByAlpha3:C,getCountriesByLetter:A,areCountriesLoaded:_}}]),angular.module("magellan").factory("FocusSrv",["$timeout","$window",function(e,n){return function(t){e(function(){var e=n.document.querySelector(t);e&&e.focus()})}}]),angular.module("magellan").factory("IndexedDBSrv",["$window",function(e){var n="name",t=e.indexedDB||e.webkitIndexedDB||e.msIndexedDB,r=e.IDBKeyRange||e.webkitIDBKeyRange,i=e.IDBTransaction||e.webkitIDBTransaction;i&&(i.READ_WRITE=i.READ_WRITE||"readwrite",i.READ_ONLY=i.READ_ONLY||"readonly");var o=function(){return!!t},u=function(e,r){return new Promise(function(i,o){var u=t.open(e);u.onupgradeneeded=function(e){var t=e.target.result;t.createObjectStore(r,{keyPath:n})},u.onsuccess=function(e){i(e)},u.onerror=function(e){o(e)}})},a=function(e){return new Promise(function(n,r){var i=t.deleteDatabase(e);i.onsuccess=function(e){n(e)},i.onerror=function(e){r(e)}})},s=function(e,n,r){return new Promise(function(o,u){var a=t.open(e);a.onsuccess=function(e){var t=e.target.result,a=t.transaction(n,i.READ_WRITE),s=a.objectStore(n),l=s.add(r);l.onsuccess=function(e){o(e)},l.onerror=function(e){u(e)}}})},l=function(e,n,r){return new Promise(function(o,u){var a=t.open(e);a.onsuccess=function(e){var t=e.target.result,a=t.transaction(n,i.READ_WRITE),s=a.objectStore(n),l=s.put(r);l.onsuccess=function(e){o(e)},l.onerror=function(e){u(e)}}})},c=function(e,n,o){return new Promise(function(u,a){var s=null,l=t.open(e);l.onsuccess=function(e){var t=e.target.result,a=t.transaction(n,i.READ_ONLY),l=a.objectStore(n),c=r.only(o);l.openCursor(c).onsuccess=function(e){var n=e.target.result;n?(s=n.value,n["continue"]()):u(s)}},l.onerror=function(e){a(e)}})},f=function(e,n){return new Promise(function(r,o){var u=[],a=t.open(e);a.onsuccess=function(e){var t=e.target.result,o=t.transaction(n,i.READ_ONLY),a=o.objectStore(n);a.openCursor().onsuccess=function(e){var n=e.target.result;n?(u.push(n.value),n["continue"]()):r(u)}},a.onerror=function(e){o(e)}})};return{createDatabase:u,dropDatabase:a,addItem:s,putItem:l,retrieveItem:c,retrieveItems:f,indexedDBAvailable:o}}]),angular.module("magellan").factory("LogSrv",["AppConfig",function(e){var n=function(){e["log.info"]&&console.log.apply(console,arguments)},t=function(){e["log.error"]&&console.error.apply(console,arguments)};return{info:n,error:t}}]),angular.module("magellan").factory("QuizSrv",["AppConfig","CountrySrv","ScoreSrv","LogSrv",function(e,n,t,r){var i=null,o=null,u=function(e){i=e},a=function(){return null!==i&&i.length>0},s=function(){return new Promise(function(e,n){a||n("Countries have not been loaded"),o=g("country"),e(o.start())})},l=function(){o=null},c=function(){return null!==o&&(o.hasStarted()&&!o.hasEnded())},f=function(){return null!==o&&o.hasStarted()},d=function(){return null!==o&&o.hasEnded()},g=function(e){switch(e){case"country":default:return p()}},p=function(){for(var t=new Quiz,r=100,o=3,u=25,a=2.5,s=e["quiz.country.types"],l=Object.keys(s).length,c=[],f=e["quiz.country.questions"],d=0;d<f;d++){for(var g=!1;!g;){var p=i[getRandomInt(0,i.length-1)];g=c.indexOf(p.alpha3Code)<0}c.push(p.alpha3Code)}var C=0;return c.forEach(function(e){C++;var i=n.getCountryByAlpha3(e),c=s[getRandomInt(1,l)],d=h(c,i),g={type:c,input:v(c),unit:b(c)},p=m(c,i),y=w(c,r,a),A=O(c,o,u);C>=f&&(g.bonus=!0),"FLAG_OF_COUNTRY"===c&&(g.media="flag",g.alpha2Code=i.alpha2Code.toLocaleLowerCase()),t.addQuestion(new Question({text:d,info:g,answer:p,checkAnswer:y,hints:A}))}),t},h=function(e,n){switch(e){case"CAPITAL_OF_COUNTRY":return"Wie heißt die Hauptstadt von ["+n.name+"]";case"COUNTRY_OF_CAPITAL":return"["+n.capital+"] ist die Hauptstadt von welchem Land";case"POPULATION_OF_COUNTRY":return"Wie viele Menschen leben in ["+n.name+"]";case"AREA_OF_COUNTRY":return"Wie groß ist die Fläche von ["+n.name+"]";case"FLAG_OF_COUNTRY":return"Welches Land hat diese Flagge";default:return"?"}},m=function(e,n){switch(e){case"CAPITAL_OF_COUNTRY":var t=void 0!==n.altSpellings&&void 0!==n.altSpellings.capital?n.altSpellings.capital:[];return{correct:n.capital,altSpellings:t};case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":var t=void 0!==n.altSpellings&&void 0!==n.altSpellings.name?n.altSpellings.name:[];return{correct:n.name,altSpellings:t};case"POPULATION_OF_COUNTRY":return{correct:n.population};case"AREA_OF_COUNTRY":return{correct:n.area};default:return"?"}},v=function(e){switch(e){case"POPULATION_OF_COUNTRY":return"number.high";case"AREA_OF_COUNTRY":return"number.medium";case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":default:return"text.standard"}},b=function(e){switch(e){case"AREA_OF_COUNTRY":return"km²";case"POPULATION_OF_COUNTRY":return"Einwohner";default:return null}},w=function(e,n,t){switch(e){case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":return function(e,r,i,o,u){var a=r===e.correct||e.altSpellings&&e.altSpellings.indexOf(r)>=0,s=a?n:0;return i>0&&(s-=i*o),void 0!==u&&void 0!==u.bonus&&u.bonus===!0&&(s*=t),s};case"POPULATION_OF_COUNTRY":case"AREA_OF_COUNTRY":return function(e,n,r,i,o){var u,a=Math.abs(n-e.correct)/e.correct*100;return u=a<=3?100:a<=6?90:a<=9?80:a<=12?70:a<=14?60:a<=16?50:a<=18?40:a<=20?30:a<=25?20:a<=30?10:0,r>0&&(u-=r*i),void 0!==o&&void 0!==o.bonus&&o.bonus===!0&&(u*=t),u};default:return"?"}},O=function(e,n,t){switch(e){case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":return{allowed:!0,maximum:n,cost:t,give:function(e,n){return n.correct.substr(0,e)}};case"POPULATION_OF_COUNTRY":case"AREA_OF_COUNTRY":return{allowed:!1};default:return"?"}},C=function(){return c()?o.getCurrentQuestionNumber():null},y=function(){return c()?o.getNumberOfQuestions():null},A=function(){return c()?o.currentQuestion():null},_=function(){c()&&o.nextQuestion()},S=function(){return null===o?null:o.getTotalPoints()},T=function(){return new Promise(function(e,n){null!==o&&o.hasEnded()?(o.submitted===!0&&n("Quiz has already been submitted"),o.submitted=!0,t.putHighscore(o.getTotalPoints()).then(function(n){e(n)})["catch"](function(e){n(e)})):n("No quiz is currently running")})};return{init:s,setCountries:u,isQuizRunning:c,hasQuizStarted:f,hasQuizEnded:d,getCurrentQuestionNumber:C,getNumberOfQuizQuestions:y,getCurrentQuestion:A,nextQuestion:_,getTotalPoints:S,conclude:T,dispose:l}}]),angular.module("magellan").factory("ScoreSrv",["$http",function(e){var n=function(){return new Promise(function(n,t){e.get("/api/scores/all").success(function(e){n(e)}).error(function(e){t(e)})})},t=function(){return new Promise(function(n,t){e.get("/api/scores/user").success(function(e){n(e)}).error(function(e){t(e)})})},r=function(){return new Promise(function(n,t){e.get("/api/scores/high").success(function(e){n(e)}).error(function(e){t(e)})})},i=function(n){return new Promise(function(t,r){e.put("/api/scores",{score:n}).success(function(e){t(e)}).error(function(e){r(e)})})};return{getHighscoreList:n,getUserHighscore:t,getOverallHighscore:r,putHighscore:i}}]),angular.module("magellan").factory("UserSrv",["$http","AuthTokenSrv","AppConfig",function(e,n,t){var r=this,i=function(){return e.get("/api/user")},o=function(){return new Promise(function(e,t){var r=n.getToken();r?(n.setToken(r),i().then(function(n){e(n.data)})["catch"](function(e){t(e)})):t("No token in storage")})},u=function(t,o){return e.post("/api/session",{username:t,password:o}).then(function(e){return r.token=e.data,n.setToken(r.token),i()})},a=function(){return new Promise(function(e,t){r.token=null,n.setToken(),e()})},s=function(n){return new Promise(function(r,i){var o=t["settings.user.colors"];n.color=o[getRandomInt(0,o.length-1)],e.post("/api/user",n).success(function(e){u(n.username,n.password).then(function(e){r(e)})["catch"](function(e){i(e)})}).error(function(e){i(e)})})},l=function(n){return new Promise(function(t,r){e.put("/api/user/basic",n).success(function(e){t(e)}).error(function(e){r(e)})})};return{getUser:i,getUserFromStorage:o,login:u,logout:a,register:s,updateBasic:l}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNjcmlwdC5qcyIsIm1vZGVscy5qcyIsInJvdXRlcy5qcyIsImNvbnRyb2xsZXJzL2NvdW50cmllcy5jdHJsLmpzIiwiY29udHJvbGxlcnMvY291bnRyeS1kZXRhaWwuY3RybC5qcyIsImNvbnRyb2xsZXJzL2NvdW50cnktZGlmZmljdWx0eS5jdHJsLmpzIiwiY29udHJvbGxlcnMvZHJvcGRvd24uY3RybC5qcyIsImNvbnRyb2xsZXJzL2hpZ2hzY29yZS5jdHJsLmpzIiwiY29udHJvbGxlcnMvaG9tZS5jdHJsLmpzIiwiY29udHJvbGxlcnMvbG9naW4uY3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ291dC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcXVpei1kaXJlY3RpdmUuY3RybC5qcyIsImNvbnRyb2xsZXJzL3F1aXouY3RybC5qcyIsImNvbnRyb2xsZXJzL3JlZ2lzdGVyLmN0cmwuanMiLCJjb250cm9sbGVycy9zZXR0aW5ncy5jdHJsLmpzIiwiZGlyZWN0aXZlcy9xdWl6LmRpcmVjdGl2ZS5qcyIsImZpbHRlcnMvcmVuZGVySHRtbC5maWx0ZXIuanMiLCJmaWx0ZXJzL3RleHRPck51bWJlci5qcyIsImludGVyY2VwdG9ycy9hdXRoLmludGVyY2VwdG9yLmpzIiwic2VydmljZXMvYXV0aC10b2tlbi5zZXJ2aWNlLmpzIiwic2VydmljZXMvY291bnRyeS5zZXJ2aWNlLmpzIiwic2VydmljZXMvZm9jdXMuc2VydmljZS5qcyIsInNlcnZpY2VzL2luZGV4ZWQtZGIuc2VydmljZS5qcyIsInNlcnZpY2VzL2xvZy5zZXJ2aWNlLmpzIiwic2VydmljZXMvcXVpei5zZXJ2aWNlLmpzIiwic2VydmljZXMvc2NvcmUuc2VydmljZS5qcyIsInNlcnZpY2VzL3VzZXIuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJtYWdlbGxhbiIsImFuZ3VsYXIiLCJtb2R1bGUiLCIkaHR0cFByb3ZpZGVyIiwiaW50ZXJjZXB0b3JzIiwicHVzaCIsImNvbnN0YW50IiwibG9nLmluZm8iLCJsb2cuZXJyb3IiLCJxdWl6LmNvdW50cnkucXVlc3Rpb25zIiwicXVpei5jb3VudHJ5LnR5cGVzIiwiMSIsIjIiLCIzIiwiNCIsIjUiLCJzZXR0aW5ncy51c2VyLmNvbG9ycyIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkc3RhdGUiLCJVc2VyU3J2IiwiQ291bnRyeVNydiIsIlF1aXpTcnYiLCJhcHAiLCJjb25maWciLCJ0aXRsZSIsInN1YnRpdGxlIiwiYXV0aG9yIiwiZ2V0VXNlckZyb21TdG9yYWdlIiwidGhlbiIsInVzZXIiLCIkYnJvYWRjYXN0IiwiaW5pdCIsImNvdW50cmllcyIsInNldENvdW50cmllcyIsImVyciIsImlzUHJvZ3Jlc3NCYXJWaXNpYmxlIiwiaXMiLCIkb24iLCJldmVudCIsImRhdGEiLCJnbyIsIlF1aXoiLCJjdXJyZW50UXVlc3Rpb25JZHgiLCJxdWVzdGlvbnMiLCJ0aGlzIiwic3RhcnQiLCJsZW5ndGgiLCJFcnJvciIsIm5leHRRdWVzdGlvbiIsImlzQWN0aXZlIiwiaGFzU3RhcnRlZCIsImhhc0VuZGVkIiwic3VibWl0dGVkIiwiYWRkUXVlc3Rpb24iLCJxdWVzdGlvbiIsInVuZGVmaW5lZCIsInZhbGlkIiwibmVjZXNzYXJ5UHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wZXJ0eSIsImhhc093blByb3BlcnR5IiwiY3VycmVudFF1ZXN0aW9uIiwiZ2V0VG90YWxQb2ludHMiLCJ0b3RhbFBvaW50cyIsInBvaW50cyIsImdldEN1cnJlbnRRdWVzdGlvbk51bWJlciIsImdldE51bWJlck9mUXVlc3Rpb25zIiwiUXVlc3Rpb24iLCJvcHRpb25zIiwidGV4dCIsImluZm8iLCJhbnN3ZXIiLCJoaW50cyIsImhpbnRzVXNlZCIsImNoZWNrQW5zd2VyIiwiYW5zd2VyZWQiLCJvcHRzIiwiYWxsb3dlZCIsIm1heGltdW0iLCJjb3N0IiwiZ2l2ZSIsInByb3AiLCJ2YWx1ZSIsImdldEluZm8iLCJzb2x1dGlvbiIsImhpbnQiLCJzdWJtaXR0ZWRBbnN3ZXIiLCJNYXRoIiwibWF4IiwiZmxvb3IiLCJoaW50c0FsbG93ZWQiLCJoaW50c1JlbWFpbmluZyIsImdldFJhbmRvbUludCIsIm1pbiIsInJhbmRvbSIsImdldFN0cmluZ0JldHdlZW4iLCJmaXJzdFN0cmluZyIsInNlY29uZFN0cmluZyIsImZpcnN0UG9zIiwiaW5kZXhPZiIsInNlY29uZFBvcyIsInN1YnN0ciIsImV4cG9ydHMiLCIkbG9jYXRpb25Qcm92aWRlciIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwiaHRtbDVNb2RlIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ0ZW1wbGF0ZVVybCIsInBhcmFtcyIsImFjdGlvbiIsImNvdW50cmllc0J5TGV0dGVyIiwiY291bnRyeUtleXMiLCJnZXRDb3VudHJpZXNCeUxldHRlciIsIk9iamVjdCIsImtleXMiLCIkJHBoYXNlIiwiJGFwcGx5IiwiYXJlQ291bnRyaWVzTG9hZGVkIiwiJHN0YXRlUGFyYW1zIiwiYWxwaGEzQ29kZSIsImNvdW50cnkiLCJnZXRDb3VudHJ5QnlBbHBoYTMiLCJnZXRDb3VudHJ5RnJvbVNlcnZpY2UiLCJhbHBoYTMiLCJnZXRDb3VudHJpZXMiLCJkaWZmaWN1bHRpZXMiLCJlYXN5IiwibWVkaXVtIiwiaGFyZCIsInVuYXNzaWduZWQiLCJzb3J0IiwiYSIsImIiLCJwb3B1bGF0aW9uIiwiYyIsInN1YnJlZ2lvbiIsIm5hbWUiLCJkaWZmaWN1bHR5IiwicmVnaW9uIiwiZGlmZmljdWx0eUtleXMiLCJ0b2dnbGVEcm9wZG93biIsInZpc2libGUiLCJzaG93RHJvcGRvd24iLCJoaWRlRHJvcGRvd24iLCJpc0Ryb3Bkb3duVmlzaWJsZSIsImhhbmRsZUNsaWNrT3V0c2lkZSIsImNvbnNvbGUiLCJsb2ciLCJTY29yZVNydiIsIkxvZ1NydiIsInNjb3JlTGlzdCIsImdldEhpZ2hzY29yZUxpc3QiLCJsaXN0IiwiY3JlYXRlUmFua2luZyIsImVycm9yIiwiaXNNeXNlbGYiLCJpZCIsIl9pZCIsInJhbmsiLCJwcmV2aW91c1Njb3JlIiwiZW50cnkiLCJzY29yZSIsIm1lc3NhZ2UiLCJ0eXBlIiwiRm9jdXNTcnYiLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJyZXNwb25zZSIsIiRlbWl0IiwibWVzc2FnZVRleHQiLCJzdGF0dXMiLCJsb2dvdXQiLCJuZ1Byb2dyZXNzRmFjdG9yeSIsIiRmaWx0ZXIiLCJpbml0Q3RybCIsInByb2dyZXNzYmFyIiwiY3JlYXRlSW5zdGFuY2UiLCJzZXRQYXJlbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwic2V0QWJzb2x1dGUiLCJzZXRDb2xvciIsImlzUmVzdWx0c1BhZ2VWaXNpYmxlIiwiYWNoaWV2ZW1lbnRzIiwiYmVzdHMiLCJhbnN3ZXJJbnB1dCIsIm11bHRpcGxpZXJPcHRpb25zIiwibGFiZWwiLCJ1cGRhdGVVaSIsImdldEN1cnJlbnRRdWVzdGlvbiIsImlucHV0IiwibXVsdGlwbGllciIsInVwZGF0ZVByb2dyZXNzQmFyIiwic2V0IiwiZ2V0UXVlc3Rpb24iLCJnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMiLCJyZW5kZXJRdWVzdGlvblRleHQiLCJyZW5kZXIiLCJnZXRRdWVzdGlvbk1lZGlhIiwibWVkaWEiLCJzaG93UmVzdWx0c1BhZ2UiLCJoaWRlUmVzdWx0c1BhZ2UiLCJoaW50c0F2YWlsYWJsZSIsInN1Ym1pdEFuc3dlciIsIlN0cmluZyIsInJlcGxhY2UiLCJ3YXNMYXN0UXVlc3Rpb24iLCJxdWVzdGlvbkFuc3dlcmVkIiwiaXNRdWl6UnVubmluZyIsInJlcXVlc3RIaW50IiwiY2xhc3NOYW1lIiwiaGFuZGxlS2V5UHJlc3MiLCJrZXlFdmVudCIsIndoaWNoIiwicHJvZ3Jlc3NQZXJjZW50IiwicGFyc2VFdmVudHMiLCJldmVudHMiLCJwZXJzb25hbEJlc3QiLCJvdmVyYWxsQmVzdCIsInNob3dCZXN0cyIsImRhdGUiLCJjb250aW51ZUZpbmlzaGVkIiwiY29uY2x1ZGUiLCJnZXRCZXN0VGV4dCIsImJlc3QiLCJmcm9tTXlzZWxmIiwiZ2V0Rm9ybWF0dGVkRGF0ZSIsIkRhdGUiLCJwYWQiLCJnZXREYXRlIiwiZ2V0TW9udGgiLCJnZXRZZWFyIiwic3RyIiwicGFkVmFsdWUiLCJzbGljZSIsInJlc3RhcnRRdWl6IiwicXVpeiIsImVudGVyTGlzdGVuZXIiLCJrZXlQcmVzcyIsImZ1bmMiLCJoYXNRdWl6U3RhcnRlZCIsImhhc1F1aXpFbmRlZCIsImRpc3Bvc2UiLCJzdGFydFF1aXoiLCJjYiIsIiR3aW5kb3ciLCJuZXdVc2VyIiwicmVnaXN0ZXIiLCJpc1ZhbGlkIiwidmFsaWRhdGVCZWZvcmVTdWJtaXQiLCJwYXNzd29yZDIiLCJlbWFpbCIsImRlbGVnYXRlU3VibWl0IiwiQXBwQ29uZmlnIiwiY29sb3JzIiwidXNlck9iaiIsImNvbG9yIiwidXNlckNvbG9ycyIsIm5ld0NvbG9yIiwidXBkYXRlVXNlciIsInVwZGF0ZUJhc2ljIiwiZGlyZWN0aXZlIiwic2NvcGUiLCJyZXN0cmljdCIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJmaWx0ZXIiLCIkc2NlIiwidHJ1c3RBc0h0bWwiLCJmcmFjdGlvblNpemUiLCJpc05hTiIsImZhY3RvcnkiLCJBdXRoVG9rZW5TcnYiLCJhZGRUb2tlbiIsInRva2VuIiwiZ2V0VG9rZW4iLCJoZWFkZXJzIiwicmVxdWVzdCIsInN0b3JlIiwic2Vzc2lvblN0b3JhZ2UiLCJrZXkiLCJnZXRJdGVtIiwic2V0VG9rZW4iLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsIiRodHRwIiwiSW5kZXhlZERCU3J2IiwiY291bnRyaWVzQnlBbHBoYTMiLCJkYXRhYmFzZSIsImtleUNvdW50cmllcyIsImtleVZlcnNpb24iLCJpbmRleGVkREJBdmFpbGFibGUiLCJsb2FkQ291bnRyaWVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjcmVhdGVEYXRhYmFzZSIsImdldEVtcHR5T2JqZWN0IiwiZ2V0SW50ZXJuYWxWZXJzaW9uIiwiZ2V0RXh0ZXJuYWxWZXJzaW9uIiwiZGV0ZXJtaW5lTG9hZFN0cmF0ZWd5IiwibG9hZERhdGEiLCJvYmoiLCJ0b1VwcGVyQ2FzZSIsImZpcnN0TGV0dGVyIiwiZ2V0Q291bnRyaWVzRnJvbUFQSSIsInN0cmF0ZWd5IiwiaW50ZXJuYWxWZXJzaW9uIiwiZXh0ZXJuYWxWZXJzaW9uIiwicHV0SXRlbSIsImdldENvdW50cmllc0Zyb21EQiIsIl9vYmoiLCJyZXRyaWV2ZUl0ZW0iLCJpdGVtIiwiZ2V0VmVyc2lvbkZyb21BUEkiLCJ2ZXJzaW9uIiwiZ2V0IiwiJHRpbWVvdXQiLCJzZWxlY3RvciIsInF1ZXJ5U2VsZWN0b3IiLCJmb2N1cyIsImtleVBhdGgiLCJpbmRleGVkREIiLCJ3ZWJraXRJbmRleGVkREIiLCJtc0luZGV4ZWREQiIsIklEQktleVJhbmdlIiwid2Via2l0SURCS2V5UmFuZ2UiLCJJREJUcmFuc2FjdGlvbiIsIndlYmtpdElEQlRyYW5zYWN0aW9uIiwiUkVBRF9XUklURSIsIlJFQURfT05MWSIsImRiTmFtZSIsInN0b3JlTmFtZSIsIm9wZW4iLCJvbnVwZ3JhZGVuZWVkZWQiLCJlIiwiaWRiIiwidGFyZ2V0IiwicmVzdWx0IiwiY3JlYXRlT2JqZWN0U3RvcmUiLCJvbnN1Y2Nlc3MiLCJvbmVycm9yIiwiZHJvcERhdGFiYXNlIiwiZGVsZXRlRGF0YWJhc2UiLCJhZGRJdGVtIiwidHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZSIsInJlcXVlc3RBZGQiLCJhZGQiLCJwdXQiLCJpdGVtTmFtZSIsInJhbmdlIiwib25seSIsIm9wZW5DdXJzb3IiLCJjdXJzb3IiLCJyZXRyaWV2ZUl0ZW1zIiwiaXRlbXMiLCJsb2dJbmZvIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJsb2dFcnJvciIsIl9jb3VudHJpZXMiLCJjb3VudHJpZXNMb2FkZWQiLCJjcmVhdGVRdWl6IiwicXVpelR5cGUiLCJjcmVhdGVDb3VudHJ5UXVpeiIsImNvdW50cnlRdWl6IiwiZnVsbFBvaW50cyIsImhpbnRNYXhpbXVtIiwiaGludENvc3QiLCJsYXN0UXVlc3Rpb25Cb251cyIsInF1ZXN0aW9uVHlwZXMiLCJxdWVzdGlvblR5cGVzTGVuZ3RoIiwic2VsZWN0ZWRDb3VudHJpZXMiLCJudW1iZXJPZlF1ZXN0aW9ucyIsImkiLCJjb3VudHJ5T2siLCJxY250IiwicXVlc3Rpb25UeXBlIiwiZ2V0UXVlc3Rpb25UZXh0IiwiZ2V0UXVlc3Rpb25JbnB1dCIsInVuaXQiLCJnZXRRdWVzdGlvblVuaXQiLCJnZXRRdWVzdGlvbkFuc3dlciIsImdldENoZWNrQW5zd2VyTGFtYmRhIiwiZ2V0UXVlc3Rpb25IaW50cyIsImFscGhhMkNvZGUiLCJ0b0xvY2FsZUxvd2VyQ2FzZSIsImNhcGl0YWwiLCJhbHRTcGVsbGluZ3MiLCJjb3JyZWN0IiwiYXJlYSIsImJvbnVzIiwiZXJyb3JQZXJjZW50YWdlIiwiYWJzIiwiaGludHNQb3NzaWJsZSIsInB1dEhpZ2hzY29yZSIsInN1Y2Nlc3MiLCJnZXRVc2VySGlnaHNjb3JlIiwiZ2V0T3ZlcmFsbEhpZ2hzY29yZSIsInNlbGYiLCJnZXRVc2VyIiwicG9zdCJdLCJtYXBwaW5ncyI6IkFBQUEsR0FBQUEsVUFBQUMsUUFBQUMsT0FBQSxZQUNBLFlBQ0EsYUFDQSxjQ0NJLGdCREFKLFNBQUFDLEdBQ0FBLEVBQUFDLGFBQUFDLEtBQUEscUJBSUFMLFVBQUFNLFNBQUEsYUFDQUMsWUFBQSxFQUNBQyxhQUFBLEVBRUFDLHlCQUFBLEVBQ0FDLHNCQUNBQyxFQUFBLHFCQUNBQyxFQUFBLHFCQUNBQyxFQUFBLHdCQUNBQyxFQUFBLGtCQUNBQyxFQUFBLG1CQUdBQyx3QkFDQSxXQUNBLGNBQ0EsWUFDQSxnQkFDQSxRQUNBLGVBQ0EsYUFDQSxjQUNBLE9BQ0EsU0FDQSxhQUNBLGtCQUNBLE9BQ0EsV0FDQSxhQUNBLGVBQ0EsUUFDQSxVQUNBLFNBQ0EsV0FJQWhCLFNBQUFpQixXQUFBLFdBQUEsU0FBQSxTQUFBLFVBQUEsYUFBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBRUFKLEVBQUFLLEtBQ0FDLFFBQ0FDLE1BQUEsV0FDQUMsU0FBQSx1REFDQUMsT0FBQSxvQkFLQVAsRUFBQVEscUJBQ0FDLEtB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R0FGLEVBQUFVLFdBRUFZLE9BSUFoRCxFQUFBLFNBQUFELEdBQ0EsTUFBQSxJQUFBZ0QsU0FBQSxTQUFBQyxFQUFBQyxHQUVBLEdBQUExQyxHQUFBRCxFQUFBLHVCQUNBUCxHQUFBVSxNQUFBRixFQUFBdEssYUFBQSxFQUFBc0ssRUFBQXBOLE9BQUEsSUFFQW9QLEVBQUFxSCxLQUFBLFlBQUE3SixHQUNBd0osUUFBQSxTQUFBM1csR0FFQWlJLEVBQUFrRixFQUFBakYsU0FBQWlGLEVBQUFoRixVQUNBOUksS0FBQSxTQUFBVyxHQUNBb1EsRUFBQXBRLEtBRkFpSSxTQUlBLFNBQUF0SSxHQUNBMFEsRUFBQTFRLE9BR0EySCxNQUFBLFNBQUEzSCxHQUNBMFEsRUFBQTFRLFFBS0FzTyxFQUFBLFNBQUEzTyxHQUNBLE1BQUEsSUFBQTZRLFNBQUEsU0FBQUMsRUFBQUMsR0FDQVYsRUFBQWdFLElBQUEsa0JBQUFyVSxHQUNBcVgsUUFBQSxTQUFBM1csR0FDQW9RLEVBQUFwUSxLQUVBc0gsTUFBQSxTQUFBM0gsR0FDQTBRLEVBQUExUSxPQUtBLFFBQ0FvWCxRQUFBQSxFQUNBM1gsbUJBQUFBLEVBQ0E2SSxNQUFBQSxFQUNBTyxPQUFBQSxFQUNBNEUsU0FBQUEsRUFDQWEsWUFBQUEiLCJmaWxlIjoic2NyaXB0LmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIG1hZ2VsbGFuID0gYW5ndWxhci5tb2R1bGUoXCJtYWdlbGxhblwiLCBbXHJcbiAgICAndWkucm91dGVyJyxcclxuICAgICduZ1Byb2dyZXNzJyxcclxuICAgICduZ0FuaW1hdGUnXHJcbl0sIGZ1bmN0aW9uIGNvbmZpZygkaHR0cFByb3ZpZGVyKSB7XHJcbiAgICAkaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdBdXRoSW50ZXJjZXB0b3InKTtcclxufSk7XHJcblxyXG4vLyBkZWZpbmUgYXBwbGljYXRpb24gY29uc3RhbnRzXHJcbm1hZ2VsbGFuLmNvbnN0YW50KFwiQXBwQ29uZmlnXCIsIHtcclxuICAgIFwibG9nLmluZm9cIjogdHJ1ZSxcclxuICAgIFwibG9nLmVycm9yXCI6IHRydWUsXHJcblxyXG4gICAgXCJxdWl6LmNvdW50cnkucXVlc3Rpb25zXCI6IDMsXHJcbiAgICBcInF1aXouY291bnRyeS50eXBlc1wiOiB7XHJcbiAgICAgICAgMTogXCJDQVBJVEFMX09GX0NPVU5UUllcIixcclxuICAgICAgICAyOiBcIkNPVU5UUllfT0ZfQ0FQSVRBTFwiLFxyXG4gICAgICAgIDM6IFwiUE9QVUxBVElPTl9PRl9DT1VOVFJZXCIsXHJcbiAgICAgICAgNDogXCJBUkVBX09GX0NPVU5UUllcIixcclxuICAgICAgICA1OiBcIkZMQUdfT0ZfQ09VTlRSWVwiXHJcbiAgICB9LFxyXG5cclxuICAgIFwic2V0dGluZ3MudXNlci5jb2xvcnNcIjogW1xyXG4gICAgICAgICdzb2Z0X3JlZCcsXHJcbiAgICAgICAgJ3RodW5kZXJiaXJkJyxcclxuICAgICAgICAnb2xkX2JyaWNrJyxcclxuICAgICAgICAnbmV3X3lvcmtfcGluaycsXHJcbiAgICAgICAgJ3NudWZmJyxcclxuICAgICAgICAnaG9uZXlfZmxvd2VyJyxcclxuICAgICAgICAnc2FuX21hcmlubycsXHJcbiAgICAgICAgJ3NoYWtlc3BlYXJlJyxcclxuICAgICAgICAnbWluZycsXHJcbiAgICAgICAgJ2dvc3NpcCcsXHJcbiAgICAgICAgJ2V1Y2FseXB0dXMnLFxyXG4gICAgICAgICdtb3VudGFpbl9tZWFkb3cnLFxyXG4gICAgICAgICdqYWRlJyxcclxuICAgICAgICAnY29uZmV0dGknLFxyXG4gICAgICAgICdjYWxpZm9ybmlhJyxcclxuICAgICAgICAnYnVybnRfb3JhbmdlJyxcclxuICAgICAgICAnamFmZmEnLFxyXG4gICAgICAgICdnYWxsZXJ5JyxcclxuICAgICAgICAnZWR3YXJkJyxcclxuICAgICAgICAnbHluY2gnXHJcbiAgICBdXHJcbn0pO1xyXG5cclxubWFnZWxsYW4uY29udHJvbGxlcihcIkFwcEN0cmxcIiwgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIFVzZXJTcnYsIENvdW50cnlTcnYsIFF1aXpTcnYpIHtcclxuICAgIC8vIC0tLS0tLS0tLS0tIEFwcCBjb25maWcgLS0tLS0tLS0tLS0tXHJcbiAgICAkc2NvcGUuYXBwID0ge1xyXG4gICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJNYWdlbGxhblwiLFxyXG4gICAgICAgICAgICBzdWJ0aXRsZTogXCJUZXN0IHlvdXIga25vd2xlZGdlIGFib3V0IHRoZSBjb3VudHJpZXMgb2Ygb3VyIHdvcmxkXCIsXHJcbiAgICAgICAgICAgIGF1dGhvcjogXCJNaWNoYWVsIFN0aWZ0ZXJcIlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0gQXBwIGluaXRpYWxpemF0aW9uIC0tLS0tLS0tLS0tLVxyXG4gICAgVXNlclNydi5nZXRVc2VyRnJvbVN0b3JhZ2UoKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgLy8gc3RvcmUgdXNlciBvYmplY3QgaW4gc2NvcGVcclxuICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB1c2VyO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3VzZXIubG9hZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBpbml0IGNvdW50cnkgc2VydmljZVxyXG4gICAgICAgICAgICBDb3VudHJ5U3J2LmluaXQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2NvdW50cmllcy5sb2FkZWQnLCBjb3VudHJpZXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY291bnRyaWVzIGluIHF1aXogc2VydmljZVxyXG4gICAgICAgICAgICAgICAgICAgIFF1aXpTcnYuc2V0Q291bnRyaWVzKGNvdW50cmllcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgLy8gdGhlIG9ubHkgZXJyb3IgdGhhdCBjYW4gb2NjdXIgaXMgdGhhdCB0aGVyZSBpcyBubyB0b2tlbiBpbiBzdG9yYWdlLCB3ZSBkbyBub3QgbmVlZCB0byByZWFjdCB0byB0aGF0XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmlzUHJvZ3Jlc3NCYXJWaXNpYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICRzdGF0ZS5pcygncXVpeicpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLSBFdmVudCBoYW5kbGluZyAtLS0tLS0tLS0tLS1cclxuICAgICRzY29wZS4kb24oJ2FwcC5sb2dpbicsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgLy8gc3RvcmUgdXNlciBvYmplY3QgaW4gc2NvcGVcclxuICAgICAgICAkc2NvcGUudXNlciA9IGRhdGE7XHJcblxyXG4gICAgICAgIC8vIGluaXQgY291bnRyeSBzZXJ2aWNlXHJcbiAgICAgICAgQ291bnRyeVNydi5pbml0KClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnY291bnRyaWVzLmxvYWRlZCcsIGNvdW50cmllcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2V0IGNvdW50cmllcyBpbiBxdWl6IHNlcnZpY2VcclxuICAgICAgICAgICAgICAgIFF1aXpTcnYuc2V0Q291bnRyaWVzKGNvdW50cmllcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBnbyB0byBxdWl6IHBhZ2VcclxuICAgICAgICAkc3RhdGUuZ28oJ3F1aXonKTtcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kb24oJ2FwcC5sb2dvdXQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgIC8vIHJlbW92ZSB1c2VyIG9iamVjdCBmcm9tIHNjb3BlXHJcbiAgICAgICAgJHNjb3BlLnVzZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBnbyB0byBob21lIHBhZ2VcclxuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgIH0pO1xyXG59KTsiLCJ2YXIgbWFnZWxsYW4gPSBhbmd1bGFyLm1vZHVsZShcIm1hZ2VsbGFuXCIsIFtcclxuICAgICd1aS5yb3V0ZXInLFxyXG4gICAgJ25nUHJvZ3Jlc3MnLFxyXG4gICAgJ25nQW5pbWF0ZSdcclxuXSwgW1wiJGh0dHBQcm92aWRlclwiLCBmdW5jdGlvbiBjb25maWcoJGh0dHBQcm92aWRlcikge1xyXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aEludGVyY2VwdG9yJyk7XHJcbn1dKTtcclxuXHJcbi8vIGRlZmluZSBhcHBsaWNhdGlvbiBjb25zdGFudHNcclxubWFnZWxsYW4uY29uc3RhbnQoXCJBcHBDb25maWdcIiwge1xyXG4gICAgXCJsb2cuaW5mb1wiOiB0cnVlLFxyXG4gICAgXCJsb2cuZXJyb3JcIjogdHJ1ZSxcclxuXHJcbiAgICBcInF1aXouY291bnRyeS5xdWVzdGlvbnNcIjogMyxcclxuICAgIFwicXVpei5jb3VudHJ5LnR5cGVzXCI6IHtcclxuICAgICAgICAxOiBcIkNBUElUQUxfT0ZfQ09VTlRSWVwiLFxyXG4gICAgICAgIDI6IFwiQ09VTlRSWV9PRl9DQVBJVEFMXCIsXHJcbiAgICAgICAgMzogXCJQT1BVTEFUSU9OX09GX0NPVU5UUllcIixcclxuICAgICAgICA0OiBcIkFSRUFfT0ZfQ09VTlRSWVwiLFxyXG4gICAgICAgIDU6IFwiRkxBR19PRl9DT1VOVFJZXCJcclxuICAgIH0sXHJcblxyXG4gICAgXCJzZXR0aW5ncy51c2VyLmNvbG9yc1wiOiBbXHJcbiAgICAgICAgJ3NvZnRfcmVkJyxcclxuICAgICAgICAndGh1bmRlcmJpcmQnLFxyXG4gICAgICAgICdvbGRfYnJpY2snLFxyXG4gICAgICAgICduZXdfeW9ya19waW5rJyxcclxuICAgICAgICAnc251ZmYnLFxyXG4gICAgICAgICdob25leV9mbG93ZXInLFxyXG4gICAgICAgICdzYW5fbWFyaW5vJyxcclxuICAgICAgICAnc2hha2VzcGVhcmUnLFxyXG4gICAgICAgICdtaW5nJyxcclxuICAgICAgICAnZ29zc2lwJyxcclxuICAgICAgICAnZXVjYWx5cHR1cycsXHJcbiAgICAgICAgJ21vdW50YWluX21lYWRvdycsXHJcbiAgICAgICAgJ2phZGUnLFxyXG4gICAgICAgICdjb25mZXR0aScsXHJcbiAgICAgICAgJ2NhbGlmb3JuaWEnLFxyXG4gICAgICAgICdidXJudF9vcmFuZ2UnLFxyXG4gICAgICAgICdqYWZmYScsXHJcbiAgICAgICAgJ2dhbGxlcnknLFxyXG4gICAgICAgICdlZHdhcmQnLFxyXG4gICAgICAgICdseW5jaCdcclxuICAgIF1cclxufSk7XHJcblxyXG5tYWdlbGxhbi5jb250cm9sbGVyKFwiQXBwQ3RybFwiLCBbXCIkc2NvcGVcIiwgXCIkc3RhdGVcIiwgXCJVc2VyU3J2XCIsIFwiQ291bnRyeVNydlwiLCBcIlF1aXpTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCAkc3RhdGUsIFVzZXJTcnYsIENvdW50cnlTcnYsIFF1aXpTcnYpIHtcclxuICAgIC8vIC0tLS0tLS0tLS0tIEFwcCBjb25maWcgLS0tLS0tLS0tLS0tXHJcbiAgICAkc2NvcGUuYXBwID0ge1xyXG4gICAgICAgIGNvbmZpZzoge1xyXG4gICAgICAgICAgICB0aXRsZTogXCJNYWdlbGxhblwiLFxyXG4gICAgICAgICAgICBzdWJ0aXRsZTogXCJUZXN0IHlvdXIga25vd2xlZGdlIGFib3V0IHRoZSBjb3VudHJpZXMgb2Ygb3VyIHdvcmxkXCIsXHJcbiAgICAgICAgICAgIGF1dGhvcjogXCJNaWNoYWVsIFN0aWZ0ZXJcIlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0gQXBwIGluaXRpYWxpemF0aW9uIC0tLS0tLS0tLS0tLVxyXG4gICAgVXNlclNydi5nZXRVc2VyRnJvbVN0b3JhZ2UoKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgLy8gc3RvcmUgdXNlciBvYmplY3QgaW4gc2NvcGVcclxuICAgICAgICAgICAgJHNjb3BlLnVzZXIgPSB1c2VyO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3VzZXIubG9hZGVkJyk7XHJcblxyXG4gICAgICAgICAgICAvLyBpbml0IGNvdW50cnkgc2VydmljZVxyXG4gICAgICAgICAgICBDb3VudHJ5U3J2LmluaXQoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2NvdW50cmllcy5sb2FkZWQnLCBjb3VudHJpZXMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY291bnRyaWVzIGluIHF1aXogc2VydmljZVxyXG4gICAgICAgICAgICAgICAgICAgIFF1aXpTcnYuc2V0Q291bnRyaWVzKGNvdW50cmllcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgLy8gdGhlIG9ubHkgZXJyb3IgdGhhdCBjYW4gb2NjdXIgaXMgdGhhdCB0aGVyZSBpcyBubyB0b2tlbiBpbiBzdG9yYWdlLCB3ZSBkbyBub3QgbmVlZCB0byByZWFjdCB0byB0aGF0XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmlzUHJvZ3Jlc3NCYXJWaXNpYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICRzdGF0ZS5pcygncXVpeicpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLSBFdmVudCBoYW5kbGluZyAtLS0tLS0tLS0tLS1cclxuICAgICRzY29wZS4kb24oJ2FwcC5sb2dpbicsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgLy8gc3RvcmUgdXNlciBvYmplY3QgaW4gc2NvcGVcclxuICAgICAgICAkc2NvcGUudXNlciA9IGRhdGE7XHJcblxyXG4gICAgICAgIC8vIGluaXQgY291bnRyeSBzZXJ2aWNlXHJcbiAgICAgICAgQ291bnRyeVNydi5pbml0KClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnY291bnRyaWVzLmxvYWRlZCcsIGNvdW50cmllcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2V0IGNvdW50cmllcyBpbiBxdWl6IHNlcnZpY2VcclxuICAgICAgICAgICAgICAgIFF1aXpTcnYuc2V0Q291bnRyaWVzKGNvdW50cmllcyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBnbyB0byBxdWl6IHBhZ2VcclxuICAgICAgICAkc3RhdGUuZ28oJ3F1aXonKTtcclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kb24oJ2FwcC5sb2dvdXQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgIC8vIHJlbW92ZSB1c2VyIG9iamVjdCBmcm9tIHNjb3BlXHJcbiAgICAgICAgJHNjb3BlLnVzZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBnbyB0byBob21lIHBhZ2VcclxuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgIH0pO1xyXG59XSk7XG4vLyBvd24gY2xhc3NlcyBhbmQgZnVuY3Rpb25zXHJcblxyXG4vLyAtLS0tLS0tLS0tIFFVSVogLS0tLS0tLS0tLVxyXG52YXIgUXVpeiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgLy8gaW5kZXggb2YgY3VycmVudCBxdWVzdGlvblxyXG4gICAgdmFyIGN1cnJlbnRRdWVzdGlvbklkeCA9IG51bGw7XHJcblxyXG4gICAgLy8gYXJyYXkgY29udGFpbmluZyBhbGwgcXVlc3Rpb25zXHJcbiAgICB2YXIgcXVlc3Rpb25zID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdGFydHMgdGhlIHF1aXouXHJcbiAgICAgKi9cclxuICAgIHRoaXMuc3RhcnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAvLyBjaGVjayBpZiBxdWl6IGhhcyBxdWVzdGlvbnNcclxuICAgICAgICBpZiAocXVlc3Rpb25zLmxlbmd0aCA8PSAwKVxyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIkNhbm5vdCBzdGFydCBhIHF1aXogd2l0aG91dCBxdWVzdGlvbnNcIik7XHJcblxyXG4gICAgICAgIHJldHVybiB0aGlzLm5leHRRdWVzdGlvbigpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmlzQWN0aXZlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzU3RhcnRlZCgpICYmICF0aGlzLmhhc0VuZGVkKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaGFzU3RhcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBjdXJyZW50UXVlc3Rpb25JZHggIT09IG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaGFzRW5kZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oYXNTdGFydGVkKCkgJiYgY3VycmVudFF1ZXN0aW9uSWR4ID49IHF1ZXN0aW9ucy5sZW5ndGg7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuc3VibWl0dGVkID0gZmFsc2U7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGRzIGEgbmV3IHF1ZXN0aW9uIHRvIHRoZSBxdWl6LlxyXG4gICAgICogVGhlIHBhcmFtZXRlciBtdXN0IGJlIGFuIHF1ZXN0aW9uIG9iamVjdC5cclxuICAgICAqIElmIG5vIHF1ZXN0aW9uIG9iamVjdCBpcyBwYXNzZWQgb3IgYW4gb2JqZWN0IHdpdGggbWlzc2luZyBwcm9wZXJ0aWVzLCBhbiBlcnJvciBpcyB0aHJvd24uXHJcbiAgICAgKi9cclxuICAgIHRoaXMuYWRkUXVlc3Rpb24gPSBmdW5jdGlvbihxdWVzdGlvbikge1xyXG4gICAgICAgIGlmIChxdWVzdGlvbiA9PT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcIk5vIHF1ZXN0aW9uIG9iamVjdCBwYXNzZWRcIik7XHJcblxyXG4gICAgICAgIHZhciB2YWxpZCA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vIGEgcXVlc3Rpb24gb2JqZWN0IG11c3QgY29udGFpbiBhbGwgdGhlc2UgcHJvcGVydGllc1xyXG4gICAgICAgIHZhciBuZWNlc3NhcnlQcm9wZXJ0aWVzID0gWydjb25maWcnLCAnaGludCcsICdzb2x1dGlvbicsICdhbnN3ZXInLCAncXVlc3Rpb24nLCAnZ2V0SW5mbycsICdpbmZvJywgJ3BvaW50cycsICdhbnN3ZXJlZCcsICdoaW50c0FsbG93ZWQnLCAnaGludHNSZW1haW5pbmcnXTtcclxuXHJcbiAgICAgICAgbmVjZXNzYXJ5UHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3BlcnR5KSB7XHJcbiAgICAgICAgICAgIGlmICghcXVlc3Rpb24uaGFzT3duUHJvcGVydHkocHJvcGVydHkpKSB7XHJcbiAgICAgICAgICAgICAgICB2YWxpZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUXVlc3Rpb24gbXVzdCBoYXZlIHByb3BlcnR5ICdcIiArIHByb3BlcnR5ICsgXCInXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGlmICh2YWxpZCkge1xyXG4gICAgICAgICAgICBxdWVzdGlvbnMucHVzaChxdWVzdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIG5leHQgcXVlc3Rpb24gb2YgdGhlIHF1aXouXHJcbiAgICAgKiBJZiB0aGUgcXVpeiBoYXMgZW5kZWQsIGl0IHJldHVybnMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgdGhpcy5uZXh0UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY3VycmVudFF1ZXN0aW9uSWR4ID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRRdWVzdGlvbklkeCA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY3VycmVudFF1ZXN0aW9uSWR4Kys7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5oYXNFbmRlZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBxdWVzdGlvbnNbY3VycmVudFF1ZXN0aW9uSWR4XTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5jdXJyZW50UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaXNBY3RpdmUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBxdWVzdGlvbnNbY3VycmVudFF1ZXN0aW9uSWR4XTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZXRUb3RhbFBvaW50cyA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuaGFzU3RhcnRlZCgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRvdGFsUG9pbnRzID0gMDtcclxuXHJcbiAgICAgICAgcXVlc3Rpb25zLmZvckVhY2goZnVuY3Rpb24ocXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIHBvaW50cyA9IHF1ZXN0aW9uLnBvaW50cygpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHBvaW50cyAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0b3RhbFBvaW50cyArPSBwb2ludHM7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRvdGFsUG9pbnRzO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmdldEN1cnJlbnRRdWVzdGlvbk51bWJlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjdXJyZW50UXVlc3Rpb25JZHggPT09IG51bGwpXHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICByZXR1cm4gY3VycmVudFF1ZXN0aW9uSWR4ICsgMTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZXROdW1iZXJPZlF1ZXN0aW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBxdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgfTtcclxufTtcclxuXHJcbi8vIC0tLS0tLS0tLS0gUVVFU1RJT04gLS0tLS0tLS0tLVxyXG52YXIgUXVlc3Rpb24gPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcbiAgICAvLyBUZXh0IG9mIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIHRleHQgPSBudWxsO1xyXG5cclxuICAgIC8vIEluZm8gb2JqZWN0IGZvciB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBpbmZvID0gbnVsbDtcclxuXHJcbiAgICAvLyBBbnN3ZXIgb2YgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgYW5zd2VyID0gbnVsbDtcclxuXHJcbiAgICAvLyBIaW50cyBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBoaW50cyA9IG51bGw7XHJcbiAgICB2YXIgaGludHNVc2VkID0gMDtcclxuXHJcbiAgICAvLyBMYW1iZGEgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSBhbnN3ZXIgc3RhdHVzIG9mIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIGNoZWNrQW5zd2VyID0gbnVsbDtcclxuXHJcbiAgICAvLyBQb2ludHMgYXdhcmRlZCBmb3IgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgcG9pbnRzID0gbnVsbDtcclxuXHJcbiAgICAvLyBGbGFnIGluZGljYXRpbmcgd2hldGhlciBxdWVzdGlvbiBoYXMgYWxyZWFkeSBiZWVuIGFuc3dlcmVkXHJcbiAgICB2YXIgYW5zd2VyZWQgPSBmYWxzZTtcclxuXHJcbiAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgICAgICB0ZXh0ID0gb3B0cy50ZXh0O1xyXG4gICAgICAgIGluZm8gPSBvcHRzLmluZm8gfHwge307XHJcbiAgICAgICAgYW5zd2VyID0gb3B0cy5hbnN3ZXI7XHJcbiAgICAgICAgY2hlY2tBbnN3ZXIgPSBvcHRzLmNoZWNrQW5zd2VyIHx8IG51bGw7XHJcblxyXG4gICAgICAgIGhpbnRzID0gb3B0cy5oaW50cyB8fCB7XHJcbiAgICAgICAgICAgICAgICBhbGxvd2VkOiBmYWxzZSwgICAgIC8vIGlzIGEgaGludCBhbGxvd2VkP1xyXG4gICAgICAgICAgICAgICAgbWF4aW11bTogMCwgICAgICAgICAvLyBtYXhpbXVtIG51bWJlciBvZiBoaW50cyBmb3IgdGhpcyBxdWVzdGlvbiAoaXJyZWxldmFudCBpZiBhbGxvd2VkIGlzIHNldCB0byBmYWxzZSlcclxuICAgICAgICAgICAgICAgIGNvc3Q6IDAsICAgICAgICAgICAgLy8gbnVtYmVyIG9mIHBvaW50cyBzdWJ0cmFjdGVkIHBlciB1c2VkIGhpbnQgKGlycmVsZXZhbnQgaWYgYWxsb3dlZCBpcyBzZXQgdG8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICBnaXZlOiBudWxsICAgICAgICAgIC8vIGxhbWJkYSBmdW5jdGlvbiB0byBnaXZlIGEgaGludCBmb3IgYSBxdWVzdGlvblxyXG4gICAgICAgICAgICB9O1xyXG4gICAgfTtcclxuXHJcbiAgICBpZiAob3B0aW9ucykge1xyXG4gICAgICAgIGluaXQob3B0aW9ucyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5jb25maWcgPSBmdW5jdGlvbihvcHRzKSB7XHJcbiAgICAgICAgaW5pdChvcHRzKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBxdWVzdGlvbiB0ZXh0LlxyXG4gICAgICovXHJcbiAgICB0aGlzLnF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRleHQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgcXVlc3Rpb24gaW5mbyBvYmplY3QuXHJcbiAgICAgKiBBY3RzIGFzIGdldHRlciAod2l0aCBvbmx5IG9uZSBhcmd1bWVudCkgYW5kIHNldHRlciAod2l0aCB0d28gYXJndW1lbnRzKVxyXG4gICAgICovXHJcbiAgICB0aGlzLmluZm8gPSBmdW5jdGlvbihwcm9wLCB2YWx1ZSkge1xyXG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIC8vIHNldHRlclxyXG4gICAgICAgICAgICBpbmZvW3Byb3BdID0gdmFsdWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZ2V0dGVyXHJcbiAgICAgICAgICAgIHJldHVybiBpbmZvW3Byb3BdO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBlbnRpcmUgaW5mbyBvYmplY3QuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuZ2V0SW5mbyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBpbmZvO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGNvcnJlY3QgYW5zd2VyIHRvIHRoZSBxdWVzdGlvbiBhZnRlciB0aGUgcXVlc3Rpb24gaGFzIGJlZW4gYW5zd2VyZWQuXHJcbiAgICAgKiBJZiB0aGUgcXVlc3Rpb24gaGFzIG5vdCBiZWVuIGFuc3dlcmVkIHlldCwgaXQgcmV0dXJucyBudWxsLlxyXG4gICAgICovXHJcbiAgICB0aGlzLnNvbHV0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGFuc3dlcmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhbnN3ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIGEgaGludCBmb3IgdGhlIHF1ZXN0aW9uLlxyXG4gICAgICogSWYgbm8gaGludHMgYXJlIGFsbG93ZWQsIG9yIHRoZSBtYXhpbXVtIG51bWJlciBvZiBoaW50cyBoYXZlIGJlZW4gdXNlZCwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5oaW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFoaW50cy5hbGxvd2VkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpbnRzLmFsbG93ZWQgJiYgIWhpbnRzLmdpdmUpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiSGludHMgYWxsb3dlZCBidXQgbm8gZ2l2ZSBtZXRob2QgcGFzc2VkXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGhpbnRzVXNlZCA8IGhpbnRzLm1heGltdW0pIHtcclxuICAgICAgICAgICAgaGludHNVc2VkKys7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaGludHMuZ2l2ZShoaW50c1VzZWQsIGFuc3dlcik7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3VibWl0cyBhbiBhbnN3ZXIgdG8gdGhlIHF1ZXN0aW9uLlxyXG4gICAgICogSWYgdGhlIHF1ZXN0aW9uIGhhcyBhbHJlYWR5IGJlZW4gYW5zd2VyZWQgb3Igbm8gY2hlY2tBbnN3ZXIgbGFtYmRhIGhhcyBiZWVuIHNldCwgdGhpcyBtZXRob2QgZG9lcyBub3RoaW5nLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmFuc3dlciA9IGZ1bmN0aW9uKHN1Ym1pdHRlZEFuc3dlcikge1xyXG4gICAgICAgIGlmIChhbnN3ZXJlZCB8fCFjaGVja0Fuc3dlcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhbnN3ZXJlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vIGNoZWNrQW5zd2VyIG1ldGhvZCBzaG91bGQgcmV0dXJuIHRoZSBzdGF0dXMgcmVzdWx0c1xyXG4gICAgICAgIHBvaW50cyA9IGNoZWNrQW5zd2VyKGFuc3dlciwgc3VibWl0dGVkQW5zd2VyLCBoaW50c1VzZWQsIGhpbnRzLmNvc3QsIGluZm8pO1xyXG5cclxuICAgICAgICAvLyBlbnN1cmUgdGhhdCBubyBuZWdhdGl2ZSBwb2ludHMgYXJlIGF3YXJkZWRcclxuICAgICAgICBwb2ludHMgPSBNYXRoLm1heCgwLCBwb2ludHMpO1xyXG5cclxuICAgICAgICAvLyBlbnN1cmUgdGhhdCBvbmx5IGludGVnZXIgdmFsdWVzIGFyZSBzYXZlZFxyXG4gICAgICAgIHBvaW50cyA9IE1hdGguZmxvb3IocG9pbnRzKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBvaW50cztcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5wb2ludHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWFuc3dlcmVkIHx8IHBvaW50cyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgc3RhdGUgb2YgdGhlIHF1ZXN0aW9uLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmFuc3dlcmVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGFuc3dlcmVkO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBoaW50cyBhcmUgYWxsb3dlZCBmb3IgdGhpcyBxdWVzdGlvbiwgZmFsc2UgaWYgbm90LlxyXG4gICAgICogSWYgaGludHMgaGF2ZSBub3QgYmVlbiBpbml0aWFsaXplZCB5ZXQsIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuaGludHNBbGxvd2VkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGhpbnRzICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBoaW50cy5hbGxvd2VkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHJlbWFpbmluZyBoaW50cy5cclxuICAgICAqIElmIG5vIGhpbnRzIGFyZSBhbGxvd2VkIGZvciB0aGlzIHF1ZXN0aW9uLCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmhpbnRzUmVtYWluaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgdmFyIGFsbG93ZWQgPSB0aGlzLmhpbnRzQWxsb3dlZCgpO1xyXG5cclxuICAgICAgICBpZiAoYWxsb3dlZCA9PT0gbnVsbCB8fCBhbGxvd2VkID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBoaW50cy5tYXhpbXVtIC0gaGludHNVc2VkO1xyXG4gICAgfTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgcmFuZG9tIGludGVnZXIgYmV0d2VlbiBtaW4gKGluY2x1c2l2ZSkgYW5kIG1heCAoaW5jbHVzaXZlKVxyXG4gKiBVc2luZyBNYXRoLnJvdW5kKCkgd2lsbCBnaXZlIHlvdSBhIG5vbi11bmlmb3JtIGRpc3RyaWJ1dGlvbiFcclxuICovXHJcbnZhciBnZXRSYW5kb21JbnQgPSBmdW5jdGlvbihtaW4sIG1heCkge1xyXG4gICAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4gKyAxKSkgKyBtaW47XHJcbn07XHJcblxyXG4vKipcclxuICogUmV0dXJucyB0aGUgdGV4dCBiZXR3ZWVuIHR3byBkZWxpbWl0aW5nIHRleHQgb2NjdXJyZW5jZXNcclxuICovXHJcbnZhciBnZXRTdHJpbmdCZXR3ZWVuID0gZnVuY3Rpb24odGV4dCwgZmlyc3RTdHJpbmcsIHNlY29uZFN0cmluZykge1xyXG4gICAgdmFyIGZpcnN0UG9zID0gdGV4dC5pbmRleE9mKGZpcnN0U3RyaW5nKTtcclxuICAgIHZhciBzZWNvbmRQb3MgPSB0ZXh0LmluZGV4T2Yoc2Vjb25kU3RyaW5nKTtcclxuXHJcbiAgICBpZiAoZmlyc3RQb3MgPj0gMCAmJiBzZWNvbmRQb3MgPj0gMCAmJiBzZWNvbmRQb3MgPiBmaXJzdFBvcykge1xyXG4gICAgICAgIHJldHVybiB0ZXh0LnN1YnN0cihmaXJzdFBvcyArIDEsIHNlY29uZFBvcyAtIGZpcnN0UG9zIC0gMSk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbn07XHJcblxyXG5pZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgJiYgbW9kdWxlLmV4cG9ydHMpIHtcclxuICAgIG1vZHVsZS5leHBvcnRzLlF1ZXN0aW9uID0gUXVlc3Rpb247XHJcbiAgICBtb2R1bGUuZXhwb3J0cy5RdWl6ID0gUXVpejtcclxufVxuYW5ndWxhci5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb25maWcoW1wiJGxvY2F0aW9uUHJvdmlkZXJcIiwgXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgIC8vIGVuYWJsZSBIVE1MNSBwdXNoc3RhdGVcclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XHJcblxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9ob21lJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hvbWUucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3F1aXonLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvcXVpeicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9xdWl6LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb3VudHJpZXMnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2NvdW50cmllcy5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzLmRldGFpbCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy86YWxwaGEzQ29kZScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9jb3VudHJpZXMtZGV0YWlsLnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdsb2dpbicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9sb2dpbicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9sb2dpbi5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnbG9nb3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ291dCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9nb3V0Q3RybCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9yZWdpc3Rlci5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnc2V0dGluZ3MnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvc2V0dGluZ3MucGFydGlhbC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2Fib3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2Fib3V0JyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2Fib3V0LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdoaWdoc2NvcmUnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvaGlnaHNjb3JlJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hpZ2hzY29yZS5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzLWRpZmZpY3VsdHknLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzLWRpZmZpY3VsdHknLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvY291bnRyeS1kaWZmaWN1bHR5LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdDb3VudHJpZXNDdHJsJywgW1wiJHNjb3BlXCIsIFwiQ291bnRyeVNydlwiLCBmdW5jdGlvbigkc2NvcGUsIENvdW50cnlTcnYpIHtcclxuICAgICAgICB2YXIgY291bnRyaWVzQnlMZXR0ZXIgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJ5S2V5cyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyID0gQ291bnRyeVNydi5nZXRDb3VudHJpZXNCeUxldHRlcigpO1xyXG4gICAgICAgICAgICBjb3VudHJ5S2V5cyA9IE9iamVjdC5rZXlzKGNvdW50cmllc0J5TGV0dGVyKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cnlLZXlzID0gY291bnRyeUtleXM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllc0J5TGV0dGVyID0gY291bnRyaWVzQnlMZXR0ZXI7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5S2V5cyA9IGNvdW50cnlLZXlzO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllc0J5TGV0dGVyID0gY291bnRyaWVzQnlMZXR0ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoQ291bnRyeVNydi5hcmVDb3VudHJpZXNMb2FkZWQoKSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjb3VudHJpZXMubG9hZGVkJywgZnVuY3Rpb24oKSAge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignQ291bnRyeURldGFpbEN0cmwnLCBbXCIkc2NvcGVcIiwgXCJDb3VudHJ5U3J2XCIsIFwiJHN0YXRlUGFyYW1zXCIsIGZ1bmN0aW9uKCRzY29wZSwgQ291bnRyeVNydiwgJHN0YXRlUGFyYW1zKSB7XHJcbiAgICAgICAgdmFyIGFscGhhM0NvZGUgPSAkc3RhdGVQYXJhbXMuYWxwaGEzQ29kZTtcclxuXHJcbiAgICAgICAgaWYgKENvdW50cnlTcnYuYXJlQ291bnRyaWVzTG9hZGVkKCkpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmNvdW50cnkgPSBDb3VudHJ5U3J2LmdldENvdW50cnlCeUFscGhhMyhhbHBoYTNDb2RlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NvdW50cmllcy5sb2FkZWQnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzQ29kZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJ5RnJvbVNlcnZpY2UgPSBmdW5jdGlvbihhbHBoYTMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIENvdW50cnlTcnYuZ2V0Q291bnRyeUJ5QWxwaGEzKGFscGhhMyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldENvdW50cnlGcm9tU2VydmljZSA9IGdldENvdW50cnlGcm9tU2VydmljZTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdDb3VudHJ5RGlmZmljdWx0eUN0cmwnLCBbXCIkc2NvcGVcIiwgXCJDb3VudHJ5U3J2XCIsIGZ1bmN0aW9uKCRzY29wZSwgQ291bnRyeVNydikge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3VudHJpZXMgPSBDb3VudHJ5U3J2LmdldENvdW50cmllcygpO1xyXG4gICAgICAgICAgICB2YXIgZGlmZmljdWx0aWVzID0ge1xyXG4gICAgICAgICAgICAgICAgJ2Vhc3knOiBbXSxcclxuICAgICAgICAgICAgICAgICdtZWRpdW0nOiBbXSxcclxuICAgICAgICAgICAgICAgICdoYXJkJzogW10sXHJcbiAgICAgICAgICAgICAgICAndW5hc3NpZ25lZCc6IFtdXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBkZXRlcm1pbmUgZGlmZmljdWx0eVxyXG4gICAgICAgICAgICBjb3VudHJpZXMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYi5wb3B1bGF0aW9uIC0gYS5wb3B1bGF0aW9uO1xyXG4gICAgICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdFdXJvcGUnKSA+PSAwIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgYy5zdWJyZWdpb24uaW5kZXhPZignQXVzdHJhbGlhIGFuZCBOZXcgWmVhbGFuZCcpID49IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignU291dGggQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDI1MDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGMuc3VicmVnaW9uLmluZGV4T2YoJ05vcnRoZXJuIEFtZXJpY2EnKSA+PSAwIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0NlbnRyYWwgQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDEwMDAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQWZyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdBc2lhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gNTAwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGMubmFtZSA9PT0gJ1TDvHJrZWknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZWFzeVxyXG4gICAgICAgICAgICAgICAgICAgIGMuZGlmZmljdWx0eSA9ICdlYXN5JztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGMuc3VicmVnaW9uLmluZGV4T2YoJ0FmcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDE1MDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0FzaWEnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA+PSAxMDAwMDAwMCkgIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignU291dGggQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDEwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQ2VudHJhbCBBbWVyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQ2FyaWJiZWFuJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnVHVuZXNpZW4nLCAnQXNlcmJhaWRzY2hhbicsICdWZXJlaW5pZ3RlIEFyYWJpc2NoZSBFbWlyYXRlJywgJ0dlb3JnaWVuJywgJ0FybWVuaWVuJ10uaW5kZXhPZihjLm5hbWUpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBtZWRpdW1cclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAnbWVkaXVtJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGMuc3VicmVnaW9uLmluZGV4T2YoJ1NvdXRoIEFtZXJpY2EnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA8IDEwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQWZyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPCAxNTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdBc2lhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPCAxMDAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdDZW50cmFsIEFtZXJpY2EnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA8IDEwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0NhcmliYmVhbicpID49IDAgJiYgYy5wb3B1bGF0aW9uIDwgMTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnJlZ2lvbi5pbmRleE9mKCdPY2VhbmlhJykgPj0gMCAmJiBjLnN1YnJlZ2lvbiAhPT0gJ0F1c3RyYWxpYSBhbmQgTmV3IFplYWxhbmQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhhcmRcclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAnaGFyZCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVuYXNzaWduZWRcclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAndW5hc3NpZ25lZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGlmZmljdWx0aWVzW2MuZGlmZmljdWx0eV0ucHVzaChjKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHRpZXMgPSBkaWZmaWN1bHRpZXM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0eUtleXMgPSBPYmplY3Qua2V5cyhkaWZmaWN1bHRpZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0aWVzID0gZGlmZmljdWx0aWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHR5S2V5cyA9IE9iamVjdC5rZXlzKGRpZmZpY3VsdGllcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChDb3VudHJ5U3J2LmFyZUNvdW50cmllc0xvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NvdW50cmllcy5sb2FkZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignRHJvcGRvd25DdHJsJywgW1wiJHNjb3BlXCIsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG4gICAgICAgIHZhciB2aXNpYmxlID0gZmFsc2U7XHJcblxyXG4gICAgICAgICRzY29wZS50b2dnbGVEcm9wZG93biA9IHRvZ2dsZURyb3Bkb3duO1xyXG4gICAgICAgICRzY29wZS5zaG93RHJvcGRvd24gPSBzaG93RHJvcGRvd247XHJcbiAgICAgICAgJHNjb3BlLmhpZGVEcm9wZG93biA9IGhpZGVEcm9wZG93bjtcclxuICAgICAgICAkc2NvcGUuaXNEcm9wZG93blZpc2libGUgPSBpc0Ryb3Bkb3duVmlzaWJsZTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmhhbmRsZUNsaWNrT3V0c2lkZSA9IGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiQ0xJQ0tFRCBPVVRTSURFXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gdG9nZ2xlRHJvcGRvd24oKSB7XHJcbiAgICAgICAgICAgIHZpc2libGUgPSAhdmlzaWJsZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNob3dEcm9wZG93bigpIHtcclxuICAgICAgICAgICAgdmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoaWRlRHJvcGRvd24oKSB7XHJcbiAgICAgICAgICAgIHZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlzRHJvcGRvd25WaXNpYmxlKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaWJsZTtcclxuICAgICAgICB9XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignSGlnaHNjb3JlQ3RybCcsIFtcIiRzY29wZVwiLCBcIlNjb3JlU3J2XCIsIFwiTG9nU3J2XCIsIGZ1bmN0aW9uKCRzY29wZSwgU2NvcmVTcnYsIExvZ1Nydikge1xyXG4gICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBbXTtcclxuXHJcbiAgICAgICAgU2NvcmVTcnYuZ2V0SGlnaHNjb3JlTGlzdCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBjcmVhdGVSYW5raW5nKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NvcmVMaXN0ID0gY3JlYXRlUmFua2luZyhsaXN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgaXNNeXNlbGYgPSBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnVzZXIuX2lkID09PSBpZDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlUmFua2luZyA9IGZ1bmN0aW9uKGxpc3QpIHtcclxuICAgICAgICAgICAgdmFyIHJhbmsgPSAwO1xyXG5cclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzU2NvcmUgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGVudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZXZpb3VzU2NvcmUgfHwgZW50cnkuc2NvcmUgIT09IHByZXZpb3VzU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByYW5rKys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LnJhbmsgPSByYW5rICsgJy4nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHByZXZpb3VzU2NvcmUgPSBlbnRyeS5zY29yZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuaXNNeXNlbGYgPSBpc015c2VsZjtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdIb21lQ3RybCcsIFtcIiRzY29wZVwiLCBcIkxvZ1NydlwiLCBcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbigkc2NvcGUsIExvZ1NydiwgJHN0YXRlUGFyYW1zKSB7XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBjaGVjayBzdGF0ZSBwYXJhbXNcclxuICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLmFjdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gJHN0YXRlUGFyYW1zLmFjdGlvbjtcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZWdpc3Rlci5zdWNjZXNzZnVsJzpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnR3JhdHVsYXRpb24hIERpZSBBbm1lbGR1bmcgd2FyIGVyZm9sZ3JlaWNoLiBIZXJ6bGljaCB3aWxsa29tbWVuIGJlaSBNYWdlbGxhbi4nXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgW1wiJHNjb3BlXCIsIFwiVXNlclNydlwiLCBcIkZvY3VzU3J2XCIsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclNydiwgRm9jdXNTcnYpIHtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICBVc2VyU3J2LmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwbGljYXRpb24gY29udHJvbCBhYm91dCBsb2dpbiBldmVudFxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ2luJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0ZhbHNjaGVyIEJlbnV0emVybmFtZSBvZGVyIFBhc3N3b3J0JztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdCZWltIEVpbmxvZ2dlbiBzY2hlaW50IGV0d2FzIHNjaGllZiBnZWdhbmdlbiB6dSBzZWluJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBmb2N1cyB1c2VybmFtZSBmaWVsZFxyXG4gICAgICAgIEZvY3VzU3J2KCcjdXNlcm5hbWUnKTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdMb2dvdXRDdHJsJywgW1wiJHNjb3BlXCIsIFwiVXNlclNydlwiLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTcnYpIHtcclxuICAgICAgICBVc2VyU3J2LmxvZ291dCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaW5mb3JtIGFwcGxpY2F0aW9uIGNvbnRyb2wgYWJvdXQgbG9nb3V0IGV2ZW50XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2FwcC5sb2dvdXQnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XSk7XG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1F1aXpEaXJlY3RpdmVDb250cm9sbGVyJywgW1wiJHNjb3BlXCIsIFwiUXVpelNydlwiLCBcIkxvZ1NydlwiLCBcIkZvY3VzU3J2XCIsIFwibmdQcm9ncmVzc0ZhY3RvcnlcIiwgXCIkZmlsdGVyXCIsIGZ1bmN0aW9uKCRzY29wZSwgUXVpelNydiwgTG9nU3J2LCBGb2N1c1NydiwgbmdQcm9ncmVzc0ZhY3RvcnksICRmaWx0ZXIpIHtcclxuICAgICAgICB2YXIgcXVlc3Rpb247XHJcblxyXG4gICAgICAgIHZhciBpbml0Q3RybCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBQcm9ncmVzcyBiYXIgaW5pdGlhbGl6YXRpb25cclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyID0gbmdQcm9ncmVzc0ZhY3RvcnkuY3JlYXRlSW5zdGFuY2UoKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldFBhcmVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpei1wcm9ncmVzcycpKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldEFic29sdXRlKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXRDb2xvcihcIiMzMzZlN2JcIik7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLmFjaGlldmVtZW50cyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dCA9IHt9O1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgb3B0aW9ucyBmb3IgbXVsdGlwbGllciBzZWxlY3Rpb25cclxuICAgICAgICAgICAgJHNjb3BlLm11bHRpcGxpZXJPcHRpb25zID0gW1xyXG4gICAgICAgICAgICAgICAgeyB2YWx1ZTogMSwgbGFiZWw6ICcnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfSxcclxuICAgICAgICAgICAgICAgIHsgdmFsdWU6IDEwMDAwMDAsIGxhYmVsOiAnTWlvLid9XHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICBxdWVzdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHVwZGF0ZVVpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGdldCBjdXJyZW50IHF1ZXN0aW9uIGZyb20gcXVpeiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gUXVpelNydi5nZXRDdXJyZW50UXVlc3Rpb24oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBwcmV2aW91cyBoaW50c1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIG11bHRpcGxpZXJzIGZvciBxdWVzdGlvbnMgY29udGFpbmluZyBudW1iZXJzXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5oaWdoJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMTAwMDAwMCwgbGFiZWw6ICdNaW8uJ307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5tZWRpdW0nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMSwgbGFiZWw6ICcnIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgcHJvZ3Jlc3MgYmFyXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQcm9ncmVzc0JhcigpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZvY3VzIGFuc3dlciBpbnB1dFxyXG4gICAgICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gcXVpeiBoYXMgZW5kZWQsIHNldCBwcm9ncmVzcyBiYXIgdG8gMFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldCgwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb247XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEN1cnJlbnRRdWVzdGlvbk51bWJlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmdldE51bWJlck9mUXVpelF1ZXN0aW9ucygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZW5kZXJRdWVzdGlvblRleHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcihnZXRRdWVzdGlvbigpLnF1ZXN0aW9uKCksICdxdWVzdGlvbi1oaWdobGlnaHQnKSArICc/JztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25NZWRpYSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXN0aW9uIHx8ICFxdWVzdGlvbi5nZXRJbmZvKCkubWVkaWEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWVzdGlvbi5nZXRJbmZvKCkubWVkaWE7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNob3dSZXN1bHRzUGFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoaWRlUmVzdWx0c1BhZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzUmVzdWx0c1BhZ2VWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoaW50c0F2YWlsYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmhpbnRzUmVtYWluaW5nKCkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uLmhpbnRzUmVtYWluaW5nKCkgPiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzdWJtaXRBbnN3ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5hbnN3ZXJJbnB1dC5hbnN3ZXIgJiYgIXF1ZXN0aW9uLmFuc3dlcmVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhbnN3ZXIgPSBTdHJpbmcoJHNjb3BlLmFuc3dlcklucHV0LmFuc3dlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgYSBudW1iZXIgaW5wdXQsIHJlcGxhY2UgJywnIHdpdGggJy4nXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlciA9IGFuc3dlci5yZXBsYWNlKCcsJywgJy4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhIG11bHRpcGxpZXIgaXMgYXZhaWxhYmxlLCBjYWxjdWxhdGUgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXIgKj0gJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgTG9nU3J2LmluZm8oJ3N1Ym1pdHRpbmcgYW5zd2VyJywgYW5zd2VyKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5wb2ludHMgPSBxdWVzdGlvbi5hbnN3ZXIoYW5zd2VyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgZm9jdXNcclxuICAgICAgICAgICAgICAgIGlmICghd2FzTGFzdFF1ZXN0aW9uKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bk5leHRRdWVzdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bkNvbnRpbnVlRmluaXNoZWQgICcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHF1ZXN0aW9uQW5zd2VyZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFRdWl6U3J2LmlzUXVpelJ1bm5pbmcoKSB8fCBxdWVzdGlvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uYW5zd2VyZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYubmV4dFF1ZXN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuYW5zd2VySW5wdXQuYW5zd2VyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVVpKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJlcXVlc3RIaW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oaW50ID0gcXVlc3Rpb24uaGludCgpO1xyXG5cclxuICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZW5kZXIgPSBmdW5jdGlvbih0ZXh0LCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRleHRcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiW1wiLCBcIjxzcGFuIGNsYXNzPSdcIiArIGNsYXNzTmFtZSArIFwiJz5cIilcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiXVwiLCBcIjwvc3Bhbj5cIik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhbmRsZUtleVByZXNzID0gZnVuY3Rpb24oa2V5RXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGtleUV2ZW50LndoaWNoID09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJtaXRBbnN3ZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3NQZXJjZW50ID0gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyKCkgLyBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKSAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXQocHJvZ3Jlc3NQZXJjZW50KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgd2FzTGFzdFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKSA+PSBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VFdmVudHMgPSBmdW5jdGlvbihldmVudHMsIHBlcnNvbmFsQmVzdCwgb3ZlcmFsbEJlc3QpIHtcclxuICAgICAgICAgICAgdmFyIGFjaGlldmVtZW50cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNob3dCZXN0cyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ292ZXJhbGxfYmVzdCcpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRHUgaGFzdCBlaW5lbiBuZXVlbiBhYnNvbHV0ZW4gUmVrb3JkIGdlc2NoYWZmdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdvdmVyYWxsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGRlbiBha3R1ZWxsZW4gYWJzb2x1dGVuIFJla29yZCBlaW5nZXN0ZWxsdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdwZXJzb25hbF9iZXN0JykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0JykgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBSZWtvcmQgZ2VzY2hhZmZ0ISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ3BlcnNvbmFsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0X2VxdWFsaXNlZCcpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGdsZWljaCB2aWVsZSBQdW5rdGUgZ2VzY2hhZmZ0IHdpZSBiZWkgZGVpbmVtIHBlcnPDtm5saWNoZW4gUmVrb3JkISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ25ld19kYWlseV9iZXN0JykgPj0gMCAmJiBhY2hpZXZlbWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBUYWdlc3Jla29yZCBnZXNjaGFmZnQhJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS5hY2hpZXZlbWVudHMgPSBhY2hpZXZlbWVudHM7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvd0Jlc3RzICYmIHBlcnNvbmFsQmVzdCAmJiBwZXJzb25hbEJlc3QuaWQgJiYgcGVyc29uYWxCZXN0LmRhdGUgJiYgcGVyc29uYWxCZXN0LnNjb3JlICYmIG92ZXJhbGxCZXN0ICYmIG92ZXJhbGxCZXN0LmlkICYmIG92ZXJhbGxCZXN0LmRhdGUgJiYgb3ZlcmFsbEJlc3Quc2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiZXN0cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIG92ZXJhbGxCZXN0LnR5cGUgPSAnb3ZlcmFsbCc7XHJcbiAgICAgICAgICAgICAgICBiZXN0cy5wdXNoKG92ZXJhbGxCZXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocGVyc29uYWxCZXN0LmlkICE9PSBvdmVyYWxsQmVzdC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbmFsQmVzdC50eXBlID0gJ3BlcnNvbmFsJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmVzdHMucHVzaChwZXJzb25hbEJlc3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IGJlc3RzO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJlc3RzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjb250aW51ZUZpbmlzaGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNob3dSZXN1bHRzUGFnZSgpO1xyXG5cclxuICAgICAgICAgICAgbmV4dFF1ZXN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25jbHVkZSB0aGUgcXVpeiBhbmQgd3JpdGUgcmVzdWx0IHRvIGRhdGFiYXNlXHJcbiAgICAgICAgICAgIFF1aXpTcnYuY29uY2x1ZGUoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRXZlbnRzKGRhdGEuZXZlbnRzIHx8IFtdLCBkYXRhLnBlcnNvbmFsQmVzdCwgZGF0YS5vdmVyYWxsQmVzdCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEJlc3RUZXh0ID0gZnVuY3Rpb24oYmVzdCkge1xyXG4gICAgICAgICAgICB2YXIgdGV4dDtcclxuXHJcbiAgICAgICAgICAgIGlmIChiZXN0LnR5cGUgPT09ICdwZXJzb25hbCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBlcnNvbmFsIGJlc3RcclxuICAgICAgICAgICAgICAgIHRleHQgPSBcIkRlaW4gcGVyc8O2bmxpY2hlciBSZWtvcmQgbGllZ3QgYmVpIDxzcGFuIGNsYXNzPSdib2xkJz57UE9JTlRTfSBQdW5rdGVuPC9zcGFuPiwgYXVmZ2VzdGVsbHQgYW0ge0RBVEV9LlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gb3ZlcmFsbCBiZXN0XHJcbiAgICAgICAgICAgICAgICB2YXIgZnJvbU15c2VsZiA9IGJlc3QuaWQgPT09ICRzY29wZS51c2VyLl9pZDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbU15c2VsZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIkR1IGjDpGx0c3QgZGVuIGFic29sdXRlbiBSZWtvcmQgbWl0IDxzcGFuIGNsYXNzPSdib2xkJz57UE9JTlRTfSBQdW5rdGVuPC9zcGFuPiwgYXVmZ2VzdGVsbHQgYW0ge0RBVEV9LlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8c3BhbiBjbGFzcz0naGlnaGxpZ2h0Jz57VVNFUk5BTUV9PC9zcGFuPiBow6RsdCBkZW4gYWJzb2x1dGVuIFJla29yZCBtaXQgPHNwYW4gY2xhc3M9J2JvbGQnPntQT0lOVFN9IFB1bmt0ZW48L3NwYW4+LCBhdWZnZXN0ZWxsdCBhbSB7REFURX0uXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoJ3tQT0lOVFN9JywgJGZpbHRlcignbnVtYmVyJykoYmVzdC5zY29yZSkpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgne0RBVEV9JywgZ2V0Rm9ybWF0dGVkRGF0ZShiZXN0LmRhdGUpKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJ3tVU0VSTkFNRX0nLCBiZXN0LnVzZXJuYW1lKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Rm9ybWF0dGVkRGF0ZSA9IGZ1bmN0aW9uKGRhdGUpIHtcclxuICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBhZChkYXRlLmdldERhdGUoKSwgJzAwJykgKyAnLicgKyBwYWQoZGF0ZS5nZXRNb250aCgpICsgMSwgJzAwJykgKyAnLicgKyAoZGF0ZS5nZXRZZWFyKCkgKyAxOTAwKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcGFkID0gZnVuY3Rpb24oc3RyLCBwYWRWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHBhZFZhbHVlICsgc3RyKS5zbGljZSgtcGFkVmFsdWUubGVuZ3RoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVzdGFydFF1aXogPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcXVpeiA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3F1aXoucmVzdGFydCcpO1xyXG5cclxuICAgICAgICAgICAgaW5pdEN0cmwoKTtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVVpKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGVudGVyTGlzdGVuZXIgPSBmdW5jdGlvbihrZXlQcmVzcywgZnVuYykge1xyXG4gICAgICAgICAgICBpZiAoa2V5UHJlc3Mud2hpY2ggPT0gMTMpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZnVuYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ25leHRfcXVlc3Rpb24nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0UXVlc3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbnRpbnVlX2ZpbmlzaGVkJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVGaW5pc2hlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdxdWl6LnN0YXJ0JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgaGlkZVJlc3VsdHNQYWdlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgLy8gY29udHJvbGxlciBpcyBiZWluZyBkZXN0cm95ZWQgKGkuZS4gdXNlciBsZWF2ZXMgdGhlIHBhZ2UsIHNvIHdlIHRlbGwgdGhlIHF1aXogc2VydmljZSB0byBkaXNwb3NlIG9mIHRoZSBxdWl6IG9iamVjdFxyXG4gICAgICAgICAgICBpZiAoUXVpelNydi5oYXNRdWl6U3RhcnRlZCgpICYmIFF1aXpTcnYuaGFzUXVpekVuZGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIFF1aXpTcnYuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGluaXQgY29udHJvbGxlclxyXG4gICAgICAgIGluaXRDdHJsKCk7XHJcblxyXG4gICAgICAgIC8vIGluaXRpYWxseSB1cGRhdGUgVUlcclxuICAgICAgICB1cGRhdGVVaSgpO1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0UXVlc3Rpb24gPSBnZXRRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyO1xyXG4gICAgICAgICRzY29wZS5yZW5kZXJRdWVzdGlvblRleHQgPSByZW5kZXJRdWVzdGlvblRleHQ7XHJcbiAgICAgICAgJHNjb3BlLnN1Ym1pdEFuc3dlciA9IHN1Ym1pdEFuc3dlcjtcclxuICAgICAgICAkc2NvcGUucXVlc3Rpb25BbnN3ZXJlZCA9IHF1ZXN0aW9uQW5zd2VyZWQ7XHJcbiAgICAgICAgJHNjb3BlLm5leHRRdWVzdGlvbiA9IG5leHRRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuaGFuZGxlS2V5UHJlc3MgPSBoYW5kbGVLZXlQcmVzcztcclxuICAgICAgICAkc2NvcGUuZ2V0UXVlc3Rpb25NZWRpYSA9IGdldFF1ZXN0aW9uTWVkaWE7XHJcbiAgICAgICAgJHNjb3BlLnJlcXVlc3RIaW50ID0gcmVxdWVzdEhpbnQ7XHJcbiAgICAgICAgJHNjb3BlLndhc0xhc3RRdWVzdGlvbiA9IHdhc0xhc3RRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuY29udGludWVGaW5pc2hlZCA9IGNvbnRpbnVlRmluaXNoZWQ7XHJcbiAgICAgICAgJHNjb3BlLmdldEJlc3RUZXh0ID0gZ2V0QmVzdFRleHQ7XHJcbiAgICAgICAgJHNjb3BlLnJlc3RhcnRRdWl6ID0gcmVzdGFydFF1aXo7XHJcbiAgICAgICAgJHNjb3BlLmhpbnRzQXZhaWxhYmxlID0gaGludHNBdmFpbGFibGU7XHJcbiAgICAgICAgJHNjb3BlLmVudGVyTGlzdGVuZXIgPSBlbnRlckxpc3RlbmVyO1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1F1aXpDdHJsJywgW1wiJHNjb3BlXCIsIFwiUXVpelNydlwiLCBcIkxvZ1NydlwiLCBmdW5jdGlvbigkc2NvcGUsIFF1aXpTcnYsIExvZ1Nydikge1xyXG5cclxuICAgICAgICB2YXIgc3RhcnRRdWl6ID0gZnVuY3Rpb24oY2IpIHtcclxuICAgICAgICAgICAgUXVpelNydi5pbml0KClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5pbmZvKFwiUXVpeiBzdGFydGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBpc1F1aXpSdW5uaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmlzUXVpelJ1bm5pbmcoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpelN0YXJ0ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuaGFzUXVpelN0YXJ0ZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpekVuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2Lmhhc1F1aXpFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRUb3RhbFBvaW50cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5nZXRUb3RhbFBvaW50cygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3F1aXoucmVzdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIExvZ1Nydi5pbmZvKCdxdWl6IHJlc3RhcnQnKTtcclxuXHJcbiAgICAgICAgICAgIFF1aXpTcnYuZGlzcG9zZSgpO1xyXG5cclxuICAgICAgICAgICAgc3RhcnRRdWl6KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3F1aXouc3RhcnQnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5zdGFydFF1aXogPSBzdGFydFF1aXo7XHJcbiAgICAgICAgJHNjb3BlLmlzUXVpelJ1bm5pbmcgPSBpc1F1aXpSdW5uaW5nO1xyXG4gICAgICAgICRzY29wZS5oYXNRdWl6U3RhcnRlZCA9IGhhc1F1aXpTdGFydGVkO1xyXG4gICAgICAgICRzY29wZS5oYXNRdWl6RW5kZWQgPSBoYXNRdWl6RW5kZWQ7XHJcbiAgICAgICAgJHNjb3BlLmdldFRvdGFsUG9pbnRzID0gZ2V0VG90YWxQb2ludHM7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgW1wiJHNjb3BlXCIsIFwiTG9nU3J2XCIsIFwiRm9jdXNTcnZcIiwgXCJVc2VyU3J2XCIsIFwiJHN0YXRlXCIsIFwiJHdpbmRvd1wiLCBmdW5jdGlvbigkc2NvcGUsIExvZ1NydiwgRm9jdXNTcnYsIFVzZXJTcnYsICRzdGF0ZSwgJHdpbmRvdykge1xyXG4gICAgICAgIC8vIG5ldyB1c2VyIG9iamVjdFxyXG4gICAgICAgICRzY29wZS5uZXdVc2VyID0ge307XHJcblxyXG4gICAgICAgIC8vIG1lc3NhZ2Ugb2JqZWN0XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbiAoaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHZhbGlkYXRlQmVmb3JlU3VibWl0KCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBlcmZvcm0gYXBpIGNhbGxcclxuICAgICAgICAgICAgICAgIFVzZXJTcnYucmVnaXN0ZXIoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwIGNvbnRyb2xsZXIgYWJvdXQgbG9naW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ2luJywgcmVzcG9uc2UuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gaG9tZSBwYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiAncmVnaXN0ZXIuc3VjY2Vzc2Z1bCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnQmVpIGRlciBBbm1lbGR1bmcgc2NoZWludCBldHdhcyBzY2hpZWYgZ2VnYW5nZW4genUgc2VpbidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlVGV4dDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXJyLm1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1VzZXJuYW1lIGFscmVhZHkgZXhpc3RzJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdEZXIgQmVudXR6ZXJuYW1lIGV4aXN0aWVydCBiZXJlaXRzJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0JlaSBkZXIgQW5tZWxkdW5nIHNjaGVpbnQgZXR3YXMgc2NoaWVmIGdlZ2FuZ2VuIHp1IHNlaW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWVzc2FnZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB2YWxpZGF0ZUJlZm9yZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgdHdvIHBhc3N3b3JkcyBtYXRjaFxyXG4gICAgICAgICAgICB2YXIgcGFzc3dvcmQgPSAkc2NvcGUubmV3VXNlci5wYXNzd29yZDtcclxuICAgICAgICAgICAgdmFyIHBhc3N3b3JkMiA9ICRzY29wZS5uZXdVc2VyLnBhc3N3b3JkMjtcclxuXHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLm5ld1VzZXIudXNlcm5hbWUgfHwgISRzY29wZS5uZXdVc2VyLmVtYWlsIHx8ICFwYXNzd29yZCB8fCAhcGFzc3dvcmQyKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdBbGxlIEZlbGRlciBtw7xzc2VuIGF1c2dlZsO8bGx0IHNlaW4nXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhc3N3b3JkID09PSBcIlwiIHx8IHBhc3N3b3JkMiA9PT0gXCJcIikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRGllIFBhc3N3w7ZydGVyIGvDtm5uZW4gbmljaHQgbGVlciBzZWluJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXNzd29yZCAhPT0gcGFzc3dvcmQyKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEaWUgUGFzc3fDtnJ0ZXIgc3RpbW1lbiBuaWNodCDDvGJlcmVpbidcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAhJHNjb3BlLm1lc3NhZ2UgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGRlbGVnYXRlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJlZ2lzdGVyKHRydWUpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG5cclxuICAgICAgICAkc2NvcGUucmVnaXN0ZXIgPSByZWdpc3RlcjtcclxuXHJcbiAgICAgICAgLy8gZm9jdXMgdXNlciBuYW1lIGZpZWxkXHJcbiAgICAgICAgRm9jdXNTcnYoJyN1c2VybmFtZScpO1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1NldHRpbmdzQ3RybCcsIFtcIiRzY29wZVwiLCBcIkFwcENvbmZpZ1wiLCBcIkZvY3VzU3J2XCIsIFwiTG9nU3J2XCIsIFwiVXNlclNydlwiLCBmdW5jdGlvbigkc2NvcGUsIEFwcENvbmZpZywgRm9jdXNTcnYsIExvZ1NydiwgVXNlclNydikge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIC8vIHVzZXIgY29sb3Vyc1xyXG4gICAgICAgICAgICB2YXIgY29sb3JzID0gQXBwQ29uZmlnWydzZXR0aW5ncy51c2VyLmNvbG9ycyddO1xyXG5cclxuICAgICAgICAgICAgLy8gdXNlciBvYmplY3RcclxuICAgICAgICAgICAgJHNjb3BlLnVzZXJPYmogPSB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogJHNjb3BlLnVzZXIudXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBlbWFpbDogJHNjb3BlLnVzZXIuZW1haWwsXHJcbiAgICAgICAgICAgICAgICBjb2xvcjogJHNjb3BlLnVzZXIuY29sb3JcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS51c2VyQ29sb3JzID0gY29sb3JzO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNldENvbG9yID0gZnVuY3Rpb24obmV3Q29sb3IpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS51c2VyT2JqLmNvbG9yID0gbmV3Q29sb3I7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICB2YXIgdXBkYXRlVXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgVXNlclNydi51cGRhdGVCYXNpYygkc2NvcGUudXNlck9iaikudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIHVzZXIgb2JqZWN0XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIudXNlcm5hbWUgPSAkc2NvcGUudXNlck9iai51c2VybmFtZTtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlci5lbWFpbCA9ICRzY29wZS51c2VyT2JqLmVtYWlsO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLmNvbG9yID0gJHNjb3BlLnVzZXJPYmouY29sb3I7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0VpbnN0ZWxsdW5nZW4gd3VyZGVuIGVyZm9sZ3JlaWNoIGdlc3BlaWNoZXJ0J1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKCdVcGRhdGUgdXNlcicsIGVycik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlVGV4dDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlcnIubWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdVc2VybmFtZSBhbHJlYWR5IGV4aXN0cyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdEZXIgQmVudXR6ZXJuYW1lIGlzdCBiZXJlaXRzIHZlcmdlYmVuJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RpZSBFaW5zdGVsbHVuZ2VuIGtvbm50ZW4gbmljaHQgZ2VzcGVpY2hlcnQgd2VyZGVuJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWVzc2FnZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGRlbGVnYXRlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVVc2VyKHRydWUpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLnNldENvbG9yID0gc2V0Q29sb3I7XHJcbiAgICAgICAgICAgICRzY29wZS51cGRhdGVVc2VyID0gdXBkYXRlVXNlcjtcclxuICAgICAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcblxyXG4gICAgICAgICAgICAvLyBmb2N1cyB1c2VybmFtZSBmaWVsZFxyXG4gICAgICAgICAgICBGb2N1c1NydignI3VzZXJuYW1lJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKCRzY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIG90aGVyd2lzZSwgd2FpdCBmb3IgdXNlci5sb2FkZWQgZXZlbnRcclxuICAgICAgICAkc2NvcGUuJG9uKCd1c2VyLmxvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5kaXJlY3RpdmUoJ3F1aXonLCBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2J1aWxkL3ZpZXdzL3RlbXBsYXRlcy9xdWl6LWRpcmVjdGl2ZS50ZW1wbGF0ZS5odG1sJyxcclxuICAgICAgICAgICAgc2NvcGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdRdWl6RGlyZWN0aXZlQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5maWx0ZXIoJ3JlbmRlckh0bWwnLCBbXCIkc2NlXCIsIGZ1bmN0aW9uKCRzY2UpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbCh0ZXh0KTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZpbHRlcigndGV4dE9yTnVtYmVyJywgW1wiJGZpbHRlclwiLCBmdW5jdGlvbigkZmlsdGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBmcmFjdGlvblNpemUpIHtcclxuICAgICAgICAgICAgZnJhY3Rpb25TaXplID0gZnJhY3Rpb25TaXplICE9PSB1bmRlZmluZWQgPyAwIDogZnJhY3Rpb25TaXplO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzTmFOKGlucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRmaWx0ZXIoJ251bWJlcicpKGlucHV0LCBmcmFjdGlvblNpemUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0F1dGhJbnRlcmNlcHRvcicsIFtcIkF1dGhUb2tlblNydlwiLCBmdW5jdGlvbihBdXRoVG9rZW5TcnYpIHtcclxuICAgICAgICB2YXIgYWRkVG9rZW4gPSBmdW5jdGlvbihjb25maWcpIHtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gQXV0aFRva2VuU3J2LmdldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVyc1snWC1BdXRoJ10gPSB0b2tlbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXF1ZXN0OiBhZGRUb2tlblxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnQXV0aFRva2VuU3J2JywgW1wiJHdpbmRvd1wiLCBmdW5jdGlvbigkd2luZG93KSB7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZTtcclxuICAgICAgICB2YXIga2V5ID0gJ2F1dGgtdG9rZW4nO1xyXG5cclxuICAgICAgICB2YXIgZ2V0VG9rZW4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmdldEl0ZW0oa2V5KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc2V0VG9rZW4gPSBmdW5jdGlvbih0b2tlbikge1xyXG4gICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHN0b3JlLnNldEl0ZW0oa2V5LCB0b2tlbik7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBzdG9yZS5yZW1vdmVJdGVtKGtleSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXRUb2tlbjogZ2V0VG9rZW4sXHJcbiAgICAgICAgICAgIHNldFRva2VuOiBzZXRUb2tlblxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnQ291bnRyeVNydicsIFtcIiRodHRwXCIsIFwiSW5kZXhlZERCU3J2XCIsIFwiTG9nU3J2XCIsIGZ1bmN0aW9uKCRodHRwLCBJbmRleGVkREJTcnYsIExvZ1Nydikge1xyXG4gICAgICAgIC8vIENvdW50cmllcyBhcnJheVxyXG4gICAgICAgIHZhciBjb3VudHJpZXMgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgY291bnRyaWVzQnlBbHBoYTMgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUxldHRlciA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIEluZGV4ZWREQlxyXG4gICAgICAgIHZhciBkYXRhYmFzZSA9ICdtYWdlbGxhbic7XHJcbiAgICAgICAgdmFyIHN0b3JlID0gJ2NvdW50cnlTdG9yZSc7XHJcbiAgICAgICAgdmFyIGtleUNvdW50cmllcyA9ICdjb3VudHJpZXMnO1xyXG4gICAgICAgIHZhciBrZXlWZXJzaW9uID0gJ3ZlcnNpb24nO1xyXG5cclxuICAgICAgICB2YXIgaW5kZXhlZERCQXZhaWxhYmxlID0gSW5kZXhlZERCU3J2LmluZGV4ZWREQkF2YWlsYWJsZSgpO1xyXG5cclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbG9hZENvdW50cmllcygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBsb2FkQ291bnRyaWVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGluZGV4ZWREQiBpcyBhdmFpbGFibGVcclxuICAgICAgICAgICAgaWYgKGluZGV4ZWREQkF2YWlsYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSBkYXRhYmFzZSBleGlzdHNcclxuICAgICAgICAgICAgICAgICAgICBJbmRleGVkREJTcnYuY3JlYXRlRGF0YWJhc2UoZGF0YWJhc2UsIHN0b3JlKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihnZXRFbXB0eU9iamVjdClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZ2V0SW50ZXJuYWxWZXJzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihnZXRFeHRlcm5hbFZlcnNpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGRldGVybWluZUxvYWRTdHJhdGVneSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4obG9hZERhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzID0gb2JqWydjb3VudHJpZXMnXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2dTcnYuaW5mbyhcImxvYWRlZCBjb3VudHJpZXMgZnJvbVwiLCBvYmpbJ2xvYWRTdHJhdGVneSddLnRvVXBwZXJDYXNlKCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZGl0aW9uYWxseSBtYXAgY291bnRyaWVzIGJ5IHZhcmlvdXMgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlBbHBoYTMgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyID0ge307XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzLmZvckVhY2goZnVuY3Rpb24oYykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ5IGFscGhhMyBjb2RlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlBbHBoYTNbY1snYWxwaGEzQ29kZSddXSA9IGM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ5IGxldHRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaXJzdExldHRlciA9IGNbJ25hbWUnXS5zdWJzdHIoMCwgMSkudG9VcHBlckNhc2UoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChmaXJzdExldHRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICfDhCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdExldHRlciA9ICdBJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnw5YnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RMZXR0ZXIgPSAnTyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ8OcJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0TGV0dGVyID0gJ1UnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50cmllc0J5TGV0dGVyW2ZpcnN0TGV0dGVyXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyW2ZpcnN0TGV0dGVyXSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlMZXR0ZXJbZmlyc3RMZXR0ZXJdLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbHBoYTNDb2RlOiBjLmFscGhhM0NvZGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGMubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShjb3VudHJpZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoXCJmYWlsZWQgdG8gbG9hZCBjb3VudHJpZXNcIiwgZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIGlmIG5vdCwgd2UgYWx3YXlzIHRyeSB0byBkb3dubG9hZCBpdCBmcm9tIHRoZSBjb3VudHJ5IEFQSSBlbmRwb2ludFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldENvdW50cmllc0Zyb21BUEkoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZXRlcm1pbmVMb2FkU3RyYXRlZ3kgPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0cmF0ZWd5O1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBpbnRlcm5hbFZlcnNpb24gPSBvYmpbXCJpbnRlcm5hbFZlcnNpb25cIl07XHJcbiAgICAgICAgICAgICAgICB2YXIgZXh0ZXJuYWxWZXJzaW9uID0gb2JqW1wiZXh0ZXJuYWxWZXJzaW9uXCJdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChpbnRlcm5hbFZlcnNpb24gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJhdGVneSA9ICdhcGknO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChleHRlcm5hbFZlcnNpb24gPiBpbnRlcm5hbFZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJhdGVneSA9ICdhcGknO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzdHJhdGVneSA9ICdkYic7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgb2JqWydsb2FkU3RyYXRlZ3knXSA9IHN0cmF0ZWd5O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvYWREYXRhID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHJhdGVneSA9IG9ialsnbG9hZFN0cmF0ZWd5J107XHJcblxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChzdHJhdGVneSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2FwaSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldENvdW50cmllc0Zyb21BUEkoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW1wiY291bnRyaWVzXCJdID0gY291bnRyaWVzO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSBjb3VudHJpZXMgYW5kIHZlcnNpb24gbnVtYmVyIGluIGRhdGFiYXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnB1dEl0ZW0oZGF0YWJhc2UsIHN0b3JlLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGtleUNvdW50cmllcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6ICBjb3VudHJpZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnB1dEl0ZW0oZGF0YWJhc2UsIHN0b3JlLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGtleVZlcnNpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiBvYmpbXCJleHRlcm5hbFZlcnNpb25cIl1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RiJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q291bnRyaWVzRnJvbURCKG9iailcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKF9vYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF9vYmopO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnVW5rbm93biBsb2FkIHN0cmF0ZWd5Jyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRFbXB0eU9iamVjdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHt9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEludGVybmFsVmVyc2lvbiA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBJbmRleGVkREJTcnYucmV0cmlldmVJdGVtKGRhdGFiYXNlLCBzdG9yZSwga2V5VmVyc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImludGVybmFsVmVyc2lvblwiXSA9IGl0ZW0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImludGVybmFsVmVyc2lvblwiXSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRFeHRlcm5hbFZlcnNpb24gPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIGdldFZlcnNpb25Gcm9tQVBJKClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHZlcnNpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBvYmpbXCJleHRlcm5hbFZlcnNpb25cIl0gPSB2ZXJzaW9uO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cmllc0Zyb21EQiA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBJbmRleGVkREJTcnYucmV0cmlldmVJdGVtKGRhdGFiYXNlLCBzdG9yZSwga2V5Q291bnRyaWVzKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqW1wiY291bnRyaWVzXCJdID0gaXRlbS52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyaWVzRnJvbUFQSSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvY291bnRyaWVzJylcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFZlcnNpb25Gcm9tQVBJID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9jb3VudHJpZXMvdmVyc2lvbicpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhLnZlcnNpb24gfHwgMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJ5QnlBbHBoYTMgPSBmdW5jdGlvbihhbHBoYTMpIHtcclxuICAgICAgICAgICAgaWYgKGNvdW50cmllc0J5QWxwaGEzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllc0J5QWxwaGEzW2FscGhhM107XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cmllcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyaWVzO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXNCeUxldHRlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoY291bnRyaWVzQnlMZXR0ZXIgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyaWVzQnlMZXR0ZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGFyZUNvdW50cmllc0xvYWRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyaWVzICE9PSBudWxsICYmIGNvdW50cmllcy5sZW5ndGggPiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXQsXHJcbiAgICAgICAgICAgIGdldENvdW50cmllczogZ2V0Q291bnRyaWVzLFxyXG4gICAgICAgICAgICBnZXRDb3VudHJ5QnlBbHBoYTM6IGdldENvdW50cnlCeUFscGhhMyxcclxuICAgICAgICAgICAgZ2V0Q291bnRyaWVzQnlMZXR0ZXI6IGdldENvdW50cmllc0J5TGV0dGVyLFxyXG4gICAgICAgICAgICBhcmVDb3VudHJpZXNMb2FkZWQ6IGFyZUNvdW50cmllc0xvYWRlZFxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnRm9jdXNTcnYnLCBbXCIkdGltZW91dFwiLCBcIiR3aW5kb3dcIiwgZnVuY3Rpb24oJHRpbWVvdXQsICR3aW5kb3cpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgLy8gdGltZW91dCBtYWtlcyBzdXJlIHRoYXQgaXMgaW52b2tlZCBhZnRlciBhbnkgb3RoZXIgZXZlbnQgaGFzIGJlZW4gdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgICAvLyBlLmcuIGNsaWNrIGV2ZW50cyB0aGF0IG5lZWQgdG8gcnVuIGJlZm9yZSB0aGUgZm9jdXMgb3JcclxuICAgICAgICAgICAgLy8gaW5wdXRzIGVsZW1lbnRzIHRoYXQgYXJlIGluIGEgZGlzYWJsZWQgc3RhdGUgYnV0IGFyZSBlbmFibGVkIHdoZW4gdGhvc2UgZXZlbnRzXHJcbiAgICAgICAgICAgIC8vIGFyZSB0cmlnZ2VyZWQuXHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSAkd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0luZGV4ZWREQlNydicsIFtcIiR3aW5kb3dcIiwgZnVuY3Rpb24oJHdpbmRvdykge1xyXG4gICAgICAgIHZhciBrZXlQYXRoID0gJ25hbWUnO1xyXG5cclxuICAgICAgICB2YXIgaW5kZXhlZERCID0gJHdpbmRvdy5pbmRleGVkREIgfHwgJHdpbmRvdy53ZWJraXRJbmRleGVkREIgfHwgJHdpbmRvdy5tc0luZGV4ZWREQjtcclxuICAgICAgICB2YXIgSURCS2V5UmFuZ2UgPSAkd2luZG93LklEQktleVJhbmdlIHx8ICR3aW5kb3cud2Via2l0SURCS2V5UmFuZ2U7XHJcblxyXG4gICAgICAgIHZhciBJREJUcmFuc2FjdGlvbiA9ICR3aW5kb3cuSURCVHJhbnNhY3Rpb24gfHwgJHdpbmRvdy53ZWJraXRJREJUcmFuc2FjdGlvbjtcclxuXHJcbiAgICAgICAgaWYgKElEQlRyYW5zYWN0aW9uKSB7XHJcbiAgICAgICAgICAgIElEQlRyYW5zYWN0aW9uLlJFQURfV1JJVEUgPSBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFIHx8ICdyZWFkd3JpdGUnO1xyXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbi5SRUFEX09OTFkgPSBJREJUcmFuc2FjdGlvbi5SRUFEX09OTFkgfHwgJ3JlYWRvbmx5JztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpbmRleGVkREJBdmFpbGFibGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGluZGV4ZWREQiA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlRGF0YWJhc2UgPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZSBpcyBhbiBpbnN0YW5jZSBvZiBJREJWZXJzaW9uQ2hhbmdlRXZlbnRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSBpZGIuY3JlYXRlT2JqZWN0U3RvcmUoc3RvcmVOYW1lLCB7IGtleVBhdGg6IGtleVBhdGggfSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZCwgdXBkYXRlLCBkZWxldGVcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFuZGxlIGVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGRyb3BEYXRhYmFzZSA9IGZ1bmN0aW9uKGRiTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRyb3Agc3VjY2Vzc2Z1bFxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBkcm9wIGZhaWxlZFxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBhZGRJdGVtID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUsIGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZGIgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gaWRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgSURCVHJhbnNhY3Rpb24uUkVBRF9XUklURSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3RBZGQgPSBzdG9yZS5hZGQoaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBZGQub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBZGQub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcHV0SXRlbSA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfV1JJVEUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0QWRkID0gc3RvcmUucHV0KGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJldHJpZXZlSXRlbSA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lLCBpdGVtTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZGIgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gaWRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSBJREJLZXlSYW5nZS5vbmx5KGl0ZW1OYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcmUub3BlbkN1cnNvcihyYW5nZSkub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZS50YXJnZXQucmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnNvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbSA9IGN1cnNvci52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmV0cmlldmVJdGVtcyA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpdGVtcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfT05MWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgc3RvcmUub3BlbkN1cnNvcigpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY3JlYXRlRGF0YWJhc2U6IGNyZWF0ZURhdGFiYXNlLFxyXG4gICAgICAgICAgICBkcm9wRGF0YWJhc2U6IGRyb3BEYXRhYmFzZSxcclxuICAgICAgICAgICAgYWRkSXRlbTogYWRkSXRlbSxcclxuICAgICAgICAgICAgcHV0SXRlbTogcHV0SXRlbSxcclxuICAgICAgICAgICAgcmV0cmlldmVJdGVtOiByZXRyaWV2ZUl0ZW0sXHJcbiAgICAgICAgICAgIHJldHJpZXZlSXRlbXM6IHJldHJpZXZlSXRlbXMsXHJcbiAgICAgICAgICAgIGluZGV4ZWREQkF2YWlsYWJsZTogaW5kZXhlZERCQXZhaWxhYmxlXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdMb2dTcnYnLCBbXCJBcHBDb25maWdcIiwgZnVuY3Rpb24oQXBwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGxvZ0luZm8gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKEFwcENvbmZpZ1tcImxvZy5pbmZvXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ0Vycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChBcHBDb25maWdbXCJsb2cuZXJyb3JcIl0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluZm86IGxvZ0luZm8sXHJcbiAgICAgICAgICAgIGVycm9yOiBsb2dFcnJvclxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnUXVpelNydicsIFtcIkFwcENvbmZpZ1wiLCBcIkNvdW50cnlTcnZcIiwgXCJTY29yZVNydlwiLCBcIkxvZ1NydlwiLCBmdW5jdGlvbihBcHBDb25maWcsIENvdW50cnlTcnYsIFNjb3JlU3J2LCBMb2dTcnYpIHtcclxuICAgICAgICB2YXIgY291bnRyaWVzID0gbnVsbDtcclxuICAgICAgICB2YXIgY291bnRyaWVzQnlBbHBoYTMgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgcXVpeiA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBzZXRDb3VudHJpZXMgPSBmdW5jdGlvbihfY291bnRyaWVzKSB7XHJcbiAgICAgICAgICAgIGNvdW50cmllcyA9IF9jb3VudHJpZXM7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNvdW50cmllc0xvYWRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyaWVzICE9PSBudWxsICYmIGNvdW50cmllcy5sZW5ndGggPiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIGlmICghY291bnRyaWVzTG9hZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiQ291bnRyaWVzIGhhdmUgbm90IGJlZW4gbG9hZGVkXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHF1aXogPSBjcmVhdGVRdWl6KCdjb3VudHJ5Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShxdWl6LnN0YXJ0KCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGlzcG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBxdWl6ID0gbnVsbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaXNRdWl6UnVubmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKSAmJiAhcXVpei5oYXNFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6U3RhcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpekVuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWl6ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouaGFzRW5kZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlUXVpeiA9IGZ1bmN0aW9uKHF1aXpUeXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocXVpelR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvdW50cnknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlQ291bnRyeVF1aXooKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVDb3VudHJ5UXVpeiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY291bnRyeVF1aXogPSBuZXcgUXVpeigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGZ1bGxQb2ludHMgPSAxMDA7XHJcbiAgICAgICAgICAgIHZhciBoaW50TWF4aW11bSA9IDM7XHJcbiAgICAgICAgICAgIHZhciBoaW50Q29zdCA9IDI1O1xyXG5cclxuICAgICAgICAgICAgdmFyIGxhc3RRdWVzdGlvbkJvbnVzID0gMi41O1xyXG5cclxuICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVHlwZXMgPSBBcHBDb25maWdbJ3F1aXouY291bnRyeS50eXBlcyddO1xyXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlc0xlbmd0aCA9IE9iamVjdC5rZXlzKHF1ZXN0aW9uVHlwZXMpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdCBjb3VudHJpZXMgZm9yIHF1ZXN0aW9uc1xyXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJpZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIG51bWJlck9mUXVlc3Rpb25zID0gQXBwQ29uZmlnWydxdWl6LmNvdW50cnkucXVlc3Rpb25zJ107XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bWJlck9mUXVlc3Rpb25zOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5T2sgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoIWNvdW50cnlPaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5ID0gY291bnRyaWVzW2dldFJhbmRvbUludCgwLCBjb3VudHJpZXMubGVuZ3RoIC0gMSldO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5T2sgPSBzZWxlY3RlZENvdW50cmllcy5pbmRleE9mKGNvdW50cnlbJ2FscGhhM0NvZGUnXSkgPCAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBzZWxlY3RlZENvdW50cmllcy5wdXNoKGNvdW50cnlbJ2FscGhhM0NvZGUnXSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIGNyZWF0ZSBxdWVzdGlvbnMgZm9yIHF1aXpcclxuICAgICAgICAgICAgdmFyIHFjbnQgPSAwO1xyXG4gICAgICAgICAgICBzZWxlY3RlZENvdW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKGFscGhhMykge1xyXG4gICAgICAgICAgICAgICAgcWNudCsrO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlID0gcXVlc3Rpb25UeXBlc1tnZXRSYW5kb21JbnQoMSwgcXVlc3Rpb25UeXBlc0xlbmd0aCldO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gZ2V0UXVlc3Rpb25UZXh0KHF1ZXN0aW9uVHlwZSwgY291bnRyeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBxdWVzdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQ6IGdldFF1ZXN0aW9uSW5wdXQocXVlc3Rpb25UeXBlKSxcclxuICAgICAgICAgICAgICAgICAgICB1bml0OiBnZXRRdWVzdGlvblVuaXQocXVlc3Rpb25UeXBlKVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIHZhciBhbnN3ZXIgPSBnZXRRdWVzdGlvbkFuc3dlcihxdWVzdGlvblR5cGUsIGNvdW50cnkpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGNoZWNrQW5zd2VyID0gZ2V0Q2hlY2tBbnN3ZXJMYW1iZGEocXVlc3Rpb25UeXBlLCBmdWxsUG9pbnRzLCBsYXN0UXVlc3Rpb25Cb251cyk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaGludHMgPSBnZXRRdWVzdGlvbkhpbnRzKHF1ZXN0aW9uVHlwZSwgaGludE1heGltdW0sIGhpbnRDb3N0KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyB0aGUgbGFzdCBxdWVzdGlvbiBpcyB0aGUgYm9udXMgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgIGlmIChxY250ID49IG51bWJlck9mUXVlc3Rpb25zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mb1snYm9udXMnXSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gYWRkIGluZm8gZm9yIGZsYWcgb2YgY291bnRyeVxyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uVHlwZSA9PT0gJ0ZMQUdfT0ZfQ09VTlRSWScpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmZvLm1lZGlhID0gJ2ZsYWcnO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm8uYWxwaGEyQ29kZSA9IGNvdW50cnkuYWxwaGEyQ29kZS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvdW50cnlRdWl6LmFkZFF1ZXN0aW9uKG5ldyBRdWVzdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBpbmZvOiBpbmZvLFxyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcjogYW5zd2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQW5zd2VyOiBjaGVja0Fuc3dlcixcclxuICAgICAgICAgICAgICAgICAgICBoaW50czogaGludHNcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyeVF1aXo7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVGV4dCA9IGZ1bmN0aW9uKHR5cGUsIGNvdW50cnkpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDQVBJVEFMX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBoZWnDn3QgZGllIEhhdXB0c3RhZHQgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiW1wiICsgY291bnRyeS5jYXBpdGFsICsgXCJdIGlzdCBkaWUgSGF1cHRzdGFkdCB2b24gd2VsY2hlbSBMYW5kXCJcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSB2aWVsZSBNZW5zY2hlbiBsZWJlbiBpbiBbXCIgKyBjb3VudHJ5Lm5hbWUgKyBcIl1cIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBncm/DnyBpc3QgZGllIEZsw6RjaGUgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0ZMQUdfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2VsY2hlcyBMYW5kIGhhdCBkaWVzZSBGbGFnZ2VcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIj9cIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uQW5zd2VyID0gZnVuY3Rpb24odHlwZSwgY291bnRyeSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NBUElUQUxfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFsdFNwZWxsaW5ncyA9IGNvdW50cnkuYWx0U3BlbGxpbmdzICE9PSB1bmRlZmluZWQgJiYgY291bnRyeS5hbHRTcGVsbGluZ3NbJ2NhcGl0YWwnXSAhPT0gdW5kZWZpbmVkID8gY291bnRyeS5hbHRTcGVsbGluZ3NbJ2NhcGl0YWwnXSA6IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LmNhcGl0YWwsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsdFNwZWxsaW5nczogYWx0U3BlbGxpbmdzXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdDT1VOVFJZX09GX0NBUElUQUwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnRkxBR19PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWx0U3BlbGxpbmdzID0gY291bnRyeS5hbHRTcGVsbGluZ3MgIT09IHVuZGVmaW5lZCAmJiBjb3VudHJ5LmFsdFNwZWxsaW5nc1snbmFtZSddICE9PSB1bmRlZmluZWQgPyBjb3VudHJ5LmFsdFNwZWxsaW5nc1snbmFtZSddIDogW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnJlY3Q6IGNvdW50cnkubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0U3BlbGxpbmdzOiBhbHRTcGVsbGluZ3NcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5wb3B1bGF0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnJlY3Q6IGNvdW50cnkuYXJlYVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvbklucHV0ID0gZnVuY3Rpb24odHlwZSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdudW1iZXIuaGlnaCc7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ251bWJlci5tZWRpdW0nO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NBUElUQUxfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDT1VOVFJZX09GX0NBUElUQUwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnRkxBR19PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICd0ZXh0LnN0YW5kYXJkJztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvblVuaXQgPSBmdW5jdGlvbih0eXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ2ttwrInO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdFaW53b2huZXInO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q2hlY2tBbnN3ZXJMYW1iZGEgPSBmdW5jdGlvbih0eXBlLCBmdWxsUG9pbnRzLCBsYXN0UXVlc3Rpb25Cb251cykge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NBUElUQUxfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDT1VOVFJZX09GX0NBUElUQUwnOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnRkxBR19PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYW5zd2VyLCBzdWJtaXR0ZWRBbnN3ZXIsIGhpbnRzVXNlZCwgaGludENvc3QsIGluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvcnJlY3QgPSBzdWJtaXR0ZWRBbnN3ZXIgPT09IGFuc3dlci5jb3JyZWN0IHx8IChhbnN3ZXIuYWx0U3BlbGxpbmdzICYmIGFuc3dlci5hbHRTcGVsbGluZ3MuaW5kZXhPZihzdWJtaXR0ZWRBbnN3ZXIpID49IDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50cyA9IGNvcnJlY3QgPyBmdWxsUG9pbnRzIDogMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGhpbnRzIGFyZSBhbGxvd2VkIGFuZCBoYXZlIGJlZW4gdXNlZCwgc3VidHJhY3QgdGhlIHBvaW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGludHNVc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzIC09IChoaW50c1VzZWQgKiBoaW50Q29zdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJvbnVzIHBvaW50cyBmb3IgbGFzdCBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mbyAhPT0gdW5kZWZpbmVkICYmIGluZm8uYm9udXMgIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgKj0gbGFzdFF1ZXN0aW9uQm9udXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYW5zd2VyLCBzdWJtaXR0ZWRBbnN3ZXIsIGhpbnRzVXNlZCwgaGludENvc3QsIGluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHBlcmNlbnRhZ2UgZGlmZmVyZW5jZSBmcm9tIGNvcnJlY3QgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvclBlcmNlbnRhZ2UgPSBNYXRoLmFicyhzdWJtaXR0ZWRBbnN3ZXIgLSBhbnN3ZXIuY29ycmVjdCkgLyBhbnN3ZXIuY29ycmVjdCAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludHM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDEwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gNikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gOTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDgwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNzA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDE0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA2MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAzMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDIwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAzMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBoaW50cyBhcmUgYWxsb3dlZCBhbmQgaGF2ZSBiZWVuIHVzZWQsIHN1YnRyYWN0IHRoZSBwb2ludHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhpbnRzVXNlZCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyAtPSAoaGludHNVc2VkICogaGludENvc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBib251cyBwb2ludHMgZm9yIGxhc3QgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8gIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzICE9PSB1bmRlZmluZWQgJiYgaW5mby5ib251cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzICo9IGxhc3RRdWVzdGlvbkJvbnVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25IaW50cyA9IGZ1bmN0aW9uKHR5cGUsIGhpbnRzUG9zc2libGUsIGhpbnRDb3N0KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heGltdW06IGhpbnRzUG9zc2libGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvc3Q6IGhpbnRDb3N0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnaXZlOiBmdW5jdGlvbihoaW50c1VzZWQsIGFuc3dlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuc3dlci5jb3JyZWN0LnN1YnN0cigwLCBoaW50c1VzZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2VkOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXROdW1iZXJPZlF1ZXN0aW9ucygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDdXJyZW50UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmN1cnJlbnRRdWVzdGlvbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBuZXh0UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcXVpei5uZXh0UXVlc3Rpb24oKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHF1aXogPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRUb3RhbFBvaW50cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29uY2x1ZGVzIHRoZSBxdWl6IGFuZCBwdXRzIHRoZSBzY29yZSB0byB0aGUgQVBJIGVuZHBvaW50LlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBjb25jbHVkZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocXVpeiAhPT0gbnVsbCAmJiBxdWl6Lmhhc0VuZGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocXVpei5zdWJtaXR0ZWQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdRdWl6IGhhcyBhbHJlYWR5IGJlZW4gc3VibWl0dGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBxdWl6LnN1Ym1pdHRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFNjb3JlU3J2LnB1dEhpZ2hzY29yZShxdWl6LmdldFRvdGFsUG9pbnRzKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdObyBxdWl6IGlzIGN1cnJlbnRseSBydW5uaW5nJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXQsXHJcbiAgICAgICAgICAgIHNldENvdW50cmllczogc2V0Q291bnRyaWVzLFxyXG4gICAgICAgICAgICBpc1F1aXpSdW5uaW5nOiBpc1F1aXpSdW5uaW5nLFxyXG4gICAgICAgICAgICBoYXNRdWl6U3RhcnRlZDogaGFzUXVpelN0YXJ0ZWQsXHJcbiAgICAgICAgICAgIGhhc1F1aXpFbmRlZDogaGFzUXVpekVuZGVkLFxyXG4gICAgICAgICAgICBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXI6IGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcixcclxuICAgICAgICAgICAgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zOiBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMsXHJcbiAgICAgICAgICAgIGdldEN1cnJlbnRRdWVzdGlvbjogZ2V0Q3VycmVudFF1ZXN0aW9uLFxyXG4gICAgICAgICAgICBuZXh0UXVlc3Rpb246IG5leHRRdWVzdGlvbixcclxuICAgICAgICAgICAgZ2V0VG90YWxQb2ludHM6IGdldFRvdGFsUG9pbnRzLFxyXG4gICAgICAgICAgICBjb25jbHVkZTogY29uY2x1ZGUsXHJcbiAgICAgICAgICAgIGRpc3Bvc2U6IGRpc3Bvc2VcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1Njb3JlU3J2JywgW1wiJGh0dHBcIiwgZnVuY3Rpb24oJGh0dHApIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBlbnRpcmUgaGlnaHNjb3JlIGxpc3QgaW4gYW4gYXJyYXkgZnJvbSB0aGUgQVBJLlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBnZXRIaWdoc2NvcmVMaXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9zY29yZXMvYWxsJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobGlzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBoaWdoc2NvcmUgb2JqZWN0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogSWYgdGhlIHVzZXIgaGFzIG5vIHJlc3VsdCB5ZXQsIGFuIGVtcHR5IG9iamVjdCBpcyByZXR1cm5lZC5cclxuICAgICAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgZ2V0VXNlckhpZ2hzY29yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvc2NvcmVzL3VzZXInKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRmV0Y2hlcyB0aGUgaGlnaHNjb3JlIG9iamVjdCBmb3IgdGhlIG92ZXJhbGwgaGlnaHNjb3JlLlxyXG4gICAgICAgICAqIElmIHRoZXJlIGlzIGN1cnJlbnRseSBubyByZXN1bHQgeWV0LCBhbiBlbXB0eSBvYmplY3QgaXMgcmV0dXJuZWQuXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGdldE92ZXJhbGxIaWdoc2NvcmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3Njb3Jlcy9oaWdoJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihzY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNjb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFB1dHMgYSBoaWdoc2NvcmUgcmVzdWx0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogQHBhcmFtIHNjb3JlICAgICBOdW1iZXIgd2l0aCB0aGUgYWNoaWV2ZWQgc2NvcmUuXHJcbiAgICAgICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHB1dEhpZ2hzY29yZSA9IGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS9zY29yZXMnLCB7IHNjb3JlOiBzY29yZSB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldEhpZ2hzY29yZUxpc3Q6IGdldEhpZ2hzY29yZUxpc3QsXHJcbiAgICAgICAgICAgIGdldFVzZXJIaWdoc2NvcmU6IGdldFVzZXJIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIGdldE92ZXJhbGxIaWdoc2NvcmU6IGdldE92ZXJhbGxIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIHB1dEhpZ2hzY29yZTogcHV0SGlnaHNjb3JlXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdVc2VyU3J2JywgW1wiJGh0dHBcIiwgXCJBdXRoVG9rZW5TcnZcIiwgXCJBcHBDb25maWdcIiwgZnVuY3Rpb24oJGh0dHAsIEF1dGhUb2tlblNydiwgQXBwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXInKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlckZyb21TdG9yYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IEF1dGhUb2tlblNydi5nZXRUb2tlbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIEF1dGhUb2tlblNydi5zZXRUb2tlbih0b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGdldFVzZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyB0b2tlbiwgd2UgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gdG9rZW4gaW4gc3RvcmFnZVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb24nLCB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi50b2tlbiA9IHJlc3BvbnNlLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB0b2tlbiBsb2NhbGx5XHJcbiAgICAgICAgICAgICAgICBBdXRoVG9rZW5TcnYuc2V0VG9rZW4oc2VsZi50b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFVzZXIoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRva2VuID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdG9rZW4gbG9jYWxseVxyXG4gICAgICAgICAgICAgICAgQXV0aFRva2VuU3J2LnNldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbihuZXdVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBhIHJhbmRvbSBjb2xvciBmb3IgdGhlIHVzZXJcclxuICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcHBDb25maWdbJ3NldHRpbmdzLnVzZXIuY29sb3JzJ107XHJcbiAgICAgICAgICAgICAgICBuZXdVc2VyLmNvbG9yID0gY29sb3JzW2dldFJhbmRvbUludCgwLCBjb2xvcnMubGVuZ3RoIC0gMSldO1xyXG5cclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcicsIG5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSBsb2cgdGhlIHVzZXIgaW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9naW4obmV3VXNlci51c2VybmFtZSwgbmV3VXNlci5wYXNzd29yZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkgIDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlQmFzaWMgPSBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS91c2VyL2Jhc2ljJywgdXNlcilcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFVzZXI6IGdldFVzZXIsXHJcbiAgICAgICAgICAgIGdldFVzZXJGcm9tU3RvcmFnZTogZ2V0VXNlckZyb21TdG9yYWdlLFxyXG4gICAgICAgICAgICBsb2dpbjogbG9naW4sXHJcbiAgICAgICAgICAgIGxvZ291dDogbG9nb3V0LFxyXG4gICAgICAgICAgICByZWdpc3RlcjogcmVnaXN0ZXIsXHJcbiAgICAgICAgICAgIHVwZGF0ZUJhc2ljOiB1cGRhdGVCYXNpY1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7IiwiLy8gb3duIGNsYXNzZXMgYW5kIGZ1bmN0aW9uc1xyXG5cclxuLy8gLS0tLS0tLS0tLSBRVUlaIC0tLS0tLS0tLS1cclxudmFyIFF1aXogPSBmdW5jdGlvbigpIHtcclxuICAgIC8vIGluZGV4IG9mIGN1cnJlbnQgcXVlc3Rpb25cclxuICAgIHZhciBjdXJyZW50UXVlc3Rpb25JZHggPSBudWxsO1xyXG5cclxuICAgIC8vIGFycmF5IGNvbnRhaW5pbmcgYWxsIHF1ZXN0aW9uc1xyXG4gICAgdmFyIHF1ZXN0aW9ucyA9IFtdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHRoZSBxdWl6LlxyXG4gICAgICovXHJcbiAgICB0aGlzLnN0YXJ0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gY2hlY2sgaWYgcXVpeiBoYXMgcXVlc3Rpb25zXHJcbiAgICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPD0gMClcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDYW5ub3Qgc3RhcnQgYSBxdWl6IHdpdGhvdXQgcXVlc3Rpb25zXCIpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5uZXh0UXVlc3Rpb24oKTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pc0FjdGl2ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhhc1N0YXJ0ZWQoKSAmJiAhdGhpcy5oYXNFbmRlZCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmhhc1N0YXJ0ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY3VycmVudFF1ZXN0aW9uSWR4ICE9PSBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmhhc0VuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzU3RhcnRlZCgpICYmIGN1cnJlbnRRdWVzdGlvbklkeCA+PSBxdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIG5ldyBxdWVzdGlvbiB0byB0aGUgcXVpei5cclxuICAgICAqIFRoZSBwYXJhbWV0ZXIgbXVzdCBiZSBhbiBxdWVzdGlvbiBvYmplY3QuXHJcbiAgICAgKiBJZiBubyBxdWVzdGlvbiBvYmplY3QgaXMgcGFzc2VkIG9yIGFuIG9iamVjdCB3aXRoIG1pc3NpbmcgcHJvcGVydGllcywgYW4gZXJyb3IgaXMgdGhyb3duLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmFkZFF1ZXN0aW9uID0gZnVuY3Rpb24ocXVlc3Rpb24pIHtcclxuICAgICAgICBpZiAocXVlc3Rpb24gPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJObyBxdWVzdGlvbiBvYmplY3QgcGFzc2VkXCIpO1xyXG5cclxuICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBhIHF1ZXN0aW9uIG9iamVjdCBtdXN0IGNvbnRhaW4gYWxsIHRoZXNlIHByb3BlcnRpZXNcclxuICAgICAgICB2YXIgbmVjZXNzYXJ5UHJvcGVydGllcyA9IFsnY29uZmlnJywgJ2hpbnQnLCAnc29sdXRpb24nLCAnYW5zd2VyJywgJ3F1ZXN0aW9uJywgJ2dldEluZm8nLCAnaW5mbycsICdwb2ludHMnLCAnYW5zd2VyZWQnLCAnaGludHNBbGxvd2VkJywgJ2hpbnRzUmVtYWluaW5nJ107XHJcblxyXG4gICAgICAgIG5lY2Vzc2FyeVByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXN0aW9uLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlF1ZXN0aW9uIG11c3QgaGF2ZSBwcm9wZXJ0eSAnXCIgKyBwcm9wZXJ0eSArIFwiJ1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodmFsaWQpIHtcclxuICAgICAgICAgICAgcXVlc3Rpb25zLnB1c2gocXVlc3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBuZXh0IHF1ZXN0aW9uIG9mIHRoZSBxdWl6LlxyXG4gICAgICogSWYgdGhlIHF1aXogaGFzIGVuZGVkLCBpdCByZXR1cm5zIG5vdGhpbmcuXHJcbiAgICAgKi9cclxuICAgIHRoaXMubmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRRdWVzdGlvbklkeCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjdXJyZW50UXVlc3Rpb25JZHggPSAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRRdWVzdGlvbklkeCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaGFzRW5kZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zW2N1cnJlbnRRdWVzdGlvbklkeF07XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuY3VycmVudFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zW2N1cnJlbnRRdWVzdGlvbklkeF07XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc1N0YXJ0ZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0b3RhbFBvaW50cyA9IDA7XHJcblxyXG4gICAgICAgIHF1ZXN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHMgPSBxdWVzdGlvbi5wb2ludHMoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwb2ludHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdG90YWxQb2ludHMgKz0gcG9pbnRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0b3RhbFBvaW50cztcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY3VycmVudFF1ZXN0aW9uSWR4ID09PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRRdWVzdGlvbklkeCArIDE7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0TnVtYmVyT2ZRdWVzdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zLmxlbmd0aDtcclxuICAgIH07XHJcbn07XHJcblxyXG4vLyAtLS0tLS0tLS0tIFFVRVNUSU9OIC0tLS0tLS0tLS1cclxudmFyIFF1ZXN0aW9uID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgLy8gVGV4dCBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciB0ZXh0ID0gbnVsbDtcclxuXHJcbiAgICAvLyBJbmZvIG9iamVjdCBmb3IgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgaW5mbyA9IG51bGw7XHJcblxyXG4gICAgLy8gQW5zd2VyIG9mIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIGFuc3dlciA9IG51bGw7XHJcblxyXG4gICAgLy8gSGludHMgb2YgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgaGludHMgPSBudWxsO1xyXG4gICAgdmFyIGhpbnRzVXNlZCA9IDA7XHJcblxyXG4gICAgLy8gTGFtYmRhIGZ1bmN0aW9uIHRvIGRldGVybWluZSB0aGUgYW5zd2VyIHN0YXR1cyBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBjaGVja0Fuc3dlciA9IG51bGw7XHJcblxyXG4gICAgLy8gUG9pbnRzIGF3YXJkZWQgZm9yIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIHBvaW50cyA9IG51bGw7XHJcblxyXG4gICAgLy8gRmxhZyBpbmRpY2F0aW5nIHdoZXRoZXIgcXVlc3Rpb24gaGFzIGFscmVhZHkgYmVlbiBhbnN3ZXJlZFxyXG4gICAgdmFyIGFuc3dlcmVkID0gZmFsc2U7XHJcblxyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbihvcHRzKSB7XHJcbiAgICAgICAgdGV4dCA9IG9wdHMudGV4dDtcclxuICAgICAgICBpbmZvID0gb3B0cy5pbmZvIHx8IHt9O1xyXG4gICAgICAgIGFuc3dlciA9IG9wdHMuYW5zd2VyO1xyXG4gICAgICAgIGNoZWNrQW5zd2VyID0gb3B0cy5jaGVja0Fuc3dlciB8fCBudWxsO1xyXG5cclxuICAgICAgICBoaW50cyA9IG9wdHMuaGludHMgfHwge1xyXG4gICAgICAgICAgICAgICAgYWxsb3dlZDogZmFsc2UsICAgICAvLyBpcyBhIGhpbnQgYWxsb3dlZD9cclxuICAgICAgICAgICAgICAgIG1heGltdW06IDAsICAgICAgICAgLy8gbWF4aW11bSBudW1iZXIgb2YgaGludHMgZm9yIHRoaXMgcXVlc3Rpb24gKGlycmVsZXZhbnQgaWYgYWxsb3dlZCBpcyBzZXQgdG8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICBjb3N0OiAwLCAgICAgICAgICAgIC8vIG51bWJlciBvZiBwb2ludHMgc3VidHJhY3RlZCBwZXIgdXNlZCBoaW50IChpcnJlbGV2YW50IGlmIGFsbG93ZWQgaXMgc2V0IHRvIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgZ2l2ZTogbnVsbCAgICAgICAgICAvLyBsYW1iZGEgZnVuY3Rpb24gdG8gZ2l2ZSBhIGhpbnQgZm9yIGEgcXVlc3Rpb25cclxuICAgICAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICBpbml0KG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY29uZmlnID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgICAgIGluaXQob3B0cyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgcXVlc3Rpb24gdGV4dC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5xdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHF1ZXN0aW9uIGluZm8gb2JqZWN0LlxyXG4gICAgICogQWN0cyBhcyBnZXR0ZXIgKHdpdGggb25seSBvbmUgYXJndW1lbnQpIGFuZCBzZXR0ZXIgKHdpdGggdHdvIGFyZ3VtZW50cylcclxuICAgICAqL1xyXG4gICAgdGhpcy5pbmZvID0gZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAvLyBzZXR0ZXJcclxuICAgICAgICAgICAgaW5mb1twcm9wXSA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGdldHRlclxyXG4gICAgICAgICAgICByZXR1cm4gaW5mb1twcm9wXTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgZW50aXJlIGluZm8gb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICB0aGlzLmdldEluZm8gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBjb3JyZWN0IGFuc3dlciB0byB0aGUgcXVlc3Rpb24gYWZ0ZXIgdGhlIHF1ZXN0aW9uIGhhcyBiZWVuIGFuc3dlcmVkLlxyXG4gICAgICogSWYgdGhlIHF1ZXN0aW9uIGhhcyBub3QgYmVlbiBhbnN3ZXJlZCB5ZXQsIGl0IHJldHVybnMgbnVsbC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5zb2x1dGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChhbnN3ZXJlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYW5zd2VyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGhpbnQgZm9yIHRoZSBxdWVzdGlvbi5cclxuICAgICAqIElmIG5vIGhpbnRzIGFyZSBhbGxvd2VkLCBvciB0aGUgbWF4aW11bSBudW1iZXIgb2YgaGludHMgaGF2ZSBiZWVuIHVzZWQsIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuaGludCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghaGludHMuYWxsb3dlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoaW50cy5hbGxvd2VkICYmICFoaW50cy5naXZlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkhpbnRzIGFsbG93ZWQgYnV0IG5vIGdpdmUgbWV0aG9kIHBhc3NlZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoaW50c1VzZWQgPCBoaW50cy5tYXhpbXVtKSB7XHJcbiAgICAgICAgICAgIGhpbnRzVXNlZCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGhpbnRzLmdpdmUoaGludHNVc2VkLCBhbnN3ZXIpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFN1Ym1pdHMgYW4gYW5zd2VyIHRvIHRoZSBxdWVzdGlvbi5cclxuICAgICAqIElmIHRoZSBxdWVzdGlvbiBoYXMgYWxyZWFkeSBiZWVuIGFuc3dlcmVkIG9yIG5vIGNoZWNrQW5zd2VyIGxhbWJkYSBoYXMgYmVlbiBzZXQsIHRoaXMgbWV0aG9kIGRvZXMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgdGhpcy5hbnN3ZXIgPSBmdW5jdGlvbihzdWJtaXR0ZWRBbnN3ZXIpIHtcclxuICAgICAgICBpZiAoYW5zd2VyZWQgfHwhY2hlY2tBbnN3ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYW5zd2VyZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBjaGVja0Fuc3dlciBtZXRob2Qgc2hvdWxkIHJldHVybiB0aGUgc3RhdHVzIHJlc3VsdHNcclxuICAgICAgICBwb2ludHMgPSBjaGVja0Fuc3dlcihhbnN3ZXIsIHN1Ym1pdHRlZEFuc3dlciwgaGludHNVc2VkLCBoaW50cy5jb3N0LCBpbmZvKTtcclxuXHJcbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgbm8gbmVnYXRpdmUgcG9pbnRzIGFyZSBhd2FyZGVkXHJcbiAgICAgICAgcG9pbnRzID0gTWF0aC5tYXgoMCwgcG9pbnRzKTtcclxuXHJcbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgb25seSBpbnRlZ2VyIHZhbHVlcyBhcmUgc2F2ZWRcclxuICAgICAgICBwb2ludHMgPSBNYXRoLmZsb29yKHBvaW50cyk7XHJcblxyXG4gICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMucG9pbnRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFhbnN3ZXJlZCB8fCBwb2ludHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBvaW50cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHN0YXRlIG9mIHRoZSBxdWVzdGlvbi5cclxuICAgICAqL1xyXG4gICAgdGhpcy5hbnN3ZXJlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBhbnN3ZXJlZDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgaGludHMgYXJlIGFsbG93ZWQgZm9yIHRoaXMgcXVlc3Rpb24sIGZhbHNlIGlmIG5vdC5cclxuICAgICAqIElmIGhpbnRzIGhhdmUgbm90IGJlZW4gaW5pdGlhbGl6ZWQgeWV0LCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmhpbnRzQWxsb3dlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGludHMuYWxsb3dlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByZW1haW5pbmcgaGludHMuXHJcbiAgICAgKiBJZiBubyBoaW50cyBhcmUgYWxsb3dlZCBmb3IgdGhpcyBxdWVzdGlvbiwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5oaW50c1JlbWFpbmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhbGxvd2VkID0gdGhpcy5oaW50c0FsbG93ZWQoKTtcclxuXHJcbiAgICAgICAgaWYgKGFsbG93ZWQgPT09IG51bGwgfHwgYWxsb3dlZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaGludHMubWF4aW11bSAtIGhpbnRzVXNlZDtcclxuICAgIH07XHJcbn07XHJcblxyXG4vKipcclxuICogUmV0dXJucyBhIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIChpbmNsdXNpdmUpIGFuZCBtYXggKGluY2x1c2l2ZSlcclxuICogVXNpbmcgTWF0aC5yb3VuZCgpIHdpbGwgZ2l2ZSB5b3UgYSBub24tdW5pZm9ybSBkaXN0cmlidXRpb24hXHJcbiAqL1xyXG52YXIgZ2V0UmFuZG9tSW50ID0gZnVuY3Rpb24obWluLCBtYXgpIHtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIHRleHQgYmV0d2VlbiB0d28gZGVsaW1pdGluZyB0ZXh0IG9jY3VycmVuY2VzXHJcbiAqL1xyXG52YXIgZ2V0U3RyaW5nQmV0d2VlbiA9IGZ1bmN0aW9uKHRleHQsIGZpcnN0U3RyaW5nLCBzZWNvbmRTdHJpbmcpIHtcclxuICAgIHZhciBmaXJzdFBvcyA9IHRleHQuaW5kZXhPZihmaXJzdFN0cmluZyk7XHJcbiAgICB2YXIgc2Vjb25kUG9zID0gdGV4dC5pbmRleE9mKHNlY29uZFN0cmluZyk7XHJcblxyXG4gICAgaWYgKGZpcnN0UG9zID49IDAgJiYgc2Vjb25kUG9zID49IDAgJiYgc2Vjb25kUG9zID4gZmlyc3RQb3MpIHtcclxuICAgICAgICByZXR1cm4gdGV4dC5zdWJzdHIoZmlyc3RQb3MgKyAxLCBzZWNvbmRQb3MgLSBmaXJzdFBvcyAtIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XHJcbiAgICBtb2R1bGUuZXhwb3J0cy5RdWVzdGlvbiA9IFF1ZXN0aW9uO1xyXG4gICAgbW9kdWxlLmV4cG9ydHMuUXVpeiA9IFF1aXo7XHJcbn0iLCJhbmd1bGFyLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbmZpZyhmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgIC8vIGVuYWJsZSBIVE1MNSBwdXNoc3RhdGVcclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XHJcblxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9ob21lJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hvbWUucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHBhcmFtczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogbnVsbFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3F1aXonLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvcXVpeicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9xdWl6LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb3VudHJpZXMnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2NvdW50cmllcy5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzLmRldGFpbCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy86YWxwaGEzQ29kZScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9jb3VudHJpZXMtZGV0YWlsLnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdsb2dpbicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9sb2dpbicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9sb2dpbi5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnbG9nb3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ291dCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9nb3V0Q3RybCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9yZWdpc3Rlci5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnc2V0dGluZ3MnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvc2V0dGluZ3MucGFydGlhbC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2Fib3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2Fib3V0JyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2Fib3V0LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdoaWdoc2NvcmUnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvaGlnaHNjb3JlJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hpZ2hzY29yZS5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzLWRpZmZpY3VsdHknLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzLWRpZmZpY3VsdHknLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvY291bnRyeS1kaWZmaWN1bHR5LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdDb3VudHJpZXNDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBDb3VudHJ5U3J2KSB7XHJcbiAgICAgICAgdmFyIGNvdW50cmllc0J5TGV0dGVyID0gbnVsbDtcclxuICAgICAgICB2YXIgY291bnRyeUtleXMgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlciA9IENvdW50cnlTcnYuZ2V0Q291bnRyaWVzQnlMZXR0ZXIoKTtcclxuICAgICAgICAgICAgY291bnRyeUtleXMgPSBPYmplY3Qua2V5cyhjb3VudHJpZXNCeUxldHRlcik7XHJcblxyXG4gICAgICAgICAgICBpZiAoISRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5S2V5cyA9IGNvdW50cnlLZXlzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJpZXNCeUxldHRlciA9IGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeUtleXMgPSBjb3VudHJ5S2V5cztcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJpZXNCeUxldHRlciA9IGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKENvdW50cnlTcnYuYXJlQ291bnRyaWVzTG9hZGVkKCkpIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignY291bnRyaWVzLmxvYWRlZCcsIGZ1bmN0aW9uKCkgIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0NvdW50cnlEZXRhaWxDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBDb3VudHJ5U3J2LCAkc3RhdGVQYXJhbXMpIHtcclxuICAgICAgICB2YXIgYWxwaGEzQ29kZSA9ICRzdGF0ZVBhcmFtcy5hbHBoYTNDb2RlO1xyXG5cclxuICAgICAgICBpZiAoQ291bnRyeVNydi5hcmVDb3VudHJpZXNMb2FkZWQoKSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuY291bnRyeSA9IENvdW50cnlTcnYuZ2V0Q291bnRyeUJ5QWxwaGEzKGFscGhhM0NvZGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignY291bnRyaWVzLmxvYWRlZCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cnkgPSBDb3VudHJ5U3J2LmdldENvdW50cnlCeUFscGhhMyhhbHBoYTNDb2RlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cnlGcm9tU2VydmljZSA9IGZ1bmN0aW9uKGFscGhhMykge1xyXG4gICAgICAgICAgICByZXR1cm4gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0Q291bnRyeUZyb21TZXJ2aWNlID0gZ2V0Q291bnRyeUZyb21TZXJ2aWNlO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0NvdW50cnlEaWZmaWN1bHR5Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgQ291bnRyeVNydikge1xyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3VudHJpZXMgPSBDb3VudHJ5U3J2LmdldENvdW50cmllcygpO1xyXG4gICAgICAgICAgICB2YXIgZGlmZmljdWx0aWVzID0ge1xyXG4gICAgICAgICAgICAgICAgJ2Vhc3knOiBbXSxcclxuICAgICAgICAgICAgICAgICdtZWRpdW0nOiBbXSxcclxuICAgICAgICAgICAgICAgICdoYXJkJzogW10sXHJcbiAgICAgICAgICAgICAgICAndW5hc3NpZ25lZCc6IFtdXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBkZXRlcm1pbmUgZGlmZmljdWx0eVxyXG4gICAgICAgICAgICBjb3VudHJpZXMuc29ydChmdW5jdGlvbihhLCBiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYi5wb3B1bGF0aW9uIC0gYS5wb3B1bGF0aW9uO1xyXG4gICAgICAgICAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdFdXJvcGUnKSA+PSAwIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgYy5zdWJyZWdpb24uaW5kZXhPZignQXVzdHJhbGlhIGFuZCBOZXcgWmVhbGFuZCcpID49IDAgfHxcclxuICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignU291dGggQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDI1MDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGMuc3VicmVnaW9uLmluZGV4T2YoJ05vcnRoZXJuIEFtZXJpY2EnKSA+PSAwIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0NlbnRyYWwgQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDEwMDAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQWZyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdBc2lhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gNTAwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgIGMubmFtZSA9PT0gJ1TDvHJrZWknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZWFzeVxyXG4gICAgICAgICAgICAgICAgICAgIGMuZGlmZmljdWx0eSA9ICdlYXN5JztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGMuc3VicmVnaW9uLmluZGV4T2YoJ0FmcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDE1MDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0FzaWEnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA+PSAxMDAwMDAwMCkgIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignU291dGggQW1lcmljYScpID49IDAgJiYgYy5wb3B1bGF0aW9uID49IDEwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQ2VudHJhbCBBbWVyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQ2FyaWJiZWFuJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPj0gMTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsnVHVuZXNpZW4nLCAnQXNlcmJhaWRzY2hhbicsICdWZXJlaW5pZ3RlIEFyYWJpc2NoZSBFbWlyYXRlJywgJ0dlb3JnaWVuJywgJ0FybWVuaWVuJ10uaW5kZXhPZihjLm5hbWUpID49IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBtZWRpdW1cclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAnbWVkaXVtJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKGMuc3VicmVnaW9uLmluZGV4T2YoJ1NvdXRoIEFtZXJpY2EnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA8IDEwMDAwMDApIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoYy5zdWJyZWdpb24uaW5kZXhPZignQWZyaWNhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPCAxNTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdBc2lhJykgPj0gMCAmJiBjLnBvcHVsYXRpb24gPCAxMDAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnN1YnJlZ2lvbi5pbmRleE9mKCdDZW50cmFsIEFtZXJpY2EnKSA+PSAwICYmIGMucG9wdWxhdGlvbiA8IDEwMDAwMDAwKSB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGMuc3VicmVnaW9uLmluZGV4T2YoJ0NhcmliYmVhbicpID49IDAgJiYgYy5wb3B1bGF0aW9uIDwgMTAwMDAwMCkgfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjLnJlZ2lvbi5pbmRleE9mKCdPY2VhbmlhJykgPj0gMCAmJiBjLnN1YnJlZ2lvbiAhPT0gJ0F1c3RyYWxpYSBhbmQgTmV3IFplYWxhbmQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhhcmRcclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAnaGFyZCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVuYXNzaWduZWRcclxuICAgICAgICAgICAgICAgICAgICBjLmRpZmZpY3VsdHkgPSAndW5hc3NpZ25lZCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZGlmZmljdWx0aWVzW2MuZGlmZmljdWx0eV0ucHVzaChjKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHRpZXMgPSBkaWZmaWN1bHRpZXM7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0eUtleXMgPSBPYmplY3Qua2V5cyhkaWZmaWN1bHRpZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0aWVzID0gZGlmZmljdWx0aWVzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHR5S2V5cyA9IE9iamVjdC5rZXlzKGRpZmZpY3VsdGllcyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmIChDb3VudHJ5U3J2LmFyZUNvdW50cmllc0xvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NvdW50cmllcy5sb2FkZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignRHJvcGRvd25DdHJsJywgZnVuY3Rpb24oJHNjb3BlKSB7XHJcbiAgICAgICAgdmFyIHZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnRvZ2dsZURyb3Bkb3duID0gdG9nZ2xlRHJvcGRvd247XHJcbiAgICAgICAgJHNjb3BlLnNob3dEcm9wZG93biA9IHNob3dEcm9wZG93bjtcclxuICAgICAgICAkc2NvcGUuaGlkZURyb3Bkb3duID0gaGlkZURyb3Bkb3duO1xyXG4gICAgICAgICRzY29wZS5pc0Ryb3Bkb3duVmlzaWJsZSA9IGlzRHJvcGRvd25WaXNpYmxlO1xyXG5cclxuICAgICAgICAkc2NvcGUuaGFuZGxlQ2xpY2tPdXRzaWRlID0gZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJDTElDS0VEIE9VVFNJREVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0b2dnbGVEcm9wZG93bigpIHtcclxuICAgICAgICAgICAgdmlzaWJsZSA9ICF2aXNpYmxlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2hvd0Ryb3Bkb3duKCkge1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGhpZGVEcm9wZG93bigpIHtcclxuICAgICAgICAgICAgdmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaXNEcm9wZG93blZpc2libGUoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2aXNpYmxlO1xyXG4gICAgICAgIH1cclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdIaWdoc2NvcmVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBTY29yZVNydiwgTG9nU3J2KSB7XHJcbiAgICAgICAgJHNjb3BlLnNjb3JlTGlzdCA9IFtdO1xyXG5cclxuICAgICAgICBTY29yZVNydi5nZXRIaWdoc2NvcmVMaXN0KClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24obGlzdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjb3JlTGlzdCA9IGNyZWF0ZVJhbmtpbmcobGlzdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBjcmVhdGVSYW5raW5nKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHZhciBpc015c2VsZiA9IGZ1bmN0aW9uKGlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NvcGUudXNlci5faWQgPT09IGlkO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVSYW5raW5nID0gZnVuY3Rpb24obGlzdCkge1xyXG4gICAgICAgICAgICB2YXIgcmFuayA9IDA7XHJcblxyXG4gICAgICAgICAgICB2YXIgcHJldmlvdXNTY29yZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBsaXN0LmZvckVhY2goZnVuY3Rpb24oZW50cnkpIHtcclxuICAgICAgICAgICAgICAgIGlmICghcHJldmlvdXNTY29yZSB8fCBlbnRyeS5zY29yZSAhPT0gcHJldmlvdXNTY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJhbmsrKztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZW50cnkucmFuayA9IHJhbmsgKyAnLic7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcHJldmlvdXNTY29yZSA9IGVudHJ5LnNjb3JlO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5pc015c2VsZiA9IGlzTXlzZWxmO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0hvbWVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBMb2dTcnYsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gY2hlY2sgc3RhdGUgcGFyYW1zXHJcbiAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5hY3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9ICRzdGF0ZVBhcmFtcy5hY3Rpb247XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmVnaXN0ZXIuc3VjY2Vzc2Z1bCc6XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0dyYXR1bGF0aW9uISBEaWUgQW5tZWxkdW5nIHdhciBlcmZvbGdyZWljaC4gSGVyemxpY2ggd2lsbGtvbW1lbiBiZWkgTWFnZWxsYW4uJ1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclNydiwgRm9jdXNTcnYpIHtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG4gICAgICAgICAgICBVc2VyU3J2LmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwbGljYXRpb24gY29udHJvbCBhYm91dCBsb2dpbiBldmVudFxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ2luJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXJyLnN0YXR1cyA9PT0gNDAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0ZhbHNjaGVyIEJlbnV0emVybmFtZSBvZGVyIFBhc3N3b3J0JztcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdCZWltIEVpbmxvZ2dlbiBzY2hlaW50IGV0d2FzIHNjaGllZiBnZWdhbmdlbiB6dSBzZWluJztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBmb2N1cyB1c2VybmFtZSBmaWVsZFxyXG4gICAgICAgIEZvY3VzU3J2KCcjdXNlcm5hbWUnKTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdMb2dvdXRDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2KSB7XHJcbiAgICAgICAgVXNlclNydi5sb2dvdXQoKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIGluZm9ybSBhcHBsaWNhdGlvbiBjb250cm9sIGFib3V0IGxvZ291dCBldmVudFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdhcHAubG9nb3V0Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfSk7IiwiXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdRdWl6RGlyZWN0aXZlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgUXVpelNydiwgTG9nU3J2LCBGb2N1c1NydiwgbmdQcm9ncmVzc0ZhY3RvcnksICRmaWx0ZXIpIHtcclxuICAgICAgICB2YXIgcXVlc3Rpb247XHJcblxyXG4gICAgICAgIHZhciBpbml0Q3RybCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBQcm9ncmVzcyBiYXIgaW5pdGlhbGl6YXRpb25cclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyID0gbmdQcm9ncmVzc0ZhY3RvcnkuY3JlYXRlSW5zdGFuY2UoKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldFBhcmVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpei1wcm9ncmVzcycpKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldEFic29sdXRlKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXRDb2xvcihcIiMzMzZlN2JcIik7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLmFjaGlldmVtZW50cyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dCA9IHt9O1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgb3B0aW9ucyBmb3IgbXVsdGlwbGllciBzZWxlY3Rpb25cclxuICAgICAgICAgICAgJHNjb3BlLm11bHRpcGxpZXJPcHRpb25zID0gW1xyXG4gICAgICAgICAgICAgICAgeyB2YWx1ZTogMSwgbGFiZWw6ICcnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfSxcclxuICAgICAgICAgICAgICAgIHsgdmFsdWU6IDEwMDAwMDAsIGxhYmVsOiAnTWlvLid9XHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICBxdWVzdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHVwZGF0ZVVpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGdldCBjdXJyZW50IHF1ZXN0aW9uIGZyb20gcXVpeiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gUXVpelNydi5nZXRDdXJyZW50UXVlc3Rpb24oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBwcmV2aW91cyBoaW50c1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIG11bHRpcGxpZXJzIGZvciBxdWVzdGlvbnMgY29udGFpbmluZyBudW1iZXJzXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5oaWdoJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMTAwMDAwMCwgbGFiZWw6ICdNaW8uJ307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5tZWRpdW0nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMSwgbGFiZWw6ICcnIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgcHJvZ3Jlc3MgYmFyXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQcm9ncmVzc0JhcigpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZvY3VzIGFuc3dlciBpbnB1dFxyXG4gICAgICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gcXVpeiBoYXMgZW5kZWQsIHNldCBwcm9ncmVzcyBiYXIgdG8gMFxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldCgwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb247XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEN1cnJlbnRRdWVzdGlvbk51bWJlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmdldE51bWJlck9mUXVpelF1ZXN0aW9ucygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZW5kZXJRdWVzdGlvblRleHQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbmRlcihnZXRRdWVzdGlvbigpLnF1ZXN0aW9uKCksICdxdWVzdGlvbi1oaWdobGlnaHQnKSArICc/JztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25NZWRpYSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXN0aW9uIHx8ICFxdWVzdGlvbi5nZXRJbmZvKCkubWVkaWEpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWVzdGlvbi5nZXRJbmZvKCkubWVkaWE7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNob3dSZXN1bHRzUGFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoaWRlUmVzdWx0c1BhZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzUmVzdWx0c1BhZ2VWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoaW50c0F2YWlsYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmhpbnRzUmVtYWluaW5nKCkgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uLmhpbnRzUmVtYWluaW5nKCkgPiAwO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzdWJtaXRBbnN3ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5hbnN3ZXJJbnB1dC5hbnN3ZXIgJiYgIXF1ZXN0aW9uLmFuc3dlcmVkKCkpIHtcclxuICAgICAgICAgICAgICAgIHZhciBhbnN3ZXIgPSBTdHJpbmcoJHNjb3BlLmFuc3dlcklucHV0LmFuc3dlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgYSBudW1iZXIgaW5wdXQsIHJlcGxhY2UgJywnIHdpdGggJy4nXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlciA9IGFuc3dlci5yZXBsYWNlKCcsJywgJy4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhIG11bHRpcGxpZXIgaXMgYXZhaWxhYmxlLCBjYWxjdWxhdGUgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXIgKj0gJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgTG9nU3J2LmluZm8oJ3N1Ym1pdHRpbmcgYW5zd2VyJywgYW5zd2VyKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5wb2ludHMgPSBxdWVzdGlvbi5hbnN3ZXIoYW5zd2VyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgZm9jdXNcclxuICAgICAgICAgICAgICAgIGlmICghd2FzTGFzdFF1ZXN0aW9uKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bk5leHRRdWVzdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bkNvbnRpbnVlRmluaXNoZWQgICcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHF1ZXN0aW9uQW5zd2VyZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFRdWl6U3J2LmlzUXVpelJ1bm5pbmcoKSB8fCBxdWVzdGlvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uYW5zd2VyZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYubmV4dFF1ZXN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuYW5zd2VySW5wdXQuYW5zd2VyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVVpKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJlcXVlc3RIaW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oaW50ID0gcXVlc3Rpb24uaGludCgpO1xyXG5cclxuICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZW5kZXIgPSBmdW5jdGlvbih0ZXh0LCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRleHRcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiW1wiLCBcIjxzcGFuIGNsYXNzPSdcIiArIGNsYXNzTmFtZSArIFwiJz5cIilcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiXVwiLCBcIjwvc3Bhbj5cIik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhbmRsZUtleVByZXNzID0gZnVuY3Rpb24oa2V5RXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGtleUV2ZW50LndoaWNoID09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJtaXRBbnN3ZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3NQZXJjZW50ID0gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyKCkgLyBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKSAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXQocHJvZ3Jlc3NQZXJjZW50KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgd2FzTGFzdFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKSA+PSBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VFdmVudHMgPSBmdW5jdGlvbihldmVudHMsIHBlcnNvbmFsQmVzdCwgb3ZlcmFsbEJlc3QpIHtcclxuICAgICAgICAgICAgdmFyIGFjaGlldmVtZW50cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNob3dCZXN0cyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ292ZXJhbGxfYmVzdCcpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRHUgaGFzdCBlaW5lbiBuZXVlbiBhYnNvbHV0ZW4gUmVrb3JkIGdlc2NoYWZmdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdvdmVyYWxsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGRlbiBha3R1ZWxsZW4gYWJzb2x1dGVuIFJla29yZCBlaW5nZXN0ZWxsdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdwZXJzb25hbF9iZXN0JykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0JykgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBSZWtvcmQgZ2VzY2hhZmZ0ISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ3BlcnNvbmFsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0X2VxdWFsaXNlZCcpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGdsZWljaCB2aWVsZSBQdW5rdGUgZ2VzY2hhZmZ0IHdpZSBiZWkgZGVpbmVtIHBlcnPDtm5saWNoZW4gUmVrb3JkISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ25ld19kYWlseV9iZXN0JykgPj0gMCAmJiBhY2hpZXZlbWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBUYWdlc3Jla29yZCBnZXNjaGFmZnQhJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS5hY2hpZXZlbWVudHMgPSBhY2hpZXZlbWVudHM7XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvd0Jlc3RzICYmIHBlcnNvbmFsQmVzdCAmJiBwZXJzb25hbEJlc3QuaWQgJiYgcGVyc29uYWxCZXN0LmRhdGUgJiYgcGVyc29uYWxCZXN0LnNjb3JlICYmIG92ZXJhbGxCZXN0ICYmIG92ZXJhbGxCZXN0LmlkICYmIG92ZXJhbGxCZXN0LmRhdGUgJiYgb3ZlcmFsbEJlc3Quc2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiZXN0cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIG92ZXJhbGxCZXN0LnR5cGUgPSAnb3ZlcmFsbCc7XHJcbiAgICAgICAgICAgICAgICBiZXN0cy5wdXNoKG92ZXJhbGxCZXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocGVyc29uYWxCZXN0LmlkICE9PSBvdmVyYWxsQmVzdC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbmFsQmVzdC50eXBlID0gJ3BlcnNvbmFsJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmVzdHMucHVzaChwZXJzb25hbEJlc3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IGJlc3RzO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmJlc3RzID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjb250aW51ZUZpbmlzaGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHNob3dSZXN1bHRzUGFnZSgpO1xyXG5cclxuICAgICAgICAgICAgbmV4dFF1ZXN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBjb25jbHVkZSB0aGUgcXVpeiBhbmQgd3JpdGUgcmVzdWx0IHRvIGRhdGFiYXNlXHJcbiAgICAgICAgICAgIFF1aXpTcnYuY29uY2x1ZGUoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlRXZlbnRzKGRhdGEuZXZlbnRzIHx8IFtdLCBkYXRhLnBlcnNvbmFsQmVzdCwgZGF0YS5vdmVyYWxsQmVzdCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEJlc3RUZXh0ID0gZnVuY3Rpb24oYmVzdCkge1xyXG4gICAgICAgICAgICB2YXIgdGV4dDtcclxuXHJcbiAgICAgICAgICAgIGlmIChiZXN0LnR5cGUgPT09ICdwZXJzb25hbCcpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBlcnNvbmFsIGJlc3RcclxuICAgICAgICAgICAgICAgIHRleHQgPSBcIkRlaW4gcGVyc8O2bmxpY2hlciBSZWtvcmQgbGllZ3QgYmVpIDxzcGFuIGNsYXNzPSdib2xkJz57UE9JTlRTfSBQdW5rdGVuPC9zcGFuPiwgYXVmZ2VzdGVsbHQgYW0ge0RBVEV9LlwiO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gb3ZlcmFsbCBiZXN0XHJcbiAgICAgICAgICAgICAgICB2YXIgZnJvbU15c2VsZiA9IGJlc3QuaWQgPT09ICRzY29wZS51c2VyLl9pZDtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbU15c2VsZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIkR1IGjDpGx0c3QgZGVuIGFic29sdXRlbiBSZWtvcmQgbWl0IDxzcGFuIGNsYXNzPSdib2xkJz57UE9JTlRTfSBQdW5rdGVuPC9zcGFuPiwgYXVmZ2VzdGVsbHQgYW0ge0RBVEV9LlwiO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCI8c3BhbiBjbGFzcz0naGlnaGxpZ2h0Jz57VVNFUk5BTUV9PC9zcGFuPiBow6RsdCBkZW4gYWJzb2x1dGVuIFJla29yZCBtaXQgPHNwYW4gY2xhc3M9J2JvbGQnPntQT0lOVFN9IFB1bmt0ZW48L3NwYW4+LCBhdWZnZXN0ZWxsdCBhbSB7REFURX0uXCI7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0LnJlcGxhY2UoJ3tQT0lOVFN9JywgJGZpbHRlcignbnVtYmVyJykoYmVzdC5zY29yZSkpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgne0RBVEV9JywgZ2V0Rm9ybWF0dGVkRGF0ZShiZXN0LmRhdGUpKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJ3tVU0VSTkFNRX0nLCBiZXN0LnVzZXJuYW1lKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Rm9ybWF0dGVkRGF0ZSA9IGZ1bmN0aW9uKGRhdGUpIHtcclxuICAgICAgICAgICAgZGF0ZSA9IG5ldyBEYXRlKGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHBhZChkYXRlLmdldERhdGUoKSwgJzAwJykgKyAnLicgKyBwYWQoZGF0ZS5nZXRNb250aCgpICsgMSwgJzAwJykgKyAnLicgKyAoZGF0ZS5nZXRZZWFyKCkgKyAxOTAwKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcGFkID0gZnVuY3Rpb24oc3RyLCBwYWRWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nKHBhZFZhbHVlICsgc3RyKS5zbGljZSgtcGFkVmFsdWUubGVuZ3RoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVzdGFydFF1aXogPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcXVpeiA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ3F1aXoucmVzdGFydCcpO1xyXG5cclxuICAgICAgICAgICAgaW5pdEN0cmwoKTtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVVpKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGVudGVyTGlzdGVuZXIgPSBmdW5jdGlvbihrZXlQcmVzcywgZnVuYykge1xyXG4gICAgICAgICAgICBpZiAoa2V5UHJlc3Mud2hpY2ggPT0gMTMpIHtcclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoZnVuYykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ25leHRfcXVlc3Rpb24nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0UXVlc3Rpb24oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbnRpbnVlX2ZpbmlzaGVkJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWVGaW5pc2hlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdxdWl6LnN0YXJ0JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgaGlkZVJlc3VsdHNQYWdlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgLy8gY29udHJvbGxlciBpcyBiZWluZyBkZXN0cm95ZWQgKGkuZS4gdXNlciBsZWF2ZXMgdGhlIHBhZ2UsIHNvIHdlIHRlbGwgdGhlIHF1aXogc2VydmljZSB0byBkaXNwb3NlIG9mIHRoZSBxdWl6IG9iamVjdFxyXG4gICAgICAgICAgICBpZiAoUXVpelNydi5oYXNRdWl6U3RhcnRlZCgpICYmIFF1aXpTcnYuaGFzUXVpekVuZGVkKCkpIHtcclxuICAgICAgICAgICAgICAgIFF1aXpTcnYuZGlzcG9zZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGluaXQgY29udHJvbGxlclxyXG4gICAgICAgIGluaXRDdHJsKCk7XHJcblxyXG4gICAgICAgIC8vIGluaXRpYWxseSB1cGRhdGUgVUlcclxuICAgICAgICB1cGRhdGVVaSgpO1xyXG5cclxuICAgICAgICAkc2NvcGUuZ2V0UXVlc3Rpb24gPSBnZXRRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyO1xyXG4gICAgICAgICRzY29wZS5yZW5kZXJRdWVzdGlvblRleHQgPSByZW5kZXJRdWVzdGlvblRleHQ7XHJcbiAgICAgICAgJHNjb3BlLnN1Ym1pdEFuc3dlciA9IHN1Ym1pdEFuc3dlcjtcclxuICAgICAgICAkc2NvcGUucXVlc3Rpb25BbnN3ZXJlZCA9IHF1ZXN0aW9uQW5zd2VyZWQ7XHJcbiAgICAgICAgJHNjb3BlLm5leHRRdWVzdGlvbiA9IG5leHRRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuaGFuZGxlS2V5UHJlc3MgPSBoYW5kbGVLZXlQcmVzcztcclxuICAgICAgICAkc2NvcGUuZ2V0UXVlc3Rpb25NZWRpYSA9IGdldFF1ZXN0aW9uTWVkaWE7XHJcbiAgICAgICAgJHNjb3BlLnJlcXVlc3RIaW50ID0gcmVxdWVzdEhpbnQ7XHJcbiAgICAgICAgJHNjb3BlLndhc0xhc3RRdWVzdGlvbiA9IHdhc0xhc3RRdWVzdGlvbjtcclxuICAgICAgICAkc2NvcGUuY29udGludWVGaW5pc2hlZCA9IGNvbnRpbnVlRmluaXNoZWQ7XHJcbiAgICAgICAgJHNjb3BlLmdldEJlc3RUZXh0ID0gZ2V0QmVzdFRleHQ7XHJcbiAgICAgICAgJHNjb3BlLnJlc3RhcnRRdWl6ID0gcmVzdGFydFF1aXo7XHJcbiAgICAgICAgJHNjb3BlLmhpbnRzQXZhaWxhYmxlID0gaGludHNBdmFpbGFibGU7XHJcbiAgICAgICAgJHNjb3BlLmVudGVyTGlzdGVuZXIgPSBlbnRlckxpc3RlbmVyO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1F1aXpDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBRdWl6U3J2LCBMb2dTcnYpIHtcclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0UXVpeiA9IGZ1bmN0aW9uKGNiKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYuaW5pdCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2IgJiYgdHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBMb2dTcnYuaW5mbyhcIlF1aXogc3RhcnRlZFwiKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaXNRdWl6UnVubmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5pc1F1aXpSdW5uaW5nKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhc1F1aXpTdGFydGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2Lmhhc1F1aXpTdGFydGVkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhc1F1aXpFbmRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5oYXNRdWl6RW5kZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuZ2V0VG90YWxQb2ludHMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdxdWl6LnJlc3RhcnQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBMb2dTcnYuaW5mbygncXVpeiByZXN0YXJ0Jyk7XHJcblxyXG4gICAgICAgICAgICBRdWl6U3J2LmRpc3Bvc2UoKTtcclxuXHJcbiAgICAgICAgICAgIHN0YXJ0UXVpeihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdxdWl6LnN0YXJ0Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuc3RhcnRRdWl6ID0gc3RhcnRRdWl6O1xyXG4gICAgICAgICRzY29wZS5pc1F1aXpSdW5uaW5nID0gaXNRdWl6UnVubmluZztcclxuICAgICAgICAkc2NvcGUuaGFzUXVpelN0YXJ0ZWQgPSBoYXNRdWl6U3RhcnRlZDtcclxuICAgICAgICAkc2NvcGUuaGFzUXVpekVuZGVkID0gaGFzUXVpekVuZGVkO1xyXG4gICAgICAgICRzY29wZS5nZXRUb3RhbFBvaW50cyA9IGdldFRvdGFsUG9pbnRzO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgTG9nU3J2LCBGb2N1c1NydiwgVXNlclNydiwgJHN0YXRlLCAkd2luZG93KSB7XHJcbiAgICAgICAgLy8gbmV3IHVzZXIgb2JqZWN0XHJcbiAgICAgICAgJHNjb3BlLm5ld1VzZXIgPSB7fTtcclxuXHJcbiAgICAgICAgLy8gbWVzc2FnZSBvYmplY3RcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciByZWdpc3RlciA9IGZ1bmN0aW9uIChpc1ZhbGlkKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNWYWxpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodmFsaWRhdGVCZWZvcmVTdWJtaXQoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gcGVyZm9ybSBhcGkgY2FsbFxyXG4gICAgICAgICAgICAgICAgVXNlclNydi5yZWdpc3Rlcigkc2NvcGUubmV3VXNlcilcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluZm9ybSBhcHAgY29udHJvbGxlciBhYm91dCBsb2dpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdhcHAubG9naW4nLCByZXNwb25zZS5kYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZWRpcmVjdCB0byBob21lIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdyZWdpc3Rlci5zdWNjZXNzZnVsJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdCZWkgZGVyIEFubWVsZHVuZyBzY2hlaW50IGV0d2FzIHNjaGllZiBnZWdhbmdlbiB6dSBzZWluJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlcnIubWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnVXNlcm5hbWUgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RlciBCZW51dHplcm5hbWUgZXhpc3RpZXJ0IGJlcmVpdHMnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnQmVpIGRlciBBbm1lbGR1bmcgc2NoZWludCBldHdhcyBzY2hpZWYgZ2VnYW5nZW4genUgc2Vpbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHZhbGlkYXRlQmVmb3JlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSB0d28gcGFzc3dvcmRzIG1hdGNoXHJcbiAgICAgICAgICAgIHZhciBwYXNzd29yZCA9ICRzY29wZS5uZXdVc2VyLnBhc3N3b3JkO1xyXG4gICAgICAgICAgICB2YXIgcGFzc3dvcmQyID0gJHNjb3BlLm5ld1VzZXIucGFzc3dvcmQyO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUubmV3VXNlci51c2VybmFtZSB8fCAhJHNjb3BlLm5ld1VzZXIuZW1haWwgfHwgIXBhc3N3b3JkIHx8ICFwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbidcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFzc3dvcmQgPT09IFwiXCIgfHwgcGFzc3dvcmQyID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEaWUgUGFzc3fDtnJ0ZXIga8O2bm5lbiBuaWNodCBsZWVyIHNlaW4nXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhc3N3b3JkICE9PSBwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0RpZSBQYXNzd8O2cnRlciBzdGltbWVuIG5pY2h0IMO8YmVyZWluJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuICEkc2NvcGUubWVzc2FnZSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVsZWdhdGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmVnaXN0ZXIodHJ1ZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IHJlZ2lzdGVyO1xyXG5cclxuICAgICAgICAvLyBmb2N1cyB1c2VyIG5hbWUgZmllbGRcclxuICAgICAgICBGb2N1c1NydignI3VzZXJuYW1lJyk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignU2V0dGluZ3NDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBBcHBDb25maWcsIEZvY3VzU3J2LCBMb2dTcnYsIFVzZXJTcnYpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyB1c2VyIGNvbG91cnNcclxuICAgICAgICAgICAgdmFyIGNvbG9ycyA9IEFwcENvbmZpZ1snc2V0dGluZ3MudXNlci5jb2xvcnMnXTtcclxuXHJcbiAgICAgICAgICAgIC8vIHVzZXIgb2JqZWN0XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyT2JqID0ge1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6ICRzY29wZS51c2VyLnVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6ICRzY29wZS51c2VyLmVtYWlsLFxyXG4gICAgICAgICAgICAgICAgY29sb3I6ICRzY29wZS51c2VyLmNvbG9yXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUudXNlckNvbG9ycyA9IGNvbG9ycztcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXRDb2xvciA9IGZ1bmN0aW9uKG5ld0NvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlck9iai5jb2xvciA9IG5ld0NvbG9yO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIHVwZGF0ZVVzZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIFVzZXJTcnYudXBkYXRlQmFzaWMoJHNjb3BlLnVzZXJPYmopLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB1c2VyIG9iamVjdFxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLnVzZXJuYW1lID0gJHNjb3BlLnVzZXJPYmoudXNlcm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIuZW1haWwgPSAkc2NvcGUudXNlck9iai5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlci5jb2xvciA9ICRzY29wZS51c2VyT2JqLmNvbG9yO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdFaW5zdGVsbHVuZ2VuIHd1cmRlbiBlcmZvbGdyZWljaCBnZXNwZWljaGVydCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcignVXBkYXRlIHVzZXInLCBlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZVRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXJyLm1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnVXNlcm5hbWUgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGVyIEJlbnV0emVybmFtZSBpc3QgYmVyZWl0cyB2ZXJnZWJlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdEaWUgRWluc3RlbGx1bmdlbiBrb25udGVuIG5pY2h0IGdlc3BlaWNoZXJ0IHdlcmRlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVXNlcih0cnVlKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5zZXRDb2xvciA9IHNldENvbG9yO1xyXG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlVXNlciA9IHVwZGF0ZVVzZXI7XHJcbiAgICAgICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG5cclxuICAgICAgICAgICAgLy8gZm9jdXMgdXNlcm5hbWUgZmllbGRcclxuICAgICAgICAgICAgRm9jdXNTcnYoJyN1c2VybmFtZScpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICgkc2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBvdGhlcndpc2UsIHdhaXQgZm9yIHVzZXIubG9hZGVkIGV2ZW50XHJcbiAgICAgICAgJHNjb3BlLiRvbigndXNlci5sb2FkZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZGlyZWN0aXZlKCdxdWl6JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdidWlsZC92aWV3cy90ZW1wbGF0ZXMvcXVpei1kaXJlY3RpdmUudGVtcGxhdGUuaHRtbCcsXHJcbiAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUXVpekRpcmVjdGl2ZUNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZpbHRlcigncmVuZGVySHRtbCcsIGZ1bmN0aW9uKCRzY2UpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbCh0ZXh0KTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZpbHRlcigndGV4dE9yTnVtYmVyJywgZnVuY3Rpb24oJGZpbHRlcikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgZnJhY3Rpb25TaXplKSB7XHJcbiAgICAgICAgICAgIGZyYWN0aW9uU2l6ZSA9IGZyYWN0aW9uU2l6ZSAhPT0gdW5kZWZpbmVkID8gMCA6IGZyYWN0aW9uU2l6ZTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpc05hTihpbnB1dCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpbnB1dDtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiAkZmlsdGVyKCdudW1iZXInKShpbnB1dCwgZnJhY3Rpb25TaXplKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdBdXRoSW50ZXJjZXB0b3InLCBmdW5jdGlvbihBdXRoVG9rZW5TcnYpIHtcclxuICAgICAgICB2YXIgYWRkVG9rZW4gPSBmdW5jdGlvbihjb25maWcpIHtcclxuICAgICAgICAgICAgdmFyIHRva2VuID0gQXV0aFRva2VuU3J2LmdldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzID0gY29uZmlnLmhlYWRlcnMgfHwge307XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVyc1snWC1BdXRoJ10gPSB0b2tlbjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXF1ZXN0OiBhZGRUb2tlblxyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnQXV0aFRva2VuU3J2JywgZnVuY3Rpb24oJHdpbmRvdykge1xyXG4gICAgICAgIHZhciBzdG9yZSA9ICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2U7XHJcbiAgICAgICAgdmFyIGtleSA9ICdhdXRoLXRva2VuJztcclxuXHJcbiAgICAgICAgdmFyIGdldFRva2VuID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBzdG9yZS5nZXRJdGVtKGtleSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNldFRva2VuID0gZnVuY3Rpb24odG9rZW4pIHtcclxuICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBzdG9yZS5zZXRJdGVtKGtleSwgdG9rZW4pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgc3RvcmUucmVtb3ZlSXRlbShrZXkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0VG9rZW46IGdldFRva2VuLFxyXG4gICAgICAgICAgICBzZXRUb2tlbjogc2V0VG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0NvdW50cnlTcnYnLCBmdW5jdGlvbigkaHR0cCwgSW5kZXhlZERCU3J2LCBMb2dTcnYpIHtcclxuICAgICAgICAvLyBDb3VudHJpZXMgYXJyYXlcclxuICAgICAgICB2YXIgY291bnRyaWVzID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGNvdW50cmllc0J5QWxwaGEzID0gbnVsbDtcclxuICAgICAgICB2YXIgY291bnRyaWVzQnlMZXR0ZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBJbmRleGVkREJcclxuICAgICAgICB2YXIgZGF0YWJhc2UgPSAnbWFnZWxsYW4nO1xyXG4gICAgICAgIHZhciBzdG9yZSA9ICdjb3VudHJ5U3RvcmUnO1xyXG4gICAgICAgIHZhciBrZXlDb3VudHJpZXMgPSAnY291bnRyaWVzJztcclxuICAgICAgICB2YXIga2V5VmVyc2lvbiA9ICd2ZXJzaW9uJztcclxuXHJcbiAgICAgICAgdmFyIGluZGV4ZWREQkF2YWlsYWJsZSA9IEluZGV4ZWREQlNydi5pbmRleGVkREJBdmFpbGFibGUoKTtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxvYWRDb3VudHJpZXMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbG9hZENvdW50cmllcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBpbmRleGVkREIgaXMgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgIGlmIChpbmRleGVkREJBdmFpbGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgZGF0YWJhc2UgZXhpc3RzXHJcbiAgICAgICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LmNyZWF0ZURhdGFiYXNlKGRhdGFiYXNlLCBzdG9yZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZ2V0RW1wdHlPYmplY3QpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGdldEludGVybmFsVmVyc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZ2V0RXh0ZXJuYWxWZXJzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihkZXRlcm1pbmVMb2FkU3RyYXRlZ3kpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGxvYWREYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllcyA9IG9ialsnY291bnRyaWVzJ107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmluZm8oXCJsb2FkZWQgY291bnRyaWVzIGZyb21cIiwgb2JqWydsb2FkU3RyYXRlZ3knXS50b1VwcGVyQ2FzZSgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRpdGlvbmFsbHkgbWFwIGNvdW50cmllcyBieSB2YXJpb3VzIHByb3BlcnRpZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5QWxwaGEzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlciA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBieSBhbHBoYTMgY29kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5QWxwaGEzW2NbJ2FscGhhM0NvZGUnXV0gPSBjO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBieSBsZXR0ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RMZXR0ZXIgPSBjWyduYW1lJ10uc3Vic3RyKDAsIDEpLnRvVXBwZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZmlyc3RMZXR0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnw4QnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RMZXR0ZXIgPSAnQSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ8OWJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0TGV0dGVyID0gJ08nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICfDnCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdExldHRlciA9ICdVJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudHJpZXNCeUxldHRlcltmaXJzdExldHRlcl0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlcltmaXJzdExldHRlcl0gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyW2ZpcnN0TGV0dGVyXS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEzQ29kZTogYy5hbHBoYTNDb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBjLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY291bnRyaWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKFwiZmFpbGVkIHRvIGxvYWQgY291bnRyaWVzXCIsIGVycik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBub3QsIHdlIGFsd2F5cyB0cnkgdG8gZG93bmxvYWQgaXQgZnJvbSB0aGUgY291bnRyeSBBUEkgZW5kcG9pbnRcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRDb3VudHJpZXNGcm9tQVBJKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGV0ZXJtaW5lTG9hZFN0cmF0ZWd5ID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHJhdGVneTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJuYWxWZXJzaW9uID0gb2JqW1wiaW50ZXJuYWxWZXJzaW9uXCJdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGV4dGVybmFsVmVyc2lvbiA9IG9ialtcImV4dGVybmFsVmVyc2lvblwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJuYWxWZXJzaW9uID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnYXBpJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXh0ZXJuYWxWZXJzaW9uID4gaW50ZXJuYWxWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnYXBpJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnZGInO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG9ialsnbG9hZFN0cmF0ZWd5J10gPSBzdHJhdGVneTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBsb2FkRGF0YSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3kgPSBvYmpbJ2xvYWRTdHJhdGVneSddO1xyXG5cclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoc3RyYXRlZ3kpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdhcGknOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3VudHJpZXNGcm9tQVBJKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvdW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImNvdW50cmllc1wiXSA9IGNvdW50cmllcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgY291bnRyaWVzIGFuZCB2ZXJzaW9uIG51bWJlciBpbiBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5wdXRJdGVtKGRhdGFiYXNlLCBzdG9yZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBrZXlDb3VudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAgY291bnRyaWVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5wdXRJdGVtKGRhdGFiYXNlLCBzdG9yZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBrZXlWZXJzaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb2JqW1wiZXh0ZXJuYWxWZXJzaW9uXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkYic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldENvdW50cmllc0Zyb21EQihvYmopXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihfb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfb2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1Vua25vd24gbG9hZCBzdHJhdGVneScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0RW1wdHlPYmplY3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRJbnRlcm5hbFZlcnNpb24gPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnJldHJpZXZlSXRlbShkYXRhYmFzZSwgc3RvcmUsIGtleVZlcnNpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJpbnRlcm5hbFZlcnNpb25cIl0gPSBpdGVtLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJpbnRlcm5hbFZlcnNpb25cIl0gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0RXh0ZXJuYWxWZXJzaW9uID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRWZXJzaW9uRnJvbUFQSSgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbih2ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqW1wiZXh0ZXJuYWxWZXJzaW9uXCJdID0gdmVyc2lvbjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXNGcm9tREIgPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnJldHJpZXZlSXRlbShkYXRhYmFzZSwgc3RvcmUsIGtleUNvdW50cmllcylcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImNvdW50cmllc1wiXSA9IGl0ZW0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cmllc0Zyb21BUEkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL2NvdW50cmllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRWZXJzaW9uRnJvbUFQSSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvY291bnRyaWVzL3ZlcnNpb24nKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UuZGF0YS52ZXJzaW9uIHx8IDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyeUJ5QWxwaGEzID0gZnVuY3Rpb24oYWxwaGEzKSB7XHJcbiAgICAgICAgICAgIGlmIChjb3VudHJpZXNCeUFscGhhMyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXNCeUFscGhhM1thbHBoYTNdO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyaWVzQnlMZXR0ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGNvdW50cmllc0J5TGV0dGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBhcmVDb3VudHJpZXNMb2FkZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcyAhPT0gbnVsbCAmJiBjb3VudHJpZXMubGVuZ3RoID4gMDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0LFxyXG4gICAgICAgICAgICBnZXRDb3VudHJpZXM6IGdldENvdW50cmllcyxcclxuICAgICAgICAgICAgZ2V0Q291bnRyeUJ5QWxwaGEzOiBnZXRDb3VudHJ5QnlBbHBoYTMsXHJcbiAgICAgICAgICAgIGdldENvdW50cmllc0J5TGV0dGVyOiBnZXRDb3VudHJpZXNCeUxldHRlcixcclxuICAgICAgICAgICAgYXJlQ291bnRyaWVzTG9hZGVkOiBhcmVDb3VudHJpZXNMb2FkZWRcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0ZvY3VzU3J2JywgZnVuY3Rpb24oJHRpbWVvdXQsICR3aW5kb3cpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24oc2VsZWN0b3IpIHtcclxuICAgICAgICAgICAgLy8gdGltZW91dCBtYWtlcyBzdXJlIHRoYXQgaXMgaW52b2tlZCBhZnRlciBhbnkgb3RoZXIgZXZlbnQgaGFzIGJlZW4gdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgICAvLyBlLmcuIGNsaWNrIGV2ZW50cyB0aGF0IG5lZWQgdG8gcnVuIGJlZm9yZSB0aGUgZm9jdXMgb3JcclxuICAgICAgICAgICAgLy8gaW5wdXRzIGVsZW1lbnRzIHRoYXQgYXJlIGluIGEgZGlzYWJsZWQgc3RhdGUgYnV0IGFyZSBlbmFibGVkIHdoZW4gdGhvc2UgZXZlbnRzXHJcbiAgICAgICAgICAgIC8vIGFyZSB0cmlnZ2VyZWQuXHJcbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSAkd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0luZGV4ZWREQlNydicsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcclxuICAgICAgICB2YXIga2V5UGF0aCA9ICduYW1lJztcclxuXHJcbiAgICAgICAgdmFyIGluZGV4ZWREQiA9ICR3aW5kb3cuaW5kZXhlZERCIHx8ICR3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8ICR3aW5kb3cubXNJbmRleGVkREI7XHJcbiAgICAgICAgdmFyIElEQktleVJhbmdlID0gJHdpbmRvdy5JREJLZXlSYW5nZSB8fCAkd2luZG93LndlYmtpdElEQktleVJhbmdlO1xyXG5cclxuICAgICAgICB2YXIgSURCVHJhbnNhY3Rpb24gPSAkd2luZG93LklEQlRyYW5zYWN0aW9uIHx8ICR3aW5kb3cud2Via2l0SURCVHJhbnNhY3Rpb247XHJcblxyXG4gICAgICAgIGlmIChJREJUcmFuc2FjdGlvbikge1xyXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFID0gSURCVHJhbnNhY3Rpb24uUkVBRF9XUklURSB8fCAncmVhZHdyaXRlJztcclxuICAgICAgICAgICAgSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZID0gSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZIHx8ICdyZWFkb25seSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaW5kZXhlZERCQXZhaWxhYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleGVkREIgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNyZWF0ZURhdGFiYXNlID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGUgaXMgYW4gaW5zdGFuY2Ugb2YgSURCVmVyc2lvbkNoYW5nZUV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gaWRiLmNyZWF0ZU9iamVjdFN0b3JlKHN0b3JlTmFtZSwgeyBrZXlQYXRoOiBrZXlQYXRoIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQsIHVwZGF0ZSwgZGVsZXRlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkcm9wRGF0YWJhc2UgPSBmdW5jdGlvbihkYk5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBkcm9wIHN1Y2Nlc3NmdWxcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJvcCBmYWlsZWRcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgYWRkSXRlbSA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfV1JJVEUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0QWRkID0gc3RvcmUuYWRkKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHB1dEl0ZW0gPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSwgaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdEFkZCA9IHN0b3JlLnB1dChpdGVtKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXRyaWV2ZUl0ZW0gPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSwgaXRlbU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfT05MWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2Uub25seShpdGVtTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlLm9wZW5DdXJzb3IocmFuZ2UpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBjdXJzb3IudmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJldHJpZXZlSXRlbXMgPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX09OTFkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlLm9wZW5DdXJzb3IoKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSBlLnRhcmdldC5yZXN1bHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vyc29yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNyZWF0ZURhdGFiYXNlOiBjcmVhdGVEYXRhYmFzZSxcclxuICAgICAgICAgICAgZHJvcERhdGFiYXNlOiBkcm9wRGF0YWJhc2UsXHJcbiAgICAgICAgICAgIGFkZEl0ZW06IGFkZEl0ZW0sXHJcbiAgICAgICAgICAgIHB1dEl0ZW06IHB1dEl0ZW0sXHJcbiAgICAgICAgICAgIHJldHJpZXZlSXRlbTogcmV0cmlldmVJdGVtLFxyXG4gICAgICAgICAgICByZXRyaWV2ZUl0ZW1zOiByZXRyaWV2ZUl0ZW1zLFxyXG4gICAgICAgICAgICBpbmRleGVkREJBdmFpbGFibGU6IGluZGV4ZWREQkF2YWlsYWJsZVxyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnTG9nU3J2JywgZnVuY3Rpb24oQXBwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIGxvZ0luZm8gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKEFwcENvbmZpZ1tcImxvZy5pbmZvXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZy5hcHBseShjb25zb2xlLCBhcmd1bWVudHMpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ0Vycm9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChBcHBDb25maWdbXCJsb2cuZXJyb3JcIl0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluZm86IGxvZ0luZm8sXHJcbiAgICAgICAgICAgIGVycm9yOiBsb2dFcnJvclxyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnUXVpelNydicsIGZ1bmN0aW9uKEFwcENvbmZpZywgQ291bnRyeVNydiwgU2NvcmVTcnYsIExvZ1Nydikge1xyXG4gICAgICAgIHZhciBjb3VudHJpZXMgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUFscGhhMyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBxdWl6ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIHNldENvdW50cmllcyA9IGZ1bmN0aW9uKF9jb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgY291bnRyaWVzID0gX2NvdW50cmllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY291bnRyaWVzTG9hZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXMgIT09IG51bGwgJiYgY291bnRyaWVzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb3VudHJpZXNMb2FkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJDb3VudHJpZXMgaGF2ZSBub3QgYmVlbiBsb2FkZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcXVpeiA9IGNyZWF0ZVF1aXooJ2NvdW50cnknKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHF1aXouc3RhcnQoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkaXNwb3NlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHF1aXogPSBudWxsO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBpc1F1aXpSdW5uaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWl6ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouaGFzU3RhcnRlZCgpICYmICFxdWl6Lmhhc0VuZGVkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhc1F1aXpTdGFydGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWl6ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouaGFzU3RhcnRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6RW5kZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHF1aXogPT09IG51bGwpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5oYXNFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVRdWl6ID0gZnVuY3Rpb24ocXVpelR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoIChxdWl6VHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnY291bnRyeSc6XHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjcmVhdGVDb3VudHJ5UXVpeigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNyZWF0ZUNvdW50cnlRdWl6ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3VudHJ5UXVpeiA9IG5ldyBRdWl6KCk7XHJcblxyXG4gICAgICAgICAgICB2YXIgZnVsbFBvaW50cyA9IDEwMDtcclxuICAgICAgICAgICAgdmFyIGhpbnRNYXhpbXVtID0gMztcclxuICAgICAgICAgICAgdmFyIGhpbnRDb3N0ID0gMjU7XHJcblxyXG4gICAgICAgICAgICB2YXIgbGFzdFF1ZXN0aW9uQm9udXMgPSAyLjU7XHJcblxyXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlcyA9IEFwcENvbmZpZ1sncXVpei5jb3VudHJ5LnR5cGVzJ107XHJcbiAgICAgICAgICAgIHZhciBxdWVzdGlvblR5cGVzTGVuZ3RoID0gT2JqZWN0LmtleXMocXVlc3Rpb25UeXBlcykubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgLy8gc2VsZWN0IGNvdW50cmllcyBmb3IgcXVlc3Rpb25zXHJcbiAgICAgICAgICAgIHZhciBzZWxlY3RlZENvdW50cmllcyA9IFtdO1xyXG4gICAgICAgICAgICB2YXIgbnVtYmVyT2ZRdWVzdGlvbnMgPSBBcHBDb25maWdbJ3F1aXouY291bnRyeS5xdWVzdGlvbnMnXTtcclxuXHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtYmVyT2ZRdWVzdGlvbnM7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdmFyIGNvdW50cnlPayA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIHdoaWxlICghY291bnRyeU9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50cnkgPSBjb3VudHJpZXNbZ2V0UmFuZG9tSW50KDAsIGNvdW50cmllcy5sZW5ndGggLSAxKV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50cnlPayA9IHNlbGVjdGVkQ291bnRyaWVzLmluZGV4T2YoY291bnRyeVsnYWxwaGEzQ29kZSddKSA8IDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyaWVzLnB1c2goY291bnRyeVsnYWxwaGEzQ29kZSddKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHF1ZXN0aW9ucyBmb3IgcXVpelxyXG4gICAgICAgICAgICB2YXIgcWNudCA9IDA7XHJcbiAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyaWVzLmZvckVhY2goZnVuY3Rpb24oYWxwaGEzKSB7XHJcbiAgICAgICAgICAgICAgICBxY250Kys7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGNvdW50cnkgPSBDb3VudHJ5U3J2LmdldENvdW50cnlCeUFscGhhMyhhbHBoYTMpO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBxdWVzdGlvblR5cGUgPSBxdWVzdGlvblR5cGVzW2dldFJhbmRvbUludCgxLCBxdWVzdGlvblR5cGVzTGVuZ3RoKV07XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHRleHQgPSBnZXRRdWVzdGlvblRleHQocXVlc3Rpb25UeXBlLCBjb3VudHJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciBpbmZvID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHF1ZXN0aW9uVHlwZSxcclxuICAgICAgICAgICAgICAgICAgICBpbnB1dDogZ2V0UXVlc3Rpb25JbnB1dChxdWVzdGlvblR5cGUpLFxyXG4gICAgICAgICAgICAgICAgICAgIHVuaXQ6IGdldFF1ZXN0aW9uVW5pdChxdWVzdGlvblR5cGUpXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgdmFyIGFuc3dlciA9IGdldFF1ZXN0aW9uQW5zd2VyKHF1ZXN0aW9uVHlwZSwgY291bnRyeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgY2hlY2tBbnN3ZXIgPSBnZXRDaGVja0Fuc3dlckxhbWJkYShxdWVzdGlvblR5cGUsIGZ1bGxQb2ludHMsIGxhc3RRdWVzdGlvbkJvbnVzKTtcclxuICAgICAgICAgICAgICAgIHZhciBoaW50cyA9IGdldFF1ZXN0aW9uSGludHMocXVlc3Rpb25UeXBlLCBoaW50TWF4aW11bSwgaGludENvc3QpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHRoZSBsYXN0IHF1ZXN0aW9uIGlzIHRoZSBib251cyBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgaWYgKHFjbnQgPj0gbnVtYmVyT2ZRdWVzdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpbmZvWydib251cyddID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgaW5mbyBmb3IgZmxhZyBvZiBjb3VudHJ5XHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb25UeXBlID09PSAnRkxBR19PRl9DT1VOVFJZJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm8ubWVkaWEgPSAnZmxhZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5hbHBoYTJDb2RlID0gY291bnRyeS5hbHBoYTJDb2RlLnRvTG9jYWxlTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY291bnRyeVF1aXouYWRkUXVlc3Rpb24obmV3IFF1ZXN0aW9uKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0LFxyXG4gICAgICAgICAgICAgICAgICAgIGluZm86IGluZm8sXHJcbiAgICAgICAgICAgICAgICAgICAgYW5zd2VyOiBhbnN3ZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tBbnN3ZXI6IGNoZWNrQW5zd2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpbnRzOiBoaW50c1xyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJ5UXVpejtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25UZXh0ID0gZnVuY3Rpb24odHlwZSwgY291bnRyeSkge1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NBUElUQUxfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2llIGhlacOfdCBkaWUgSGF1cHRzdGFkdCB2b24gW1wiICsgY291bnRyeS5uYW1lICsgXCJdXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ09VTlRSWV9PRl9DQVBJVEFMJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJbXCIgKyBjb3VudHJ5LmNhcGl0YWwgKyBcIl0gaXN0IGRpZSBIYXVwdHN0YWR0IHZvbiB3ZWxjaGVtIExhbmRcIlxyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2llIHZpZWxlIE1lbnNjaGVuIGxlYmVuIGluIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2llIGdyb8OfIGlzdCBkaWUgRmzDpGNoZSB2b24gW1wiICsgY291bnRyeS5uYW1lICsgXCJdXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnRkxBR19PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJXZWxjaGVzIExhbmQgaGF0IGRpZXNlIEZsYWdnZVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiP1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25BbnN3ZXIgPSBmdW5jdGlvbih0eXBlLCBjb3VudHJ5KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWx0U3BlbGxpbmdzID0gY291bnRyeS5hbHRTcGVsbGluZ3MgIT09IHVuZGVmaW5lZCAmJiBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddICE9PSB1bmRlZmluZWQgPyBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddIDogW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnJlY3Q6IGNvdW50cnkuY2FwaXRhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0U3BlbGxpbmdzOiBhbHRTcGVsbGluZ3NcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbHRTcGVsbGluZ3MgPSBjb3VudHJ5LmFsdFNwZWxsaW5ncyAhPT0gdW5kZWZpbmVkICYmIGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gIT09IHVuZGVmaW5lZCA/IGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gOiBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHRTcGVsbGluZ3M6IGFsdFNwZWxsaW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LnBvcHVsYXRpb25cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5hcmVhXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIj9cIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uSW5wdXQgPSBmdW5jdGlvbih0eXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ251bWJlci5oaWdoJztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnbnVtYmVyLm1lZGl1bSc7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RleHQuc3RhbmRhcmQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVW5pdCA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAna23Csic7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0VpbndvaG5lcic7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDaGVja0Fuc3dlckxhbWJkYSA9IGZ1bmN0aW9uKHR5cGUsIGZ1bGxQb2ludHMsIGxhc3RRdWVzdGlvbkJvbnVzKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihhbnN3ZXIsIHN1Ym1pdHRlZEFuc3dlciwgaGludHNVc2VkLCBoaW50Q29zdCwgaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29ycmVjdCA9IHN1Ym1pdHRlZEFuc3dlciA9PT0gYW5zd2VyLmNvcnJlY3QgfHwgKGFuc3dlci5hbHRTcGVsbGluZ3MgJiYgYW5zd2VyLmFsdFNwZWxsaW5ncy5pbmRleE9mKHN1Ym1pdHRlZEFuc3dlcikgPj0gMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnRzID0gY29ycmVjdCA/IGZ1bGxQb2ludHMgOiAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgaGludHMgYXJlIGFsbG93ZWQgYW5kIGhhdmUgYmVlbiB1c2VkLCBzdWJ0cmFjdCB0aGUgcG9pbnRzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChoaW50c1VzZWQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgLT0gKGhpbnRzVXNlZCAqIGhpbnRDb3N0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYm9udXMgcG9pbnRzIGZvciBsYXN0IHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvICE9PSB1bmRlZmluZWQgJiYgaW5mby5ib251cyAhPT0gdW5kZWZpbmVkICYmIGluZm8uYm9udXMgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyAqPSBsYXN0UXVlc3Rpb25Cb251cztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBvaW50cztcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbihhbnN3ZXIsIHN1Ym1pdHRlZEFuc3dlciwgaGludHNVc2VkLCBoaW50Q29zdCwgaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgcGVyY2VudGFnZSBkaWZmZXJlbmNlIGZyb20gY29ycmVjdCBhbnN3ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVycm9yUGVyY2VudGFnZSA9IE1hdGguYWJzKHN1Ym1pdHRlZEFuc3dlciAtIGFuc3dlci5jb3JyZWN0KSAvIGFuc3dlci5jb3JyZWN0ICogMTAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50cztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSA2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA5MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gOSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gODA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDEyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA3MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMTQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDYwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxNikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDE4KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA0MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMjApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDMwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAyNSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMjA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDMwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAxMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGhpbnRzIGFyZSBhbGxvd2VkIGFuZCBoYXZlIGJlZW4gdXNlZCwgc3VidHJhY3QgdGhlIHBvaW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGludHNVc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzIC09IChoaW50c1VzZWQgKiBoaW50Q29zdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJvbnVzIHBvaW50cyBmb3IgbGFzdCBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mbyAhPT0gdW5kZWZpbmVkICYmIGluZm8uYm9udXMgIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgKj0gbGFzdFF1ZXN0aW9uQm9udXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIj9cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvbkhpbnRzID0gZnVuY3Rpb24odHlwZSwgaGludHNQb3NzaWJsZSwgaGludENvc3QpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDQVBJVEFMX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ09VTlRSWV9PRl9DQVBJVEFMJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0ZMQUdfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4aW11bTogaGludHNQb3NzaWJsZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29zdDogaGludENvc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpdmU6IGZ1bmN0aW9uKGhpbnRzVXNlZCwgYW5zd2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYW5zd2VyLmNvcnJlY3Quc3Vic3RyKDAsIGhpbnRzVXNlZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ1BPUFVMQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIj9cIjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmdldEN1cnJlbnRRdWVzdGlvbk51bWJlcigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmdldE51bWJlck9mUXVlc3Rpb25zKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEN1cnJlbnRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzUXVpelJ1bm5pbmcoKSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouY3VycmVudFF1ZXN0aW9uKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIG5leHRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzUXVpelJ1bm5pbmcoKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBxdWl6Lm5leHRRdWVzdGlvbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRUb3RhbFBvaW50cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmdldFRvdGFsUG9pbnRzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb25jbHVkZXMgdGhlIHF1aXogYW5kIHB1dHMgdGhlIHNjb3JlIHRvIHRoZSBBUEkgZW5kcG9pbnQuXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGNvbmNsdWRlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIGlmIChxdWl6ICE9PSBudWxsICYmIHF1aXouaGFzRW5kZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChxdWl6LnN1Ym1pdHRlZCA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1F1aXogaGFzIGFscmVhZHkgYmVlbiBzdWJtaXR0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHF1aXouc3VibWl0dGVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgU2NvcmVTcnYucHV0SGlnaHNjb3JlKHF1aXouZ2V0VG90YWxQb2ludHMoKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoJ05vIHF1aXogaXMgY3VycmVudGx5IHJ1bm5pbmcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdCxcclxuICAgICAgICAgICAgc2V0Q291bnRyaWVzOiBzZXRDb3VudHJpZXMsXHJcbiAgICAgICAgICAgIGlzUXVpelJ1bm5pbmc6IGlzUXVpelJ1bm5pbmcsXHJcbiAgICAgICAgICAgIGhhc1F1aXpTdGFydGVkOiBoYXNRdWl6U3RhcnRlZCxcclxuICAgICAgICAgICAgaGFzUXVpekVuZGVkOiBoYXNRdWl6RW5kZWQsXHJcbiAgICAgICAgICAgIGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcjogZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyLFxyXG4gICAgICAgICAgICBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnM6IGdldE51bWJlck9mUXVpelF1ZXN0aW9ucyxcclxuICAgICAgICAgICAgZ2V0Q3VycmVudFF1ZXN0aW9uOiBnZXRDdXJyZW50UXVlc3Rpb24sXHJcbiAgICAgICAgICAgIG5leHRRdWVzdGlvbjogbmV4dFF1ZXN0aW9uLFxyXG4gICAgICAgICAgICBnZXRUb3RhbFBvaW50czogZ2V0VG90YWxQb2ludHMsXHJcbiAgICAgICAgICAgIGNvbmNsdWRlOiBjb25jbHVkZSxcclxuICAgICAgICAgICAgZGlzcG9zZTogZGlzcG9zZVxyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnU2NvcmVTcnYnLCBmdW5jdGlvbigkaHR0cCkge1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEZldGNoZXMgdGhlIGVudGlyZSBoaWdoc2NvcmUgbGlzdCBpbiBhbiBhcnJheSBmcm9tIHRoZSBBUEkuXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGdldEhpZ2hzY29yZUxpc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3Njb3Jlcy9hbGwnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGxpc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShsaXN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEZldGNoZXMgdGhlIGhpZ2hzY29yZSBvYmplY3QgZm9yIHRoZSBsb2dnZWQgaW4gdXNlci5cclxuICAgICAgICAgKiBJZiB0aGUgdXNlciBoYXMgbm8gcmVzdWx0IHlldCwgYW4gZW1wdHkgb2JqZWN0IGlzIHJldHVybmVkLlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBnZXRVc2VySGlnaHNjb3JlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9zY29yZXMvdXNlcicpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oc2NvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShzY29yZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBoaWdoc2NvcmUgb2JqZWN0IGZvciB0aGUgb3ZlcmFsbCBoaWdoc2NvcmUuXHJcbiAgICAgICAgICogSWYgdGhlcmUgaXMgY3VycmVudGx5IG5vIHJlc3VsdCB5ZXQsIGFuIGVtcHR5IG9iamVjdCBpcyByZXR1cm5lZC5cclxuICAgICAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgZ2V0T3ZlcmFsbEhpZ2hzY29yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvc2NvcmVzL2hpZ2gnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogUHV0cyBhIGhpZ2hzY29yZSByZXN1bHQgZm9yIHRoZSBsb2dnZWQgaW4gdXNlci5cclxuICAgICAgICAgKiBAcGFyYW0gc2NvcmUgICAgIE51bWJlciB3aXRoIHRoZSBhY2hpZXZlZCBzY29yZS5cclxuICAgICAgICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgcHV0SGlnaHNjb3JlID0gZnVuY3Rpb24oc2NvcmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvYXBpL3Njb3JlcycsIHsgc2NvcmU6IHNjb3JlIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0SGlnaHNjb3JlTGlzdDogZ2V0SGlnaHNjb3JlTGlzdCxcclxuICAgICAgICAgICAgZ2V0VXNlckhpZ2hzY29yZTogZ2V0VXNlckhpZ2hzY29yZSxcclxuICAgICAgICAgICAgZ2V0T3ZlcmFsbEhpZ2hzY29yZTogZ2V0T3ZlcmFsbEhpZ2hzY29yZSxcclxuICAgICAgICAgICAgcHV0SGlnaHNjb3JlOiBwdXRIaWdoc2NvcmVcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1VzZXJTcnYnLCBmdW5jdGlvbigkaHR0cCwgQXV0aFRva2VuU3J2LCBBcHBDb25maWcpIHtcclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgICAgIHZhciBnZXRVc2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcicpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRVc2VyRnJvbVN0b3JhZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHRva2VuID0gQXV0aFRva2VuU3J2LmdldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgQXV0aFRva2VuU3J2LnNldFRva2VuKHRva2VuKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0VXNlcigpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZXJlIGlzIG5vIHRva2VuLCB3ZSByZWplY3QgdGhlIHByb21pc2VcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJObyB0b2tlbiBpbiBzdG9yYWdlXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbicsIHtcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSxcclxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRva2VuID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzYXZlIHRva2VuIGxvY2FsbHlcclxuICAgICAgICAgICAgICAgIEF1dGhUb2tlblNydi5zZXRUb2tlbihzZWxmLnRva2VuKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0VXNlcigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbG9nb3V0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHNlbGYudG9rZW4gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSB0b2tlbiBsb2NhbGx5XHJcbiAgICAgICAgICAgICAgICBBdXRoVG9rZW5TcnYuc2V0VG9rZW4oKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZWdpc3RlciA9IGZ1bmN0aW9uKG5ld1VzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgLy8gc2VsZWN0IGEgcmFuZG9tIGNvbG9yIGZvciB0aGUgdXNlclxyXG4gICAgICAgICAgICAgICAgdmFyIGNvbG9ycyA9IEFwcENvbmZpZ1snc2V0dGluZ3MudXNlci5jb2xvcnMnXTtcclxuICAgICAgICAgICAgICAgIG5ld1VzZXIuY29sb3IgPSBjb2xvcnNbZ2V0UmFuZG9tSW50KDAsIGNvbG9ycy5sZW5ndGggLSAxKV07XHJcblxyXG4gICAgICAgICAgICAgICAgJGh0dHAucG9zdCgnL2FwaS91c2VyJywgbmV3VXNlcilcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGltbWVkaWF0ZWx5IGxvZyB0aGUgdXNlciBpblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2dpbihuZXdVc2VyLnVzZXJuYW1lLCBuZXdVc2VyLnBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KSAgO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVCYXNpYyA9IGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvYXBpL3VzZXIvYmFzaWMnLCB1c2VyKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0VXNlcjogZ2V0VXNlcixcclxuICAgICAgICAgICAgZ2V0VXNlckZyb21TdG9yYWdlOiBnZXRVc2VyRnJvbVN0b3JhZ2UsXHJcbiAgICAgICAgICAgIGxvZ2luOiBsb2dpbixcclxuICAgICAgICAgICAgbG9nb3V0OiBsb2dvdXQsXHJcbiAgICAgICAgICAgIHJlZ2lzdGVyOiByZWdpc3RlcixcclxuICAgICAgICAgICAgdXBkYXRlQmFzaWM6IHVwZGF0ZUJhc2ljXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
