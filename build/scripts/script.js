var magellan=angular.module("magellan",["ui.router","ngProgress","ngAnimate"],["$httpProvider",function(e){e.interceptors.push("AuthInterceptor")}]);magellan.constant("AppConfig",{"log.info":!0,"log.error":!0,"quiz.country.questions":3,"quiz.country.types":{1:"CAPITAL_OF_COUNTRY",2:"COUNTRY_OF_CAPITAL",3:"POPULATION_OF_COUNTRY",4:"AREA_OF_COUNTRY",5:"FLAG_OF_COUNTRY",6:"LOCATION_OF_COUNTRY"},"settings.user.colors":["soft_red","thunderbird","old_brick","new_york_pink","snuff","honey_flower","san_marino","shakespeare","ming","gossip","eucalyptus","mountain_meadow","jade","confetti","california","burnt_orange","jaffa","gallery","edward","lynch"]}),magellan.controller("AppCtrl",["$rootScope","$scope","$state","AuthSrv","UserSrv","CountrySrv","QuizSrv",function(e,n,t,r,o,i,s){n.app={config:{title:"Magellan",subtitle:"Teste dein Wissen über die Länder unserer Erde",author:"Michael Stifter"}},r.getUser().then(function(e){n.user=e,n.$broadcast("user.loaded"),i.init().then(function(e){n.$broadcast("countries.loaded",e),s.setCountries(e)})})["catch"](function(e){n.user=null}),n.isProgressBarVisible=function(){return t.is("quiz")};var u=function(){t.go("home")};n.goToHome=u,e.$on("$stateChangeError",function(e,n,r,o,i,s){"Not authorized"===s&&t.go("home")}),n.$on("app.login",function(e,o){n.user=o,r.setUser(o),i.init().then(function(e){n.$broadcast("countries.loaded",e),s.setCountries(e)}),t.go("home")}),n.$on("app.logout",function(e,o){n.user=null,r.clearUser(),t.go("home")})}]);var createMap=function(){new Datamap({element:document.getElementById("map-container"),geographyConfig:{highlightOnHover:!0,popupOnHover:!1}})},Quiz=function(){var e=null,n=[];this.start=function(){if(n.length<=0)throw Error("Cannot start a quiz without questions");return this.nextQuestion()},this.isActive=function(){return this.hasStarted()&&!this.hasEnded()},this.hasStarted=function(){return null!==e},this.hasEnded=function(){return this.hasStarted()&&e>=n.length},this.submitted=!1,this.addQuestion=function(e){if(void 0===e)throw Error("No question object passed");var t=!0,r=["config","hint","solution","answer","question","getInfo","info","points","answered","hintsAllowed","hintsRemaining"];r.forEach(function(n){if(!e.hasOwnProperty(n))throw t=!1,new Error("Question must have property '"+n+"'")}),t&&n.push(e)},this.nextQuestion=function(){return null===e?e=0:e++,this.hasEnded()?!1:n[e]},this.currentQuestion=function(){return this.isActive()?n[e]:null},this.getTotalPoints=function(){if(!this.hasStarted())return null;var e=0;return n.forEach(function(n){var t=n.points();void 0!==t&&(e+=t)}),e},this.getCurrentQuestionNumber=function(){return null===e?null:e+1},this.getNumberOfQuestions=function(){return n.length}},Question=function(e){var n=null,t=null,r=null,o=null,i=0,s=null,u=null,a=!1,l=function(e){n=e.text,t=e.info||{},r=e.answer,s=e.checkAnswer||null,o=e.hints||{allowed:!1,maximum:0,cost:0,give:null}};e&&l(e),this.config=function(e){l(e)},this.question=function(){return n},this.info=function(e,n){return void 0===n?t[e]:void(t[e]=n)},this.getInfo=function(){return t},this.solution=function(){return a?r:null},this.hint=function(){if(!o.allowed)return null;if(o.allowed&&!o.give)throw new Error("Hints allowed but no give method passed");return i<o.maximum&&i++,o.give(i,r)},this.answer=function(e){return!a&&s?(a=!0,u=s(r,e,i,o.cost,t),u=Math.max(0,u),u=Math.floor(u)):void 0},this.points=function(){return a&&null!==u?u:void 0},this.answered=function(){return a},this.hintsAllowed=function(){return null!==o?o.allowed:null},this.hintsRemaining=function(){var e=this.hintsAllowed();return null===e||e===!1?null:o.maximum-i}},getRandomInt=function(e,n){return Math.floor(Math.random()*(n-e+1))+e},getStringBetween=function(e,n,t){var r=e.indexOf(n),o=e.indexOf(t);return r>=0&&o>=0&&o>r?e.substr(r+1,o-r-1):null},PasswordRequirementsValidator=function(){var e=this,n={minLength:8,maxLength:void 0,lowercaseChars:1,uppercaseChars:1,specialChars:1,numericChars:1},t=null;this.input=null,this.check=function(e){if("undefined"==typeof e)throw new Error("Missing mandatory input parameter");if("string"!=typeof e)throw new Error('First input parameter must be of type "string"');this.input=e;var n=[],t=r();return t.forEach(function(e){var t=i(e);t!==!0&&n.push(e)}),{passwordOk:0===n.length,failedChecks:n}},this.setConfig=function(e){t=e},this.getConfig=function(){return t||n};var r=function(){return Object.keys(e.getConfig())},o=function(n){return e.getConfig()[n]},i=function(n){if("string"!=typeof e.input)return!1;var t=o(n);if(!t)return!0;switch(n){case"minLength":return e.input.length>=t;case"maxLength":return e.input.length<=t;case"lowercaseChars":var r=e.input.length-e.input.replace(/[a-z]/g,"").length;return r>=t;case"uppercaseChars":var i=e.input.length-e.input.replace(/[A-Z]/g,"").length;return i>=t;case"specialChars":var s=e.input.length-e.input.replace(/[!@§$%&#^*_:;.,+"'`´\{\}\(\)\[\]\/\\-]/g,"").length;return s>=t;case"numericChars":var u=e.input.length-e.input.replace(/[0-9]/g,"").length;return u>=t;default:return}}};PasswordRequirementsValidator.CONFIG_PROPERTIES=["minLength","maxLength","lowercaseChars","uppercaseChars","specialChars","numericChars"],"undefined"!=typeof module&&module.exports&&(module.exports.Question=Question,module.exports.Quiz=Quiz,module.exports.PasswordRequirementsValidator=PasswordRequirementsValidator),angular.module("magellan").config(["$locationProvider","$stateProvider","$urlRouterProvider",function(e,n,t){e.html5Mode(!0),t.otherwise("/home");var r=function(e,n,t){return e.getUser().then(function(e){return e})["catch"](function(e){return t.reject("Not authorized")})};r.$inject=["AuthSrv","LogSrv","$q"],n.state("home",{url:"/home",templateUrl:"/build/views/partials/home.partial.html"}).state("quiz",{url:"/quiz",templateUrl:"/build/views/partials/quiz.partial.html",resolve:{auth:r}}).state("countries",{url:"/countries",templateUrl:"/build/views/partials/countries.partial.html",resolve:{auth:r}}).state("countries.detail",{url:"/:alpha3Code",templateUrl:"/build/views/partials/countries-detail.partial.html",resolve:{auth:r}}).state("login",{url:"/login",templateUrl:"/build/views/partials/login.partial.html"}).state("logout",{url:"/logout",controller:"LogoutCtrl"}).state("register",{url:"/register",templateUrl:"/build/views/partials/register.partial.html"}).state("settings",{url:"/settings",templateUrl:"/build/views/partials/settings.partial.html",resolve:{auth:r}}).state("password",{url:"/password",templateUrl:"/build/views/partials/password-change.partial.html",resolve:{auth:r}}).state("reset",{url:"/password/reset/:token",templateUrl:"/build/views/partials/password-reset.partial.html"}).state("forgot",{url:"/password/forgot",templateUrl:"/build/views/partials/password-forgot.partial.html"}).state("about",{url:"/about",templateUrl:"/build/views/partials/about.partial.html"}).state("highscore",{url:"/highscore",templateUrl:"/build/views/partials/highscore.partial.html",resolve:{auth:r}}).state("faq",{url:"/faq",templateUrl:"/build/views/partials/faq.partial.html",params:{action:null}}).state("countries-difficulty",{url:"/countries-difficulty",templateUrl:"/build/views/partials/country-difficulty.partial.html",resolve:{auth:r}})}]),angular.module("magellan").controller("CountriesCtrl",["$scope","CountrySrv",function(e,n){var t=null,r=null,o=function(){t=n.getCountriesByLetter(),r=Object.keys(t).sort(),e.$$phase?(e.countryKeys=r,e.countriesByLetter=t):e.$apply(function(){e.countryKeys=r,e.countriesByLetter=t})};n.areCountriesLoaded()&&o(),e.$on("countries.loaded",function(){o()})}]),angular.module("magellan").controller("CountryDetailCtrl",["$scope","CountrySrv","$stateParams",function(e,n,t){var r=t.alpha3Code;n.areCountriesLoaded()&&(e.country=n.getCountryByAlpha3(r)),e.$on("countries.loaded",function(){e.$apply(function(){e.country=n.getCountryByAlpha3(r)})});var o=function(e){return n.getCountryByAlpha3(e)};e.getCountryFromService=o}]),angular.module("magellan").controller("CountryDifficultyCtrl",["$scope","CountrySrv",function(e,n){var t=function(){var t=n.getCountries(),r={easy:[],medium:[],hard:[],unassigned:[]};t.sort(function(e,n){return n.population-e.population}).forEach(function(e){r[e.difficulty].push(e)}),e.$$phase?(e.difficulties=r,e.difficultyKeys=Object.keys(r)):e.$apply(function(){e.difficulties=r,e.difficultyKeys=Object.keys(r)})};n.areCountriesLoaded()&&t(),e.$on("countries.loaded",function(e,n){t()})}]),angular.module("magellan").controller("DropdownCtrl",["$scope",function(e){function n(){i=!i}function t(){i=!0}function r(){i=!1}function o(){return i}var i=!1;e.toggleDropdown=n,e.showDropdown=t,e.hideDropdown=r,e.isDropdownVisible=o,e.$on("click.outside",function(n,t){o()&&(e.$$phase?r():e.$apply(function(){r()}))})}]),angular.module("magellan").controller("FaqCtrl",["$scope","LogSrv","$stateParams",function(e,n,t){if(e.message=null,t.action){var r=t.action;switch(r){case"register.successful":e.message={type:"success",text:"Gratulation! Die Anmeldung war erfolgreich. Herzlich willkommen bei Magellan."};break;default:e.message=null}}}]),angular.module("magellan").controller("ForgotCtrl",["$scope","UserSrv","LogSrv","FocusSrv",function(e,n,t,r){e.passObj={},e.message={};var o=function(){return e.passObj.email?void n.forgotPassword({email:e.passObj.email}).then(function(e){var n=e.valid,t=void 0!==n?" Der Link ist "+n+" Stunden lang gültig.":"";s("success","Das E-Mail wurde erfolgreich versandt."+t)})["catch"](function(e){"No user with this e-mail address found"===e.message?s("error","Es wurde kein Benutzer mit dieser E-Mail-Adresse gefunden"):s("error","Beim Versenden des Links ist etwas schiefgegangen")}):void s("error","Alle Felder müssen ausgefüllt sein")},i=function(){o()},s=function(n,t){e.$$phase?e.message={type:n,text:t}:e.$apply(function(){e.message={type:n,text:t}})};r("#email"),e.forgotPassword=o,e.delegateSubmit=i}]),angular.module("magellan").controller("HighscoreCtrl",["$scope","ScoreSrv","LogSrv",function(e,n,t){e.scoreList=[],e.isDataLoading=!0,n.getHighscoreList().then(function(n){e.$$phase?e.scoreList=i(n):e.$apply(function(){e.scoreList=i(n)}),r(!1)})["catch"](function(e){t.error(e),r(!1)});var r=function(n){e.$$phase?e.isDataLoading=n:e.$apply(function(){e.isDataLoading=n})},o=function(n){return e.user._id===n},i=function(e){var n=0,t=null;return e.forEach(function(e){t&&e.score===t||(n++,e.rank=n+"."),t=e.score}),e};e.isMyself=o}]),angular.module("magellan").controller("LoginCtrl",["$scope","UserSrv","FocusSrv",function(e,n,t){e.message=null,e.login=function(t,r){n.login(t,r).then(function(n){e.message=null,e.$emit("app.login",n.data)})["catch"](function(n){console.error(n);var t;t=401===n.status?"Falscher Benutzername oder Passwort":"Beim Einloggen scheint etwas schief gegangen zu sein",e.message={type:"error",text:t}})},t("#username")}]),angular.module("magellan").controller("LogoutCtrl",["$scope","UserSrv",function(e,n){n.logout().then(function(){e.$emit("app.logout")})}]),angular.module("magellan").controller("MapCtrl",["$scope",function(e){}]),angular.module("magellan").controller("PasswordCtrl",["$scope","UserSrv","LogSrv","FocusSrv",function(e,n,t,r){e.passObj={},e.message={};var o=function(){return e.passObj.old&&e.passObj["new"]&&e.passObj.confirmation?e.passObj["new"]!==e.passObj.confirmation?void s("error","Die Passwörter stimmen nicht überein"):void n.updatePassword({old:e.passObj.old,password:e.passObj["new"]}).then(function(e){s("success","Das neue Passwort wurde erfolgreich gespeichert")})["catch"](function(e){"Old password incorrect"===e.message?s("error","Das alte Passwort ist nicht korrekt"):s("error","Das neue Passwort konnte nicht gespeichert werden")}):void s("error","Alle Felder müssen ausgefüllt sein")},i=function(){o()},s=function(n,t){e.$$phase?e.message={type:n,text:t}:e.$apply(function(){e.message={type:n,text:t}})};r("#password-current"),e.updatePassword=o,e.delegateSubmit=i}]),angular.module("magellan").controller("QuizDirectiveController",["$scope","QuizSrv","LogSrv","FocusSrv","ngProgressFactory","$filter",function(e,n,t,r,o,i){var s,u=function(){e.progressbar=o.createInstance(),e.progressbar.setParent(document.getElementById("quiz-progress")),e.progressbar.setAbsolute(),e.progressbar.setColor("#336e7b"),e.isResultsPageVisible=!1,e.achievements=[],e.bests=[],e.answerInput={},e.hint=null,e.multiplierOptions=[{value:1,label:""},{value:1e3,label:"Tsd."},{value:1e6,label:"Mio."}],s=null},a=function(){if(s=n.getCurrentQuestion(),e.hint=null,null!==s){if(s.getInfo().input&&0===s.getInfo().input.indexOf("number"))switch(s.getInfo().input){case"number.high":e.answerInput.multiplier={value:1e6,label:"Mio."};break;case"number.medium":e.answerInput.multiplier={value:1e3,label:"Tsd."};break;default:e.answerInput.multiplier={value:1,label:""}}else e.answerInput.multiplier=null;A(),r(".answerInput")}},l=function(){return s},c=function(){return n.getCurrentQuestionNumber()},f=function(){return n.getNumberOfQuizQuestions()},d=function(){return C(l().question(),"question-highlight")+"?"},g=function(){return s&&s.getInfo().media?s.getInfo().media:null},p=function(){e.isResultsPageVisible=!0},h=function(){e.$$phase?e.isResultsPageVisible=!1:e.$apply(function(){e.isResultsPageVisible=!1})},m=function(){return null===s?!1:null===s.hintsRemaining()?!1:s.hintsRemaining()>0},v=function(){if(e.answerInput.answer&&!s.answered()){var n=String(e.answerInput.answer).trim();s.getInfo().input&&0===s.getInfo().input.indexOf("number")&&(n=n.replace(",",".")),e.answerInput.multiplier&&(n*=e.answerInput.multiplier.value),e.answerInput.points=s.answer(n),r(P()?"#btnContinueFinished":"#btnNextQuestion")}},w=function(){return n.isQuizRunning()&&null!==s?s.answered():!1},b=function(){n.nextQuestion(),e.answerInput.answer="",a()},O=function(){e.hint=s.hint(),r(".answerInput")},C=function(e,n){return e.replace("[","<span class='"+n+"'>").replace("]","</span>")},y=function(e){13==e.which&&v()},A=function(){var n=c()/f()*100;e.progressbar.set(n)},P=function(){return c()>=f()},S=function(n,t,r){var o=[],i=!0;if(n.indexOf("overall_best")>=0&&(o.push({text:"Du hast einen neuen absoluten Rekord geschafft!"}),i=!1),n.indexOf("overall_best_equalised")>=0&&(o.push({text:"Du hast den aktuellen absoluten Rekord eingestellt!"}),i=!1),n.indexOf("personal_best")>=0&&n.indexOf("overall_best")<0&&(o.push({text:"Du hast einen neuen persönlichen Rekord geschafft!"}),i=!1),n.indexOf("personal_best_equalised")>=0&&n.indexOf("overall_best_equalised")<0&&(o.push({text:"Du hast gleich viele Punkte geschafft wie bei deinem persönlichen Rekord!"}),i=!1),n.indexOf("new_daily_best")>=0&&0===o.length&&o.push({text:"Du hast einen neuen persönlichen Tagesrekord geschafft!"}),e.$$phase?e.achievements=o:e.$apply(function(){e.achievements=o}),i&&t&&t.id&&t.date&&t.score&&r&&r.id&&r.date&&r.score){var s=[];r.type="overall",s.push(r),t.id!==r.id&&(t.type="personal",s.push(t)),e.$$phase?e.bests=s:e.$apply(function(){e.bests=s})}else e.$$phase?e.bests=null:e.$apply(function(){e.bests=null})},$=function(){e.progressbar.set(0),p(),b(),n.conclude().then(function(e){S(e.events||[],e.personalBest,e.overallBest)})["catch"](function(e){t.error(e)})},_=function(n){var t;if("personal"===n.type)t="Dein persönlicher Rekord liegt bei <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}.";else{var r=n.id===e.user._id;t=r?"Du hältst den absoluten Rekord mit <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}.":"<span class='highlight'>{USERNAME}</span> hält den absoluten Rekord mit <span class='bold'>{POINTS} Punkten</span>, aufgestellt am {DATE}."}return t.replace("{POINTS}",i("number")(n.score)).replace("{DATE}",T(n.date)).replace("{USERNAME}",n.username)},T=function(e){return e=new Date(e),U(e.getDate(),"00")+"."+U(e.getMonth()+1,"00")+"."+(e.getYear()+1900)},U=function(e,n){return String(n+e).slice(-n.length)},R=function(){quiz=null,e.$emit("quiz.restart"),u(),a()},L=function(e,n){if(13==e.which)switch(n){case"next_question":b();break;case"continue_finished":$()}};e.$on("quiz.start",function(e,n){h()}),e.$on("$destroy",function(e,t){n.hasQuizStarted()&&n.hasQuizEnded()&&n.dispose()}),u(),a(),e.getQuestion=l,e.getCurrentQuestionNumber=c,e.renderQuestionText=d,e.submitAnswer=v,e.questionAnswered=w,e.nextQuestion=b,e.handleKeyPress=y,e.getQuestionMedia=g,e.requestHint=O,e.wasLastQuestion=P,e.continueFinished=$,e.getBestText=_,e.restartQuiz=R,e.hintsAvailable=m,e.enterListener=L}]),angular.module("magellan").controller("QuizCtrl",["$scope","QuizSrv","LogSrv",function(e,n,t){var r=function(e){n.init().then(function(){e&&"function"==typeof e&&e()})["catch"](function(e){t.error(e)})},o=function(){return n.isQuizRunning()},i=function(){return n.hasQuizStarted()},s=function(){return n.hasQuizEnded()},u=function(){return n.getTotalPoints()};e.$on("quiz.restart",function(t,o){n.dispose(),r(function(){e.$broadcast("quiz.start")})}),e.startQuiz=r,e.isQuizRunning=o,e.hasQuizStarted=i,e.hasQuizEnded=s,e.getTotalPoints=u}]),angular.module("magellan").controller("RegisterCtrl",["$scope","LogSrv","FocusSrv","UserSrv","$state","$window",function(e,n,t,r,o,i){e.newUser={},e.message=null;var s=function(t){return t?void(u()&&r.register(e.newUser).then(function(n){200===n.status?(e.$emit("app.login",n.data),o.go("faq",{action:"register.successful"})):e.message={type:"error",text:"Bei der Anmeldung scheint etwas schief gegangen zu sein"}})["catch"](function(t){n.error(t);var r;switch(t.message){case"Username already exists":r="Der Benutzername ist bereits in Verwendung";break;case"Email address already exists":r="Die E-Mail-Adresse ist bereits in Verwendung";break;case"Password does not match requirements":r="Das Passwort entspricht nicht den Sicherheitsrichtlinien";break;default:r="Bei der Anmeldung scheint etwas schief gegangen zu sein"}e.$$phase?e.message={type:"error",text:r}:e.$apply(function(){e.message={type:"error",text:r}})})):!1},u=function(){e.message=null;var n=e.newUser.password,t=e.newUser.password2;return e.newUser.username&&e.newUser.email&&n&&t?""===n||""===t?e.message={type:"error",text:"Die Passwörter können nicht leer sein"}:n!==t&&(e.message={type:"error",text:"Die Passwörter stimmen nicht überein"}):e.message={type:"error",text:"Alle Felder müssen ausgefüllt sein"},!e.message},a=function(){s(!0)};e.delegateSubmit=a,e.register=s,t("#username")}]),angular.module("magellan").controller("ResetCtrl",["$scope","UserSrv","LogSrv","FocusSrv","$stateParams",function(e,n,t,r,o){e.passObj={},e.message={};var i=o.token,s=function(){return e.passObj["new"]&&e.passObj.confirmation?e.passObj["new"]!==e.passObj.confirmation?void a("error","Die Passwörter stimmen nicht überein"):i?void n.resetPassword({token:i,password:e.passObj["new"]}).then(function(e){a("success","Das Passwort wurde erfolgreich gespeichert")})["catch"](function(e){"Invalid token"===e.message?a("error","Der Zurücksetzen-Link ist leider nicht mehr gültig"):a("error","Das neue Passwort konnte nicht gespeichert werden")}):void a("error","Kein gültiger Zurücksetzen-Link"):void a("error","Alle Felder müssen ausgefüllt sein")},u=function(){s()},a=function(n,t){e.$$phase?e.message={type:n,text:t}:e.$apply(function(){e.message={type:n,text:t}})};r("#password-new"),e.resetPassword=s,e.delegateSubmit=u}]),angular.module("magellan").controller("SettingsCtrl",["$scope","AppConfig","FocusSrv","LogSrv","UserSrv",function(e,n,t,r,o){var i=function(){e.message=null;var i=n["settings.user.colors"];e.userObj={username:e.user.username,email:e.user.email,color:e.user.color},e.userColors=i;var s=function(n){e.userObj.color=n},u=function(){o.updateBasic(e.userObj).then(function(n){e.user.username=e.userObj.username,e.user.email=e.userObj.email,e.user.color=e.userObj.color,e.$apply(function(){e.message={type:"success",text:"Einstellungen wurden erfolgreich gespeichert"}})})["catch"](function(n){r.error("Update user",n);var t;switch(n.message){case"Username already exists":t="Der Benutzername ist bereits vergeben";break;case"Email address already exists":t="Die E-Mail-Adresse ist bereits vergeben";break;default:t="Die Einstellungen konnten nicht gespeichert werden"}e.$apply(function(){e.message={type:"error",text:t}})})},a=function(){u(!0)};e.setColor=s,e.updateUser=u,e.delegateSubmit=a,t("#username")};e.user&&i(),e.$on("user.loaded",function(e,n){i()})}]),angular.module("magellan").filter("renderHtml",["$sce",function(e){return function(n){return e.trustAsHtml(n)}}]),angular.module("magellan").filter("textOrNumber",["$filter",function(e){return function(n,t){return t=void 0!==t?0:t,isNaN(n)?n:e("number")(n,t)}}]),angular.module("magellan").directive("clickOutside",["$parse","$document","$rootScope",function(e,n,t){return{restrict:"A",link:function(e,r,o){function i(e){e.stopPropagation();var n=$(e.target).parents(),o=-1!==n.index($(r)),i=e.target===r[0],s=!o&&!i;s&&t.$broadcast("click.outside",e)}n.bind("click",i),r.bind("remove",function(){n.unbind("click",i)})}}}]),angular.module("magellan").directive("map",function(){return{restrict:"E",templateUrl:"build/views/templates/map.template.html",controller:"MapCtrl",link:function(e,n,t){new Datamap({element:document.getElementById("map-container"),fills:{defaultFill:"#22a7f0"},geographyConfig:{highlightOnHover:!0,popuponHover:!0,highlightFillColor:"#019875",highlightBorderColor:"rgba(200, 247, 197, 0.4)"}})}}}),angular.module("magellan").directive("quiz",function(){return{templateUrl:"build/views/templates/quiz-directive.template.html",scope:!0,controller:"QuizDirectiveController",restrict:"E",link:function(e,n,t){}}}),angular.module("magellan").factory("AuthInterceptor",["AuthTokenSrv",function(e){var n=function(n){var t=e.getToken();return t&&(n.headers=n.headers||{},n.headers["X-Auth"]=t),n};return{request:n}}]),angular.module("magellan").factory("AuthTokenSrv",["$window",function(e){var n=e.sessionStorage,t="auth-token",r=function(){return n.getItem(t)},o=function(e){e?n.setItem(t,e):n.removeItem(t)};return{getToken:r,setToken:o}}]),angular.module("magellan").factory("AuthSrv",["UserSrv",function(e){var n=null,t=function(){return new Promise(function(t,r){null!==n?t(n):e.getUserFromStorage().then(function(e){n=e,t(e)})["catch"](function(e){r("Not logged in")})})},r=function(e){n=e},o=function(){n=null};return{setUser:r,getUser:t,clearUser:o}}]),angular.module("magellan").factory("CountrySrv",["$http","IndexedDBSrv","LogSrv",function(e,n,t){var r=null,o=null,i=null,s="magellan",u="countryStore",a="countries",l="version",c=n.indexedDBAvailable(),f=function(){return d()},d=function(){return c?new Promise(function(e,a){n.createDatabase(s,u).then(h).then(m).then(v).then(g).then(p).then(function(n){r=n.countries,t.info("loaded countries from",n.loadStrategy.toUpperCase()),o={},i={},r.forEach(function(e){o[e.alpha3Code]=e;var n=e.name.substr(0,1).toUpperCase();switch(n){case"Ä":n="A";break;case"Ö":n="O";break;case"Ü":n="U"}void 0===i[n]&&(i[n]=[]),i[n].push({alpha3Code:e.alpha3Code,name:e.name})}),e(r)})["catch"](function(e){t.error("failed to load countries",e),a(e)})}):b()},g=function(e){return new Promise(function(n,t){var r,o=e.internalVersion,i=e.externalVersion;r=null===o?"api":i>o?"api":"db",e.loadStrategy=r,n(e)})},p=function(e){return new Promise(function(t,r){var o=e.loadStrategy;switch(o){case"api":b().then(function(r){e.countries=r,n.putItem(s,u,{name:a,value:r}),n.putItem(s,u,{name:l,value:e.externalVersion}),t(e)})["catch"](function(e){r(e)});break;case"db":w(e).then(function(e){t(e)})["catch"](function(e){r(e)});break;default:r("Unknown load strategy")}})},h=function(){return new Promise(function(e,n){e({})})},m=function(e){return new Promise(function(t,r){n.retrieveItem(s,u,l).then(function(n){e.internalVersion=n.value,t(e)})["catch"](function(n){e.internalVersion=null,t(e)})})},v=function(e){return O().then(function(n){return e.externalVersion=n,e})},w=function(e){return new Promise(function(t,r){n.retrieveItem(s,u,a).then(function(n){e.countries=n.value,t(e)})["catch"](function(e){t(null)})})},b=function(){return new Promise(function(n,t){e.get("/api/countries").then(function(e){n(e.data)})["catch"](function(e){t(e)})})},O=function(){return new Promise(function(n,t){e.get("/api/countries/version").then(function(e){n(e.data.version||0)})["catch"](function(e){n(0)})})},C=function(e){return null===o?null:o[e]},y=function(){return r},A=function(){return null===i?null:i},P=function(){return null!==r&&r.length>0};return{init:f,getCountries:y,getCountryByAlpha3:C,getCountriesByLetter:A,areCountriesLoaded:P}}]),angular.module("magellan").factory("EventSrv",["$http","LogSrv",function(e,n){var t=function(t){e.post("/api/event/add",{name:t}).success(function(e){})["catch"](function(e){n.error("failed to add event",e)})};return{add:t}}]),angular.module("magellan").factory("FocusSrv",["$timeout","$window",function(e,n){return function(t){e(function(){var e=n.document.querySelector(t);e&&e.focus()})}}]),angular.module("magellan").factory("IndexedDBSrv",["$window",function(e){var n="name",t=e.indexedDB||e.webkitIndexedDB||e.msIndexedDB,r=e.IDBKeyRange||e.webkitIDBKeyRange,o=e.IDBTransaction||e.webkitIDBTransaction;o&&(o.READ_WRITE=o.READ_WRITE||"readwrite",o.READ_ONLY=o.READ_ONLY||"readonly");var i=function(){return!!t},s=function(e,r){return new Promise(function(o,i){var s=t.open(e);s.onupgradeneeded=function(e){var t=e.target.result;t.createObjectStore(r,{keyPath:n})},s.onsuccess=function(e){o(e)},s.onerror=function(e){i(e)}})},u=function(e){return new Promise(function(n,r){var o=t.deleteDatabase(e);o.onsuccess=function(e){n(e)},o.onerror=function(e){r(e)}})},a=function(e,n,r){return new Promise(function(i,s){var u=t.open(e);u.onsuccess=function(e){var t=e.target.result,u=t.transaction(n,o.READ_WRITE),a=u.objectStore(n),l=a.add(r);l.onsuccess=function(e){i(e)},l.onerror=function(e){s(e)}}})},l=function(e,n,r){return new Promise(function(i,s){var u=t.open(e);u.onsuccess=function(e){var t=e.target.result,u=t.transaction(n,o.READ_WRITE),a=u.objectStore(n),l=a.put(r);l.onsuccess=function(e){i(e)},l.onerror=function(e){s(e)}}})},c=function(e,n,i){return new Promise(function(s,u){var a=null,l=t.open(e);l.onsuccess=function(e){var t=e.target.result,u=t.transaction(n,o.READ_ONLY),l=u.objectStore(n),c=r.only(i);l.openCursor(c).onsuccess=function(e){var n=e.target.result;n?(a=n.value,n["continue"]()):s(a)}},l.onerror=function(e){u(e)}})},f=function(e,n){return new Promise(function(r,i){var s=[],u=t.open(e);u.onsuccess=function(e){var t=e.target.result,i=t.transaction(n,o.READ_ONLY),u=i.objectStore(n);u.openCursor().onsuccess=function(e){var n=e.target.result;n?(s.push(n.value),n["continue"]()):r(s)}},u.onerror=function(e){i(e)}})};return{createDatabase:s,dropDatabase:u,addItem:a,putItem:l,retrieveItem:c,retrieveItems:f,indexedDBAvailable:i}}]),angular.module("magellan").factory("LogSrv",["AppConfig",function(e){var n=function(){e["log.info"]&&console.log.apply(console,arguments)},t=function(){e["log.error"]&&console.error.apply(console,arguments)};return{info:n,error:t}}]),angular.module("magellan").factory("QuizSrv",["AppConfig","CountrySrv","ScoreSrv","EventSrv",function(e,n,t,r){var o=null,i=null,s=function(e){o=e},u=function(){return null!==o&&o.length>0},a=function(){return new Promise(function(e,n){u||n("Countries have not been loaded"),i=g("country"),r.add("quiz.start"),e(i.start())})},l=function(){i=null},c=function(){return null===i?!1:i.hasStarted()&&!i.hasEnded()},f=function(){return null===i?!1:i.hasStarted()},d=function(){return null===i?!1:i.hasEnded()},g=function(e){switch(e){case"country":default:return p()}},p=function(){for(var t=new Quiz,r=100,i=3,s=25,u=2.5,a=e["quiz.country.types"],l=(Object.keys(a).length,[]),c=e["quiz.country.questions"],f=o.filter(function(e){return"easy"===e.difficulty}),d=o.filter(function(e){return"medium"===e.difficulty}),g=o.filter(function(e){return"hard"===e.difficulty}),p=0;c>p;p++){for(var C,y=!1;!y;)C=5>p?f[getRandomInt(0,f.length-1)]:10>p?d[getRandomInt(0,d.length-1)]:g[getRandomInt(0,g.length-1)],y=l.indexOf(C.alpha3Code)<0;l.push(C.alpha3Code)}var A=l.splice(0,l.length-1),P=_(A);P.push(l[l.length-1]);for(var S=[],$=0;c>$;$++)S.push(6);var T=_(S),U=0;return P.forEach(function(e,o){U++;var l=n.getCountryByAlpha3(e),f=a[T[o]],d=h(f,l),g={type:f,difficulty:l.difficulty,input:v(f),unit:w(f)},p=m(f,l),C=b(f,r,u),y=O(f,i,s);U>=c&&(g.bonus=!0),"FLAG_OF_COUNTRY"===f&&(g.media="flag",g.alpha2Code=l.alpha2Code.toLocaleLowerCase()),"LOCATION_OF_COUNTRY"===f&&(g.media="map",g.alpha2Code=l.alpha2Code.toLocaleLowerCase()),t.addQuestion(new Question({text:d,info:g,answer:p,checkAnswer:C,hints:y}))}),t},h=function(e,n){switch(e){case"CAPITAL_OF_COUNTRY":return"Wie heißt die Hauptstadt von ["+n.name+"]";case"COUNTRY_OF_CAPITAL":return"["+n.capital+"] ist die Hauptstadt von welchem Land";case"POPULATION_OF_COUNTRY":return"Wie viele Menschen leben in ["+n.name+"]";case"AREA_OF_COUNTRY":return"Wie groß ist die Fläche von ["+n.name+"]";case"FLAG_OF_COUNTRY":return"Welches Land hat diese Flagge";case"LOCATION_OF_COUNTRY":return"Wo befindet sich ["+n.name+"]";default:return"?"}},m=function(e,n){switch(e){case"CAPITAL_OF_COUNTRY":var t=void 0!==n.altSpellings&&void 0!==n.altSpellings.capital?n.altSpellings.capital:[];return{correct:n.capital,altSpellings:t};case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":var t=void 0!==n.altSpellings&&void 0!==n.altSpellings.name?n.altSpellings.name:[];return{correct:n.name,altSpellings:t};case"POPULATION_OF_COUNTRY":return{correct:n.population};case"AREA_OF_COUNTRY":return{correct:n.area};case"LOCATION_OF_COUNTRY":return{correct:n.alpha2Code};default:return"?"}},v=function(e){switch(e){case"POPULATION_OF_COUNTRY":return"number.high";case"AREA_OF_COUNTRY":return"number.medium";case"LOCATION_OF_COUNTRY":return"map.point";case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":default:return"text.standard"}},w=function(e){switch(e){case"AREA_OF_COUNTRY":return"km²";case"POPULATION_OF_COUNTRY":return"Einwohner";default:return null}},b=function(e,n,t){switch(e){case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":case"LOCATION_OF_COUNTRY":return function(e,r,o,i,s){var u;u=e.altSpellings&&e.altSpellings.length>0?e.altSpellings.map(function(e){return e.toLocaleLowerCase()}):[];var a=r.toLocaleLowerCase()===e.correct.toLocaleLowerCase()||u&&u.indexOf(r)>=0,l=a?n:0;return o>0&&(l-=o*i),void 0!==s&&void 0!==s.bonus&&s.bonus===!0&&(l*=t),l};case"POPULATION_OF_COUNTRY":case"AREA_OF_COUNTRY":return function(e,n,r,o,i){var s,u=Math.abs(n-e.correct)/e.correct*100;return s=3>=u?100:6>=u?90:9>=u?80:12>=u?70:14>=u?60:16>=u?50:18>=u?40:20>=u?30:25>=u?20:30>=u?10:0,r>0&&(s-=r*o),void 0!==i&&void 0!==i.bonus&&i.bonus===!0&&(s*=t),s};default:return"?"}},O=function(e,n,t){switch(e){case"CAPITAL_OF_COUNTRY":case"COUNTRY_OF_CAPITAL":case"FLAG_OF_COUNTRY":return{allowed:!0,maximum:n,cost:t,give:function(e,n){return n.correct.substr(0,e)}};case"POPULATION_OF_COUNTRY":case"AREA_OF_COUNTRY":return{allowed:!1};default:return"?"}},C=function(){return c()?i.getCurrentQuestionNumber():null},y=function(){return c()?i.getNumberOfQuestions():null},A=function(){return c()?i.currentQuestion():null},P=function(){c()&&i.nextQuestion()},S=function(){return null===i?null:i.getTotalPoints()},$=function(){return new Promise(function(e,n){null!==i&&i.hasEnded()?(i.submitted===!0&&n("Quiz has already been submitted"),i.submitted=!0,t.putHighscore(i.getTotalPoints()).then(function(n){r.add("quiz.finish"),e(n)})["catch"](function(e){n(e)})):n("No quiz is currently running")})},_=function(e){for(var n,t,r=e.length;0!==r;)t=Math.floor(Math.random()*r),r-=1,n=e[r],e[r]=e[t],e[t]=n;return e};return{init:a,setCountries:s,isQuizRunning:c,hasQuizStarted:f,hasQuizEnded:d,getCurrentQuestionNumber:C,getNumberOfQuizQuestions:y,getCurrentQuestion:A,nextQuestion:P,getTotalPoints:S,conclude:$,dispose:l}}]),angular.module("magellan").factory("ScoreSrv",["$http",function(e){var n=function(){return new Promise(function(n,t){
e.get("/api/scores/all").success(function(e){n(e)}).error(function(e){t(e)})})},t=function(){return new Promise(function(n,t){e.get("/api/scores/user").success(function(e){n(e)}).error(function(e){t(e)})})},r=function(){return new Promise(function(n,t){e.get("/api/scores/high").success(function(e){n(e)}).error(function(e){t(e)})})},o=function(n){return new Promise(function(t,r){e.put("/api/scores",{score:n}).success(function(e){t(e)}).error(function(e){r(e)})})};return{getHighscoreList:n,getUserHighscore:t,getOverallHighscore:r,putHighscore:o}}]),angular.module("magellan").factory("UserSrv",["$http","AuthTokenSrv","AppConfig",function(e,n,t){var r=this,o=function(){return e.get("/api/user")},i=function(){return new Promise(function(e,t){var r=n.getToken();r?(n.setToken(r),o().then(function(n){e(n.data)})["catch"](function(e){t(e)})):t("No token in storage")})},s=function(t,i){return e.post("/api/session",{username:t,password:i}).then(function(e){return r.token=e.data,n.setToken(r.token),o()})},u=function(){return new Promise(function(e,t){r.token=null,n.setToken(),e()})},a=function(n){return new Promise(function(r,o){var i=t["settings.user.colors"];n.color=i[getRandomInt(0,i.length-1)],e.post("/api/user",n).success(function(e){s(n.username,n.password).then(function(e){r(e)})["catch"](function(e){o(e)})}).error(function(e){o(e)})})},l=function(n){return new Promise(function(t,r){e.put("/api/user/basic",n).success(function(e){t(e)}).error(function(e){r(e)})})},c=function(n){return new Promise(function(t,r){e.put("/api/user/password",n).success(function(e){t(e)}).error(function(e){r(e)})})},f=function(n){return new Promise(function(t,r){e.post("/api/password/reset",n).success(function(e){t(e)}).error(function(e){r(e)})})},d=function(n){return new Promise(function(t,r){e.post("/api/password/forgot",n).success(function(e){t(e)}).error(function(e){r(e)})})};return{getUser:o,getUserFromStorage:i,login:s,logout:u,register:a,updateBasic:l,updatePassword:c,resetPassword:f,forgotPassword:d}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsInNjcmlwdC5qcyIsIm1vZGVscy5qcyIsInJvdXRlcy5qcyIsImNvbnRyb2xsZXJzL2NvdW50cmllcy5jdHJsLmpzIiwiY29udHJvbGxlcnMvY291bnRyeS1kZXRhaWwuY3RybC5qcyIsImNvbnRyb2xsZXJzL2NvdW50cnktZGlmZmljdWx0eS5jdHJsLmpzIiwiY29udHJvbGxlcnMvZHJvcGRvd24uY3RybC5qcyIsImNvbnRyb2xsZXJzL2ZhcS5jdHJsLmpzIiwiY29udHJvbGxlcnMvZm9yZ290LmN0cmwuanMiLCJjb250cm9sbGVycy9oaWdoc2NvcmUuY3RybC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luLmN0cmwuanMiLCJjb250cm9sbGVycy9sb2dvdXQuY3RybC5qcyIsImNvbnRyb2xsZXJzL21hcC5jdHJsLmpzIiwiY29udHJvbGxlcnMvcGFzc3dvcmQuY3RybC5qcyIsImNvbnRyb2xsZXJzL3F1aXotZGlyZWN0aXZlLmN0cmwuanMiLCJjb250cm9sbGVycy9xdWl6LmN0cmwuanMiLCJjb250cm9sbGVycy9yZWdpc3Rlci5jdHJsLmpzIiwiY29udHJvbGxlcnMvcmVzZXQuY3RybC5qcyIsImNvbnRyb2xsZXJzL3NldHRpbmdzLmN0cmwuanMiLCJmaWx0ZXJzL3JlbmRlckh0bWwuZmlsdGVyLmpzIiwiZmlsdGVycy90ZXh0T3JOdW1iZXIuanMiLCJkaXJlY3RpdmVzL2NsaWNrLW91dHNpZGUuZGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9tYXAuZGlyZWN0aXZlLmpzIiwiZGlyZWN0aXZlcy9xdWl6LmRpcmVjdGl2ZS5qcyIsImludGVyY2VwdG9ycy9hdXRoLmludGVyY2VwdG9yLmpzIiwic2VydmljZXMvYXV0aC10b2tlbi5zZXJ2aWNlLmpzIiwic2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic2VydmljZXMvY291bnRyeS5zZXJ2aWNlLmpzIiwic2VydmljZXMvZXZlbnQuc2VydmljZS5qcyIsInNlcnZpY2VzL2ZvY3VzLnNlcnZpY2UuanMiLCJzZXJ2aWNlcy9pbmRleGVkLWRiLnNlcnZpY2UuanMiLCJzZXJ2aWNlcy9sb2cuc2VydmljZS5qcyIsInNlcnZpY2VzL3F1aXouc2VydmljZS5qcyIsInNlcnZpY2VzL3Njb3JlLnNlcnZpY2UuanMiLCJzZXJ2aWNlcy91c2VyLnNlcnZpY2UuanMiXSwibmFtZXMiOlsibWFnZWxsYW4iLCJhbmd1bGFyIiwibW9kdWxlIiwiJGh0dHBQcm92aWRlciIsImludGVyY2VwdG9ycyIsInB1c2giLCJjb25zdGFudCIsImxvZy5pbmZvIiwibG9nLmVycm9yIiwicXVpei5jb3VudHJ5LnF1ZXN0aW9ucyIsInF1aXouY291bnRyeS50eXBlcyIsIjEiLCIyIiwiMyIsIjQiLCI1IiwiNiIsInNldHRpbmdzLnVzZXIuY29sb3JzIiwiY29udHJvbGxlciIsIiRyb290U2NvcGUiLCIkc2NvcGUiLCIkc3RhdGUiLCJBdXRoU3J2IiwiVXNlclNydiIsIkNvdW50cnlTcnYiLCJRdWl6U3J2IiwiYXBwIiwiY29uZmlnIiwidGl0bGUiLCJzdWJ0aXRsZSIsImF1dGhvciIsImdldFVzZXIiLCJ0aGVuIiwidXNlciIsIiRicm9hZGNhc3QiLCJpbml0IiwiY291bnRyaWVzIiwic2V0Q291bnRyaWVzIiwiZXJyIiwiaXNQcm9ncmVzc0JhclZpc2libGUiLCJpcyIsImdvVG9Ib21lIiwiZ28iLCIkb24iLCJldmVudCIsInRvU3RhdGUiLCJ0b1BhcmFtcyIsImZyb21TdGF0ZSIsImZyb21QYXJhbXMiLCJlcnJvciIsImRhdGEiLCJzZXRVc2VyIiwiY2xlYXJVc2VyIiwiY3JlYXRlTWFwIiwiRGF0YW1hcCIsImVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2VvZ3JhcGh5Q29uZmlnIiwiaGlnaGxpZ2h0T25Ib3ZlciIsInBvcHVwT25Ib3ZlciIsIlF1aXoiLCJjdXJyZW50UXVlc3Rpb25JZHgiLCJxdWVzdGlvbnMiLCJ0aGlzIiwic3RhcnQiLCJsZW5ndGgiLCJFcnJvciIsIm5leHRRdWVzdGlvbiIsImlzQWN0aXZlIiwiaGFzU3RhcnRlZCIsImhhc0VuZGVkIiwic3VibWl0dGVkIiwiYWRkUXVlc3Rpb24iLCJxdWVzdGlvbiIsInVuZGVmaW5lZCIsInZhbGlkIiwibmVjZXNzYXJ5UHJvcGVydGllcyIsImZvckVhY2giLCJwcm9wZXJ0eSIsImhhc093blByb3BlcnR5IiwiY3VycmVudFF1ZXN0aW9uIiwiZ2V0VG90YWxQb2ludHMiLCJ0b3RhbFBvaW50cyIsInBvaW50cyIsImdldEN1cnJlbnRRdWVzdGlvbk51bWJlciIsImdldE51bWJlck9mUXVlc3Rpb25zIiwiUXVlc3Rpb24iLCJvcHRpb25zIiwidGV4dCIsImluZm8iLCJhbnN3ZXIiLCJoaW50cyIsImhpbnRzVXNlZCIsImNoZWNrQW5zd2VyIiwiYW5zd2VyZWQiLCJvcHRzIiwiYWxsb3dlZCIsIm1heGltdW0iLCJjb3N0IiwiZ2l2ZSIsInByb3AiLCJ2YWx1ZSIsImdldEluZm8iLCJzb2x1dGlvbiIsImhpbnQiLCJzdWJtaXR0ZWRBbnN3ZXIiLCJNYXRoIiwibWF4IiwiZmxvb3IiLCJoaW50c0FsbG93ZWQiLCJoaW50c1JlbWFpbmluZyIsImdldFJhbmRvbUludCIsIm1pbiIsInJhbmRvbSIsImdldFN0cmluZ0JldHdlZW4iLCJmaXJzdFN0cmluZyIsInNlY29uZFN0cmluZyIsImZpcnN0UG9zIiwiaW5kZXhPZiIsInNlY29uZFBvcyIsInN1YnN0ciIsIlBhc3N3b3JkUmVxdWlyZW1lbnRzVmFsaWRhdG9yIiwic2VsZiIsImRlZmF1bHRDb25maWciLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJsb3dlcmNhc2VDaGFycyIsInVwcGVyY2FzZUNoYXJzIiwic3BlY2lhbENoYXJzIiwibnVtZXJpY0NoYXJzIiwiY29uZmlndXJhdGlvbiIsImlucHV0IiwiY2hlY2siLCJfaW5wdXQiLCJmYWlsZWRDaGVja3MiLCJjb25maWdQcm9wZXJ0aWVzIiwiZ2V0Q29uZmlnUHJvcGVydGllcyIsImNvbmZpZ1Byb3AiLCJyZXN1bHQiLCJwZXJmb3JtQ2hlY2siLCJwYXNzd29yZE9rIiwic2V0Q29uZmlnIiwiX2NvbmZpZyIsImdldENvbmZpZyIsIk9iamVjdCIsImtleXMiLCJnZXRDb25maWdQcm9wZXJ0eSIsInByb3BlcnR5VmFsdWUiLCJudW1Mb3dlciIsInJlcGxhY2UiLCJudW1VcHBlciIsIm51bVNwZWNpYWxzIiwibnVtTnVtYmVycyIsIkNPTkZJR19QUk9QRVJUSUVTIiwiZXhwb3J0cyIsIiRsb2NhdGlvblByb3ZpZGVyIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJodG1sNU1vZGUiLCJvdGhlcndpc2UiLCJhdXRob3JpemUiLCJMb2dTcnYiLCIkcSIsInJlamVjdCIsIiRpbmplY3QiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwicmVzb2x2ZSIsImF1dGgiLCJwYXJhbXMiLCJhY3Rpb24iLCJjb3VudHJpZXNCeUxldHRlciIsImNvdW50cnlLZXlzIiwiZ2V0Q291bnRyaWVzQnlMZXR0ZXIiLCJzb3J0IiwiJCRwaGFzZSIsIiRhcHBseSIsImFyZUNvdW50cmllc0xvYWRlZCIsIiRzdGF0ZVBhcmFtcyIsImFscGhhM0NvZGUiLCJjb3VudHJ5IiwiZ2V0Q291bnRyeUJ5QWxwaGEzIiwiZ2V0Q291bnRyeUZyb21TZXJ2aWNlIiwiYWxwaGEzIiwiZ2V0Q291bnRyaWVzIiwiZGlmZmljdWx0aWVzIiwiZWFzeSIsIm1lZGl1bSIsImhhcmQiLCJ1bmFzc2lnbmVkIiwiYSIsImIiLCJwb3B1bGF0aW9uIiwiYyIsImRpZmZpY3VsdHkiLCJkaWZmaWN1bHR5S2V5cyIsInRvZ2dsZURyb3Bkb3duIiwidmlzaWJsZSIsInNob3dEcm9wZG93biIsImhpZGVEcm9wZG93biIsImlzRHJvcGRvd25WaXNpYmxlIiwibWVzc2FnZSIsInR5cGUiLCJGb2N1c1NydiIsInBhc3NPYmoiLCJmb3Jnb3RQYXNzd29yZCIsImVtYWlsIiwidmFsaWRpdHkiLCJ2YWxpZFRleHQiLCJzZXRNZXNzYWdlIiwiZGVsZWdhdGVTdWJtaXQiLCJTY29yZVNydiIsInNjb3JlTGlzdCIsImlzRGF0YUxvYWRpbmciLCJnZXRIaWdoc2NvcmVMaXN0IiwibGlzdCIsImNyZWF0ZVJhbmtpbmciLCJzZXRMb2FkaW5nU3RhdGUiLCJpc015c2VsZiIsImlkIiwiX2lkIiwicmFuayIsInByZXZpb3VzU2NvcmUiLCJlbnRyeSIsInNjb3JlIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwicmVzcG9uc2UiLCIkZW1pdCIsImNvbnNvbGUiLCJtZXNzYWdlVGV4dCIsInN0YXR1cyIsImxvZ291dCIsInVwZGF0ZVBhc3N3b3JkIiwib2xkIiwiY29uZmlybWF0aW9uIiwibmdQcm9ncmVzc0ZhY3RvcnkiLCIkZmlsdGVyIiwiaW5pdEN0cmwiLCJwcm9ncmVzc2JhciIsImNyZWF0ZUluc3RhbmNlIiwic2V0UGFyZW50Iiwic2V0QWJzb2x1dGUiLCJzZXRDb2xvciIsImlzUmVzdWx0c1BhZ2VWaXNpYmxlIiwiYWNoaWV2ZW1lbnRzIiwiYmVzdHMiLCJhbnN3ZXJJbnB1dCIsIm11bHRpcGxpZXJPcHRpb25zIiwibGFiZWwiLCJ1cGRhdGVVaSIsImdldEN1cnJlbnRRdWVzdGlvbiIsIm11bHRpcGxpZXIiLCJ1cGRhdGVQcm9ncmVzc0JhciIsImdldFF1ZXN0aW9uIiwiZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zIiwicmVuZGVyUXVlc3Rpb25UZXh0IiwicmVuZGVyIiwiZ2V0UXVlc3Rpb25NZWRpYSIsIm1lZGlhIiwic2hvd1Jlc3VsdHNQYWdlIiwiaGlkZVJlc3VsdHNQYWdlIiwiaGludHNBdmFpbGFibGUiLCJzdWJtaXRBbnN3ZXIiLCJTdHJpbmciLCJ0cmltIiwid2FzTGFzdFF1ZXN0aW9uIiwicXVlc3Rpb25BbnN3ZXJlZCIsImlzUXVpelJ1bm5pbmciLCJyZXF1ZXN0SGludCIsImNsYXNzTmFtZSIsImhhbmRsZUtleVByZXNzIiwia2V5RXZlbnQiLCJ3aGljaCIsInByb2dyZXNzUGVyY2VudCIsInNldCIsInBhcnNlRXZlbnRzIiwiZXZlbnRzIiwicGVyc29uYWxCZXN0Iiwib3ZlcmFsbEJlc3QiLCJzaG93QmVzdHMiLCJkYXRlIiwiY29udGludWVGaW5pc2hlZCIsImNvbmNsdWRlIiwiZ2V0QmVzdFRleHQiLCJiZXN0IiwiZnJvbU15c2VsZiIsImdldEZvcm1hdHRlZERhdGUiLCJEYXRlIiwicGFkIiwiZ2V0RGF0ZSIsImdldE1vbnRoIiwiZ2V0WWVhciIsInN0ciIsInBhZFZhbHVlIiwic2xpY2UiLCJyZXN0YXJ0UXVpeiIsInF1aXoiLCJlbnRlckxpc3RlbmVyIiwia2V5UHJlc3MiLCJmdW5jIiwiaGFzUXVpelN0YXJ0ZWQiLCJoYXNRdWl6RW5kZWQiLCJkaXNwb3NlIiwic3RhcnRRdWl6IiwiY2IiLCIkd2luZG93IiwibmV3VXNlciIsInJlZ2lzdGVyIiwiaXNWYWxpZCIsInZhbGlkYXRlQmVmb3JlU3VibWl0IiwicGFzc3dvcmQyIiwidG9rZW4iLCJyZXNldFBhc3N3b3JkIiwiQXBwQ29uZmlnIiwiY29sb3JzIiwidXNlck9iaiIsImNvbG9yIiwidXNlckNvbG9ycyIsIm5ld0NvbG9yIiwidXBkYXRlVXNlciIsInVwZGF0ZUJhc2ljIiwiZmlsdGVyIiwiJHNjZSIsInRydXN0QXNIdG1sIiwiZnJhY3Rpb25TaXplIiwiaXNOYU4iLCJkaXJlY3RpdmUiLCIkcGFyc2UiLCIkZG9jdW1lbnQiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsImF0dHJzIiwiY2xpY2tPdXRzaWRlSGFuZGxlciIsInN0b3BQcm9wYWdhdGlvbiIsInRhcmdldFBhcmVudHMiLCIkIiwidGFyZ2V0IiwicGFyZW50cyIsImluc2lkZSIsImluZGV4Iiwib24iLCJvdXRzaWRlIiwiYmluZCIsInVuYmluZCIsImZpbGxzIiwiZGVmYXVsdEZpbGwiLCJwb3B1cG9uSG92ZXIiLCJoaWdobGlnaHRGaWxsQ29sb3IiLCJoaWdobGlnaHRCb3JkZXJDb2xvciIsImZhY3RvcnkiLCJBdXRoVG9rZW5TcnYiLCJhZGRUb2tlbiIsImdldFRva2VuIiwiaGVhZGVycyIsInJlcXVlc3QiLCJzdG9yZSIsInNlc3Npb25TdG9yYWdlIiwia2V5IiwiZ2V0SXRlbSIsInNldFRva2VuIiwic2V0SXRlbSIsInJlbW92ZUl0ZW0iLCJQcm9taXNlIiwiZ2V0VXNlckZyb21TdG9yYWdlIiwiX3VzZXIiLCIkaHR0cCIsIkluZGV4ZWREQlNydiIsImNvdW50cmllc0J5QWxwaGEzIiwiZGF0YWJhc2UiLCJrZXlDb3VudHJpZXMiLCJrZXlWZXJzaW9uIiwiaW5kZXhlZERCQXZhaWxhYmxlIiwibG9hZENvdW50cmllcyIsImNyZWF0ZURhdGFiYXNlIiwiZ2V0RW1wdHlPYmplY3QiLCJnZXRJbnRlcm5hbFZlcnNpb24iLCJnZXRFeHRlcm5hbFZlcnNpb24iLCJkZXRlcm1pbmVMb2FkU3RyYXRlZ3kiLCJsb2FkRGF0YSIsIm9iaiIsInRvVXBwZXJDYXNlIiwiZmlyc3RMZXR0ZXIiLCJuYW1lIiwiZ2V0Q291bnRyaWVzRnJvbUFQSSIsInN0cmF0ZWd5IiwiaW50ZXJuYWxWZXJzaW9uIiwiZXh0ZXJuYWxWZXJzaW9uIiwicHV0SXRlbSIsImdldENvdW50cmllc0Zyb21EQiIsIl9vYmoiLCJyZXRyaWV2ZUl0ZW0iLCJpdGVtIiwiZ2V0VmVyc2lvbkZyb21BUEkiLCJ2ZXJzaW9uIiwiZ2V0IiwiYWRkIiwicG9zdCIsInN1Y2Nlc3MiLCIkdGltZW91dCIsInNlbGVjdG9yIiwicXVlcnlTZWxlY3RvciIsImZvY3VzIiwia2V5UGF0aCIsImluZGV4ZWREQiIsIndlYmtpdEluZGV4ZWREQiIsIm1zSW5kZXhlZERCIiwiSURCS2V5UmFuZ2UiLCJ3ZWJraXRJREJLZXlSYW5nZSIsIklEQlRyYW5zYWN0aW9uIiwid2Via2l0SURCVHJhbnNhY3Rpb24iLCJSRUFEX1dSSVRFIiwiUkVBRF9PTkxZIiwiZGJOYW1lIiwic3RvcmVOYW1lIiwib3BlbiIsIm9udXBncmFkZW5lZWRlZCIsImUiLCJpZGIiLCJjcmVhdGVPYmplY3RTdG9yZSIsIm9uc3VjY2VzcyIsIm9uZXJyb3IiLCJkcm9wRGF0YWJhc2UiLCJkZWxldGVEYXRhYmFzZSIsImFkZEl0ZW0iLCJ0cmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlIiwicmVxdWVzdEFkZCIsInB1dCIsIml0ZW1OYW1lIiwicmFuZ2UiLCJvbmx5Iiwib3BlbkN1cnNvciIsImN1cnNvciIsInJldHJpZXZlSXRlbXMiLCJpdGVtcyIsImxvZ0luZm8iLCJsb2ciLCJhcHBseSIsImFyZ3VtZW50cyIsImxvZ0Vycm9yIiwiRXZlbnRTcnYiLCJfY291bnRyaWVzIiwiY291bnRyaWVzTG9hZGVkIiwiY3JlYXRlUXVpeiIsInF1aXpUeXBlIiwiY3JlYXRlQ291bnRyeVF1aXoiLCJjb3VudHJ5UXVpeiIsImZ1bGxQb2ludHMiLCJoaW50TWF4aW11bSIsImhpbnRDb3N0IiwibGFzdFF1ZXN0aW9uQm9udXMiLCJxdWVzdGlvblR5cGVzIiwic2VsZWN0ZWRDb3VudHJpZXMiLCJudW1iZXJPZlF1ZXN0aW9ucyIsImVhc3lDb3VudHJpZXMiLCJtZWRpdW1Db3VudHJpZXMiLCJoYXJkQ291bnRyaWVzIiwiaSIsImNvdW50cnlPayIsImFycmF5VG9TaHVmZmxlIiwic3BsaWNlIiwic2h1ZmZsZWRBcnJheSIsInNodWZmbGUiLCJxdWVzdGlvblR5cGVBcnJheSIsImoiLCJzaHVmZmxlZFF1ZXN0aW9uVHlwZUFycmF5IiwicWNudCIsImlkeCIsInF1ZXN0aW9uVHlwZSIsImdldFF1ZXN0aW9uVGV4dCIsImdldFF1ZXN0aW9uSW5wdXQiLCJ1bml0IiwiZ2V0UXVlc3Rpb25Vbml0IiwiZ2V0UXVlc3Rpb25BbnN3ZXIiLCJnZXRDaGVja0Fuc3dlckxhbWJkYSIsImdldFF1ZXN0aW9uSGludHMiLCJhbHBoYTJDb2RlIiwidG9Mb2NhbGVMb3dlckNhc2UiLCJjYXBpdGFsIiwiYWx0U3BlbGxpbmdzIiwiY29ycmVjdCIsImFyZWEiLCJhbGxvd2VkU3BlbGxpbmdzIiwibWFwIiwic3BlbGxpbmciLCJib251cyIsImVycm9yUGVyY2VudGFnZSIsImFicyIsImhpbnRzUG9zc2libGUiLCJwdXRIaWdoc2NvcmUiLCJhcnJheSIsInRlbXBvcmFyeVZhbHVlIiwicmFuZG9tSW5kZXgiLCJjdXJyZW50SW5kZXgiLCJnZXRVc2VySGlnaHNjb3JlIiwiZ2V0T3ZlcmFsbEhpZ2hzY29yZSIsInBhc3MiLCJib2R5Il0sIm1hcHBpbmdzIjoiQUFBQSxHQUFBQSxVQUFBQyxRQUFBQyxPQUFBLFlBQ0EsWUFDQSxhQUNBLGNDQ0ksZ0JEQUosU0FBQUMsR0FDQUEsRUFBQUMsYUFBQUMsS0FBQSxxQkFJQUwsVUFBQU0sU0FBQSxhQUNBQyxZQUFBLEVBQ0FDLGFBQUEsRUFFQUMseUJBQUEsRUFDQUMsc0JBQ0FDLEVBQUEscUJBQ0FDLEVBQUEscUJBQ0FDLEVBQUEsd0JBQ0FDLEVBQUEsa0JBQ0FDLEVBQUEsa0JBQ0FDLEVBQUEsdUJBR0FDLHdCQUNBLFdBQ0EsY0FDQSxZQUNBLGdCQUNBLFFBQ0EsZUFDQSxhQUNBLGNBQ0EsT0FDQSxTQUNBLGFBQ0Esa0JBQ0EsT0FDQSxXQUNBLGFBQ0EsZUFDQSxRQUNBLFVBQ0EsU0FDQSxXQUlBakIsU0FBQWtCLFdBQUEsV0FBQSxhQUFBLFNBQUEsU0FBQSxVQUFBLFVBQUEsYUFBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBRUFMLEVBQUFNLEtBQ0FDLFFBQ0FDLE1BQUEsV0FDQUMsU0FBQSxpREFDQUMsT0FBQSxvQkFLQVIsRUFBQVMsVUFDQUMsS0FBQSxTQUFBQyxHQUVBYixFQUFBYSxLQUFBQSxFQUVBYixFQUFBYyxXQUFBLGVBR0FWLEVBQUFXLE9BQ0FILEtBQUEsU0FBQUksR0FDQWhCLEVBQUFjLFdBQUEsbUJBQUFFLEdBR0FYLEVBQUFZLGFBQUFELE9BYkFkLFNBZ0JBLFNBQUFnQixHQUNBbEIsRUFBQWEsS0FBQSxPQUdBYixFQUFBbUIscUJBQUEsV0FDQSxNQUFBbEIsR0FBQW1CLEdBQUEsUUFHQSxJQUFBQyxHQUFBLFdBQ0FwQixFQUFBcUIsR0FBQSxRQUdBdEIsR0FBQXFCLFNBQUFBLEVBR0F0QixFQUFBd0IsSUFBQSxvQkFBQSxTQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxH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QUFBIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBtYWdlbGxhbiA9IGFuZ3VsYXIubW9kdWxlKFwibWFnZWxsYW5cIiwgW1xyXG4gICAgJ3VpLnJvdXRlcicsXHJcbiAgICAnbmdQcm9ncmVzcycsXHJcbiAgICAnbmdBbmltYXRlJ1xyXG5dLCBmdW5jdGlvbiBjb25maWcoJGh0dHBQcm92aWRlcikge1xyXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aEludGVyY2VwdG9yJyk7XHJcbn0pO1xyXG5cclxuLy8gZGVmaW5lIGFwcGxpY2F0aW9uIGNvbnN0YW50c1xyXG5tYWdlbGxhbi5jb25zdGFudChcIkFwcENvbmZpZ1wiLCB7XHJcbiAgICBcImxvZy5pbmZvXCI6IHRydWUsXHJcbiAgICBcImxvZy5lcnJvclwiOiB0cnVlLFxyXG5cclxuICAgIFwicXVpei5jb3VudHJ5LnF1ZXN0aW9uc1wiOiAzLFxyXG4gICAgXCJxdWl6LmNvdW50cnkudHlwZXNcIjoge1xyXG4gICAgICAgIDE6IFwiQ0FQSVRBTF9PRl9DT1VOVFJZXCIsXHJcbiAgICAgICAgMjogXCJDT1VOVFJZX09GX0NBUElUQUxcIixcclxuICAgICAgICAzOiBcIlBPUFVMQVRJT05fT0ZfQ09VTlRSWVwiLFxyXG4gICAgICAgIDQ6IFwiQVJFQV9PRl9DT1VOVFJZXCIsXHJcbiAgICAgICAgNTogXCJGTEFHX09GX0NPVU5UUllcIixcclxuICAgICAgICA2OiBcIkxPQ0FUSU9OX09GX0NPVU5UUllcIlxyXG4gICAgfSxcclxuXHJcbiAgICBcInNldHRpbmdzLnVzZXIuY29sb3JzXCI6IFtcclxuICAgICAgICAnc29mdF9yZWQnLFxyXG4gICAgICAgICd0aHVuZGVyYmlyZCcsXHJcbiAgICAgICAgJ29sZF9icmljaycsXHJcbiAgICAgICAgJ25ld195b3JrX3BpbmsnLFxyXG4gICAgICAgICdzbnVmZicsXHJcbiAgICAgICAgJ2hvbmV5X2Zsb3dlcicsXHJcbiAgICAgICAgJ3Nhbl9tYXJpbm8nLFxyXG4gICAgICAgICdzaGFrZXNwZWFyZScsXHJcbiAgICAgICAgJ21pbmcnLFxyXG4gICAgICAgICdnb3NzaXAnLFxyXG4gICAgICAgICdldWNhbHlwdHVzJyxcclxuICAgICAgICAnbW91bnRhaW5fbWVhZG93JyxcclxuICAgICAgICAnamFkZScsXHJcbiAgICAgICAgJ2NvbmZldHRpJyxcclxuICAgICAgICAnY2FsaWZvcm5pYScsXHJcbiAgICAgICAgJ2J1cm50X29yYW5nZScsXHJcbiAgICAgICAgJ2phZmZhJyxcclxuICAgICAgICAnZ2FsbGVyeScsXHJcbiAgICAgICAgJ2Vkd2FyZCcsXHJcbiAgICAgICAgJ2x5bmNoJ1xyXG4gICAgXVxyXG59KTtcclxuXHJcbm1hZ2VsbGFuLmNvbnRyb2xsZXIoXCJBcHBDdHJsXCIsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHN0YXRlLCBBdXRoU3J2LCBVc2VyU3J2LCBDb3VudHJ5U3J2LCBRdWl6U3J2KSB7XHJcbiAgICAvLyAtLS0tLS0tLS0tLSBBcHAgY29uZmlnIC0tLS0tLS0tLS0tLVxyXG4gICAgJHNjb3BlLmFwcCA9IHtcclxuICAgICAgICBjb25maWc6IHtcclxuICAgICAgICAgICAgdGl0bGU6IFwiTWFnZWxsYW5cIixcclxuICAgICAgICAgICAgc3VidGl0bGU6IFwiVGVzdGUgZGVpbiBXaXNzZW4gw7xiZXIgZGllIEzDpG5kZXIgdW5zZXJlciBFcmRlXCIsXHJcbiAgICAgICAgICAgIGF1dGhvcjogXCJNaWNoYWVsIFN0aWZ0ZXJcIlxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0gQXBwIGluaXRpYWxpemF0aW9uIC0tLS0tLS0tLS0tLVxyXG4gICAgQXV0aFNydi5nZXRVc2VyKClcclxuICAgICAgICAudGhlbihmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgIC8vIHN0b3JlIHVzZXIgb2JqZWN0IGluIHNjb3BlXHJcbiAgICAgICAgICAgICRzY29wZS51c2VyID0gdXNlcjtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCd1c2VyLmxvYWRlZCcpO1xyXG5cclxuICAgICAgICAgICAgLy8gaW5pdCBjb3VudHJ5IHNlcnZpY2VcclxuICAgICAgICAgICAgQ291bnRyeVNydi5pbml0KClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvdW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdjb3VudHJpZXMubG9hZGVkJywgY291bnRyaWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGNvdW50cmllcyBpbiBxdWl6IHNlcnZpY2VcclxuICAgICAgICAgICAgICAgICAgICBRdWl6U3J2LnNldENvdW50cmllcyhjb3VudHJpZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyID0gbnVsbDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuaXNQcm9ncmVzc0JhclZpc2libGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gJHN0YXRlLmlzKCdxdWl6Jyk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBnb1RvSG9tZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkc2NvcGUuZ29Ub0hvbWUgPSBnb1RvSG9tZTtcclxuXHJcbiAgICAvLyAtLS0tLS0tLS0tLSBFdmVudCBoYW5kbGluZyAtLS0tLS0tLS0tLS1cclxuICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xyXG4gICAgICAgIGlmIChlcnJvciA9PT0gJ05vdCBhdXRob3JpemVkJykge1xyXG4gICAgICAgICAgICAvLyBnbyB0byBob21lIHBhZ2VcclxuICAgICAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLiRvbignYXBwLmxvZ2luJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAvLyBzdG9yZSB1c2VyIG9iamVjdCBpbiBzY29wZVxyXG4gICAgICAgICRzY29wZS51c2VyID0gZGF0YTtcclxuXHJcbiAgICAgICAgLy8gYWRkaXRpb25hbGx5IHNhdmUgaXQgaW4gYXV0aCBzZXJ2aWNlXHJcbiAgICAgICAgQXV0aFNydi5zZXRVc2VyKGRhdGEpO1xyXG5cclxuICAgICAgICAvLyBpbml0IGNvdW50cnkgc2VydmljZVxyXG4gICAgICAgIENvdW50cnlTcnYuaW5pdCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvdW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ2NvdW50cmllcy5sb2FkZWQnLCBjb3VudHJpZXMpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHNldCBjb3VudHJpZXMgaW4gcXVpeiBzZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICBRdWl6U3J2LnNldENvdW50cmllcyhjb3VudHJpZXMpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gZ28gdG8gcXVpeiBwYWdlXHJcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkc2NvcGUuJG9uKCdhcHAubG9nb3V0JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAvLyByZW1vdmUgdXNlciBvYmplY3QgZnJvbSBzY29wZVxyXG4gICAgICAgICRzY29wZS51c2VyID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gYWRkaXRpb25hbGx5LCByZW1vdmUgaXQgZnJvbSBhdXRoIHNlcnZpY2VcclxuICAgICAgICBBdXRoU3J2LmNsZWFyVXNlcigpO1xyXG5cclxuICAgICAgICAvLyBnbyB0byBob21lIHBhZ2VcclxuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgIH0pO1xyXG59KTsiLCJ2YXIgbWFnZWxsYW4gPSBhbmd1bGFyLm1vZHVsZShcIm1hZ2VsbGFuXCIsIFtcclxuICAgICd1aS5yb3V0ZXInLFxyXG4gICAgJ25nUHJvZ3Jlc3MnLFxyXG4gICAgJ25nQW5pbWF0ZSdcclxuXSwgW1wiJGh0dHBQcm92aWRlclwiLCBmdW5jdGlvbiBjb25maWcoJGh0dHBQcm92aWRlcikge1xyXG4gICAgJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aEludGVyY2VwdG9yJyk7XHJcbn1dKTtcclxuXHJcbi8vIGRlZmluZSBhcHBsaWNhdGlvbiBjb25zdGFudHNcclxubWFnZWxsYW4uY29uc3RhbnQoXCJBcHBDb25maWdcIiwge1xyXG4gICAgXCJsb2cuaW5mb1wiOiB0cnVlLFxyXG4gICAgXCJsb2cuZXJyb3JcIjogdHJ1ZSxcclxuXHJcbiAgICBcInF1aXouY291bnRyeS5xdWVzdGlvbnNcIjogMyxcclxuICAgIFwicXVpei5jb3VudHJ5LnR5cGVzXCI6IHtcclxuICAgICAgICAxOiBcIkNBUElUQUxfT0ZfQ09VTlRSWVwiLFxyXG4gICAgICAgIDI6IFwiQ09VTlRSWV9PRl9DQVBJVEFMXCIsXHJcbiAgICAgICAgMzogXCJQT1BVTEFUSU9OX09GX0NPVU5UUllcIixcclxuICAgICAgICA0OiBcIkFSRUFfT0ZfQ09VTlRSWVwiLFxyXG4gICAgICAgIDU6IFwiRkxBR19PRl9DT1VOVFJZXCIsXHJcbiAgICAgICAgNjogXCJMT0NBVElPTl9PRl9DT1VOVFJZXCJcclxuICAgIH0sXHJcblxyXG4gICAgXCJzZXR0aW5ncy51c2VyLmNvbG9yc1wiOiBbXHJcbiAgICAgICAgJ3NvZnRfcmVkJyxcclxuICAgICAgICAndGh1bmRlcmJpcmQnLFxyXG4gICAgICAgICdvbGRfYnJpY2snLFxyXG4gICAgICAgICduZXdfeW9ya19waW5rJyxcclxuICAgICAgICAnc251ZmYnLFxyXG4gICAgICAgICdob25leV9mbG93ZXInLFxyXG4gICAgICAgICdzYW5fbWFyaW5vJyxcclxuICAgICAgICAnc2hha2VzcGVhcmUnLFxyXG4gICAgICAgICdtaW5nJyxcclxuICAgICAgICAnZ29zc2lwJyxcclxuICAgICAgICAnZXVjYWx5cHR1cycsXHJcbiAgICAgICAgJ21vdW50YWluX21lYWRvdycsXHJcbiAgICAgICAgJ2phZGUnLFxyXG4gICAgICAgICdjb25mZXR0aScsXHJcbiAgICAgICAgJ2NhbGlmb3JuaWEnLFxyXG4gICAgICAgICdidXJudF9vcmFuZ2UnLFxyXG4gICAgICAgICdqYWZmYScsXHJcbiAgICAgICAgJ2dhbGxlcnknLFxyXG4gICAgICAgICdlZHdhcmQnLFxyXG4gICAgICAgICdseW5jaCdcclxuICAgIF1cclxufSk7XHJcblxyXG5tYWdlbGxhbi5jb250cm9sbGVyKFwiQXBwQ3RybFwiLCBbXCIkcm9vdFNjb3BlXCIsIFwiJHNjb3BlXCIsIFwiJHN0YXRlXCIsIFwiQXV0aFNydlwiLCBcIlVzZXJTcnZcIiwgXCJDb3VudHJ5U3J2XCIsIFwiUXVpelNydlwiLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRzdGF0ZSwgQXV0aFNydiwgVXNlclNydiwgQ291bnRyeVNydiwgUXVpelNydikge1xyXG4gICAgLy8gLS0tLS0tLS0tLS0gQXBwIGNvbmZpZyAtLS0tLS0tLS0tLS1cclxuICAgICRzY29wZS5hcHAgPSB7XHJcbiAgICAgICAgY29uZmlnOiB7XHJcbiAgICAgICAgICAgIHRpdGxlOiBcIk1hZ2VsbGFuXCIsXHJcbiAgICAgICAgICAgIHN1YnRpdGxlOiBcIlRlc3RlIGRlaW4gV2lzc2VuIMO8YmVyIGRpZSBMw6RuZGVyIHVuc2VyZXIgRXJkZVwiLFxyXG4gICAgICAgICAgICBhdXRob3I6IFwiTWljaGFlbCBTdGlmdGVyXCJcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIC0tLS0tLS0tLS0tIEFwcCBpbml0aWFsaXphdGlvbiAtLS0tLS0tLS0tLS1cclxuICAgIEF1dGhTcnYuZ2V0VXNlcigpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgICAvLyBzdG9yZSB1c2VyIG9iamVjdCBpbiBzY29wZVxyXG4gICAgICAgICAgICAkc2NvcGUudXNlciA9IHVzZXI7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgndXNlci5sb2FkZWQnKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGluaXQgY291bnRyeSBzZXJ2aWNlXHJcbiAgICAgICAgICAgIENvdW50cnlTcnYuaW5pdCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihjb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgnY291bnRyaWVzLmxvYWRlZCcsIGNvdW50cmllcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBjb3VudHJpZXMgaW4gcXVpeiBzZXJ2aWNlXHJcbiAgICAgICAgICAgICAgICAgICAgUXVpelNydi5zZXRDb3VudHJpZXMoY291bnRyaWVzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAkc2NvcGUudXNlciA9IG51bGw7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLmlzUHJvZ3Jlc3NCYXJWaXNpYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuICRzdGF0ZS5pcygncXVpeicpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZ29Ub0hvbWUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcclxuICAgIH07XHJcblxyXG4gICAgJHNjb3BlLmdvVG9Ib21lID0gZ29Ub0hvbWU7XHJcblxyXG4gICAgLy8gLS0tLS0tLS0tLS0gRXZlbnQgaGFuZGxpbmcgLS0tLS0tLS0tLS0tXHJcbiAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlRXJyb3InLCBmdW5jdGlvbihldmVudCwgdG9TdGF0ZSwgdG9QYXJhbXMsIGZyb21TdGF0ZSwgZnJvbVBhcmFtcywgZXJyb3IpIHtcclxuICAgICAgICBpZiAoZXJyb3IgPT09ICdOb3QgYXV0aG9yaXplZCcpIHtcclxuICAgICAgICAgICAgLy8gZ28gdG8gaG9tZSBwYWdlXHJcbiAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICRzY29wZS4kb24oJ2FwcC5sb2dpbicsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgLy8gc3RvcmUgdXNlciBvYmplY3QgaW4gc2NvcGVcclxuICAgICAgICAkc2NvcGUudXNlciA9IGRhdGE7XHJcblxyXG4gICAgICAgIC8vIGFkZGl0aW9uYWxseSBzYXZlIGl0IGluIGF1dGggc2VydmljZVxyXG4gICAgICAgIEF1dGhTcnYuc2V0VXNlcihkYXRhKTtcclxuXHJcbiAgICAgICAgLy8gaW5pdCBjb3VudHJ5IHNlcnZpY2VcclxuICAgICAgICBDb3VudHJ5U3J2LmluaXQoKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihjb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYnJvYWRjYXN0KCdjb3VudHJpZXMubG9hZGVkJywgY291bnRyaWVzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgY291bnRyaWVzIGluIHF1aXogc2VydmljZVxyXG4gICAgICAgICAgICAgICAgUXVpelNydi5zZXRDb3VudHJpZXMoY291bnRyaWVzKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGdvIHRvIHF1aXogcGFnZVxyXG4gICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgJHNjb3BlLiRvbignYXBwLmxvZ291dCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgLy8gcmVtb3ZlIHVzZXIgb2JqZWN0IGZyb20gc2NvcGVcclxuICAgICAgICAkc2NvcGUudXNlciA9IG51bGw7XHJcblxyXG4gICAgICAgIC8vIGFkZGl0aW9uYWxseSwgcmVtb3ZlIGl0IGZyb20gYXV0aCBzZXJ2aWNlXHJcbiAgICAgICAgQXV0aFNydi5jbGVhclVzZXIoKTtcclxuXHJcbiAgICAgICAgLy8gZ28gdG8gaG9tZSBwYWdlXHJcbiAgICAgICAgJHN0YXRlLmdvKCdob21lJyk7XHJcbiAgICB9KTtcclxufV0pO1xuLy8gb3duIGNsYXNzZXMgYW5kIGZ1bmN0aW9uc1xyXG5cclxuLy8gLS0tLS0tLS0tLSBNQVAgLS0tLS0tLS0tLVxyXG52YXIgY3JlYXRlTWFwID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgbWFwID0gbmV3IERhdGFtYXAoe1xyXG4gICAgICAgIGVsZW1lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYXAtY29udGFpbmVyJyksXHJcbiAgICAgICAgZ2VvZ3JhcGh5Q29uZmlnOiB7XHJcbiAgICAgICAgICAgIGhpZ2hsaWdodE9uSG92ZXI6IHRydWUsXHJcbiAgICAgICAgICAgIHBvcHVwT25Ib3ZlcjogZmFsc2VcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIC0tLS0tLS0tLS0gUVVJWiAtLS0tLS0tLS0tXHJcbnZhciBRdWl6ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAvLyBpbmRleCBvZiBjdXJyZW50IHF1ZXN0aW9uXHJcbiAgICB2YXIgY3VycmVudFF1ZXN0aW9uSWR4ID0gbnVsbDtcclxuXHJcbiAgICAvLyBhcnJheSBjb250YWluaW5nIGFsbCBxdWVzdGlvbnNcclxuICAgIHZhciBxdWVzdGlvbnMgPSBbXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFN0YXJ0cyB0aGUgcXVpei5cclxuICAgICAqL1xyXG4gICAgdGhpcy5zdGFydCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIHF1aXogaGFzIHF1ZXN0aW9uc1xyXG4gICAgICAgIGlmIChxdWVzdGlvbnMubGVuZ3RoIDw9IDApXHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiQ2Fubm90IHN0YXJ0IGEgcXVpeiB3aXRob3V0IHF1ZXN0aW9uc1wiKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMubmV4dFF1ZXN0aW9uKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuaXNBY3RpdmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5oYXNTdGFydGVkKCkgJiYgIXRoaXMuaGFzRW5kZWQoKTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5oYXNTdGFydGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRRdWVzdGlvbklkeCAhPT0gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5oYXNFbmRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhhc1N0YXJ0ZWQoKSAmJiBjdXJyZW50UXVlc3Rpb25JZHggPj0gcXVlc3Rpb25zLmxlbmd0aDtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5zdWJtaXR0ZWQgPSBmYWxzZTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIEFkZHMgYSBuZXcgcXVlc3Rpb24gdG8gdGhlIHF1aXouXHJcbiAgICAgKiBUaGUgcGFyYW1ldGVyIG11c3QgYmUgYW4gcXVlc3Rpb24gb2JqZWN0LlxyXG4gICAgICogSWYgbm8gcXVlc3Rpb24gb2JqZWN0IGlzIHBhc3NlZCBvciBhbiBvYmplY3Qgd2l0aCBtaXNzaW5nIHByb3BlcnRpZXMsIGFuIGVycm9yIGlzIHRocm93bi5cclxuICAgICAqL1xyXG4gICAgdGhpcy5hZGRRdWVzdGlvbiA9IGZ1bmN0aW9uKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgaWYgKHF1ZXN0aW9uID09PSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwiTm8gcXVlc3Rpb24gb2JqZWN0IHBhc3NlZFwiKTtcclxuXHJcbiAgICAgICAgdmFyIHZhbGlkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gYSBxdWVzdGlvbiBvYmplY3QgbXVzdCBjb250YWluIGFsbCB0aGVzZSBwcm9wZXJ0aWVzXHJcbiAgICAgICAgdmFyIG5lY2Vzc2FyeVByb3BlcnRpZXMgPSBbJ2NvbmZpZycsICdoaW50JywgJ3NvbHV0aW9uJywgJ2Fuc3dlcicsICdxdWVzdGlvbicsICdnZXRJbmZvJywgJ2luZm8nLCAncG9pbnRzJywgJ2Fuc3dlcmVkJywgJ2hpbnRzQWxsb3dlZCcsICdoaW50c1JlbWFpbmluZyddO1xyXG5cclxuICAgICAgICBuZWNlc3NhcnlQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcGVydHkpIHtcclxuICAgICAgICAgICAgaWYgKCFxdWVzdGlvbi5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkpIHtcclxuICAgICAgICAgICAgICAgIHZhbGlkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJRdWVzdGlvbiBtdXN0IGhhdmUgcHJvcGVydHkgJ1wiICsgcHJvcGVydHkgKyBcIidcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKHZhbGlkKSB7XHJcbiAgICAgICAgICAgIHF1ZXN0aW9ucy5wdXNoKHF1ZXN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgbmV4dCBxdWVzdGlvbiBvZiB0aGUgcXVpei5cclxuICAgICAqIElmIHRoZSBxdWl6IGhhcyBlbmRlZCwgaXQgcmV0dXJucyBub3RoaW5nLlxyXG4gICAgICovXHJcbiAgICB0aGlzLm5leHRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChjdXJyZW50UXVlc3Rpb25JZHggPT09IG51bGwpIHtcclxuICAgICAgICAgICAgY3VycmVudFF1ZXN0aW9uSWR4ID0gMDtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjdXJyZW50UXVlc3Rpb25JZHgrKztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmhhc0VuZGVkKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHF1ZXN0aW9uc1tjdXJyZW50UXVlc3Rpb25JZHhdO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmN1cnJlbnRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5pc0FjdGl2ZSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHF1ZXN0aW9uc1tjdXJyZW50UXVlc3Rpb25JZHhdO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmdldFRvdGFsUG9pbnRzID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5oYXNTdGFydGVkKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdG90YWxQb2ludHMgPSAwO1xyXG5cclxuICAgICAgICBxdWVzdGlvbnMuZm9yRWFjaChmdW5jdGlvbihxdWVzdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgcG9pbnRzID0gcXVlc3Rpb24ucG9pbnRzKCk7XHJcblxyXG4gICAgICAgICAgICBpZiAocG9pbnRzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIHRvdGFsUG9pbnRzICs9IHBvaW50cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gdG90YWxQb2ludHM7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRRdWVzdGlvbklkeCA9PT0gbnVsbClcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgIHJldHVybiBjdXJyZW50UXVlc3Rpb25JZHggKyAxO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmdldE51bWJlck9mUXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHF1ZXN0aW9ucy5sZW5ndGg7XHJcbiAgICB9O1xyXG59O1xyXG5cclxuLy8gLS0tLS0tLS0tLSBRVUVTVElPTiAtLS0tLS0tLS0tXHJcbnZhciBRdWVzdGlvbiA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuICAgIC8vIFRleHQgb2YgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgdGV4dCA9IG51bGw7XHJcblxyXG4gICAgLy8gSW5mbyBvYmplY3QgZm9yIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIGluZm8gPSBudWxsO1xyXG5cclxuICAgIC8vIEFuc3dlciBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBhbnN3ZXIgPSBudWxsO1xyXG5cclxuICAgIC8vIEhpbnRzIG9mIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIGhpbnRzID0gbnVsbDtcclxuICAgIHZhciBoaW50c1VzZWQgPSAwO1xyXG5cclxuICAgIC8vIExhbWJkYSBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhlIGFuc3dlciBzdGF0dXMgb2YgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgY2hlY2tBbnN3ZXIgPSBudWxsO1xyXG5cclxuICAgIC8vIFBvaW50cyBhd2FyZGVkIGZvciB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBwb2ludHMgPSBudWxsO1xyXG5cclxuICAgIC8vIEZsYWcgaW5kaWNhdGluZyB3aGV0aGVyIHF1ZXN0aW9uIGhhcyBhbHJlYWR5IGJlZW4gYW5zd2VyZWRcclxuICAgIHZhciBhbnN3ZXJlZCA9IGZhbHNlO1xyXG5cclxuICAgIHZhciBpbml0ID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgICAgIHRleHQgPSBvcHRzLnRleHQ7XHJcbiAgICAgICAgaW5mbyA9IG9wdHMuaW5mbyB8fCB7fTtcclxuICAgICAgICBhbnN3ZXIgPSBvcHRzLmFuc3dlcjtcclxuICAgICAgICBjaGVja0Fuc3dlciA9IG9wdHMuY2hlY2tBbnN3ZXIgfHwgbnVsbDtcclxuXHJcbiAgICAgICAgaGludHMgPSBvcHRzLmhpbnRzIHx8IHtcclxuICAgICAgICAgICAgICAgIGFsbG93ZWQ6IGZhbHNlLCAgICAgLy8gaXMgYSBoaW50IGFsbG93ZWQ/XHJcbiAgICAgICAgICAgICAgICBtYXhpbXVtOiAwLCAgICAgICAgIC8vIG1heGltdW0gbnVtYmVyIG9mIGhpbnRzIGZvciB0aGlzIHF1ZXN0aW9uIChpcnJlbGV2YW50IGlmIGFsbG93ZWQgaXMgc2V0IHRvIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgY29zdDogMCwgICAgICAgICAgICAvLyBudW1iZXIgb2YgcG9pbnRzIHN1YnRyYWN0ZWQgcGVyIHVzZWQgaGludCAoaXJyZWxldmFudCBpZiBhbGxvd2VkIGlzIHNldCB0byBmYWxzZSlcclxuICAgICAgICAgICAgICAgIGdpdmU6IG51bGwgICAgICAgICAgLy8gbGFtYmRhIGZ1bmN0aW9uIHRvIGdpdmUgYSBoaW50IGZvciBhIHF1ZXN0aW9uXHJcbiAgICAgICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChvcHRpb25zKSB7XHJcbiAgICAgICAgaW5pdChvcHRpb25zKTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLmNvbmZpZyA9IGZ1bmN0aW9uKG9wdHMpIHtcclxuICAgICAgICBpbml0KG9wdHMpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHF1ZXN0aW9uIHRleHQuXHJcbiAgICAgKi9cclxuICAgIHRoaXMucXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gdGV4dDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBxdWVzdGlvbiBpbmZvIG9iamVjdC5cclxuICAgICAqIEFjdHMgYXMgZ2V0dGVyICh3aXRoIG9ubHkgb25lIGFyZ3VtZW50KSBhbmQgc2V0dGVyICh3aXRoIHR3byBhcmd1bWVudHMpXHJcbiAgICAgKi9cclxuICAgIHRoaXMuaW5mbyA9IGZ1bmN0aW9uKHByb3AsIHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgLy8gc2V0dGVyXHJcbiAgICAgICAgICAgIGluZm9bcHJvcF0gPSB2YWx1ZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBnZXR0ZXJcclxuICAgICAgICAgICAgcmV0dXJuIGluZm9bcHJvcF07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIGVudGlyZSBpbmZvIG9iamVjdC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5nZXRJbmZvID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGluZm87XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgY29ycmVjdCBhbnN3ZXIgdG8gdGhlIHF1ZXN0aW9uIGFmdGVyIHRoZSBxdWVzdGlvbiBoYXMgYmVlbiBhbnN3ZXJlZC5cclxuICAgICAqIElmIHRoZSBxdWVzdGlvbiBoYXMgbm90IGJlZW4gYW5zd2VyZWQgeWV0LCBpdCByZXR1cm5zIG51bGwuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuc29sdXRpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoYW5zd2VyZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFuc3dlcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgYSBoaW50IGZvciB0aGUgcXVlc3Rpb24uXHJcbiAgICAgKiBJZiBubyBoaW50cyBhcmUgYWxsb3dlZCwgb3IgdGhlIG1heGltdW0gbnVtYmVyIG9mIGhpbnRzIGhhdmUgYmVlbiB1c2VkLCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmhpbnQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoIWhpbnRzLmFsbG93ZWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGludHMuYWxsb3dlZCAmJiAhaGludHMuZ2l2ZSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIaW50cyBhbGxvd2VkIGJ1dCBubyBnaXZlIG1ldGhvZCBwYXNzZWRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGludHNVc2VkIDwgaGludHMubWF4aW11bSkge1xyXG4gICAgICAgICAgICBoaW50c1VzZWQrKztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBoaW50cy5naXZlKGhpbnRzVXNlZCwgYW5zd2VyKTtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBTdWJtaXRzIGFuIGFuc3dlciB0byB0aGUgcXVlc3Rpb24uXHJcbiAgICAgKiBJZiB0aGUgcXVlc3Rpb24gaGFzIGFscmVhZHkgYmVlbiBhbnN3ZXJlZCBvciBubyBjaGVja0Fuc3dlciBsYW1iZGEgaGFzIGJlZW4gc2V0LCB0aGlzIG1ldGhvZCBkb2VzIG5vdGhpbmcuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuYW5zd2VyID0gZnVuY3Rpb24oc3VibWl0dGVkQW5zd2VyKSB7XHJcbiAgICAgICAgaWYgKGFuc3dlcmVkIHx8IWNoZWNrQW5zd2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGFuc3dlcmVkID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgLy8gY2hlY2tBbnN3ZXIgbWV0aG9kIHNob3VsZCByZXR1cm4gdGhlIHN0YXR1cyByZXN1bHRzXHJcbiAgICAgICAgcG9pbnRzID0gY2hlY2tBbnN3ZXIoYW5zd2VyLCBzdWJtaXR0ZWRBbnN3ZXIsIGhpbnRzVXNlZCwgaGludHMuY29zdCwgaW5mbyk7XHJcblxyXG4gICAgICAgIC8vIGVuc3VyZSB0aGF0IG5vIG5lZ2F0aXZlIHBvaW50cyBhcmUgYXdhcmRlZFxyXG4gICAgICAgIHBvaW50cyA9IE1hdGgubWF4KDAsIHBvaW50cyk7XHJcblxyXG4gICAgICAgIC8vIGVuc3VyZSB0aGF0IG9ubHkgaW50ZWdlciB2YWx1ZXMgYXJlIHNhdmVkXHJcbiAgICAgICAgcG9pbnRzID0gTWF0aC5mbG9vcihwb2ludHMpO1xyXG5cclxuICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnBvaW50cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghYW5zd2VyZWQgfHwgcG9pbnRzID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBzdGF0ZSBvZiB0aGUgcXVlc3Rpb24uXHJcbiAgICAgKi9cclxuICAgIHRoaXMuYW5zd2VyZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gYW5zd2VyZWQ7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0cnVlIGlmIGhpbnRzIGFyZSBhbGxvd2VkIGZvciB0aGlzIHF1ZXN0aW9uLCBmYWxzZSBpZiBub3QuXHJcbiAgICAgKiBJZiBoaW50cyBoYXZlIG5vdCBiZWVuIGluaXRpYWxpemVkIHlldCwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5oaW50c0FsbG93ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoaGludHMgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGhpbnRzLmFsbG93ZWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgcmVtYWluaW5nIGhpbnRzLlxyXG4gICAgICogSWYgbm8gaGludHMgYXJlIGFsbG93ZWQgZm9yIHRoaXMgcXVlc3Rpb24sIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuaGludHNSZW1haW5pbmcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYWxsb3dlZCA9IHRoaXMuaGludHNBbGxvd2VkKCk7XHJcblxyXG4gICAgICAgIGlmIChhbGxvd2VkID09PSBudWxsIHx8IGFsbG93ZWQgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGhpbnRzLm1heGltdW0gLSBoaW50c1VzZWQ7XHJcbiAgICB9O1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgYSByYW5kb20gaW50ZWdlciBiZXR3ZWVuIG1pbiAoaW5jbHVzaXZlKSBhbmQgbWF4IChpbmNsdXNpdmUpXHJcbiAqIFVzaW5nIE1hdGgucm91bmQoKSB3aWxsIGdpdmUgeW91IGEgbm9uLXVuaWZvcm0gZGlzdHJpYnV0aW9uIVxyXG4gKi9cclxudmFyIGdldFJhbmRvbUludCA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XHJcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIHRoZSB0ZXh0IGJldHdlZW4gdHdvIGRlbGltaXRpbmcgdGV4dCBvY2N1cnJlbmNlc1xyXG4gKi9cclxudmFyIGdldFN0cmluZ0JldHdlZW4gPSBmdW5jdGlvbih0ZXh0LCBmaXJzdFN0cmluZywgc2Vjb25kU3RyaW5nKSB7XHJcbiAgICB2YXIgZmlyc3RQb3MgPSB0ZXh0LmluZGV4T2YoZmlyc3RTdHJpbmcpO1xyXG4gICAgdmFyIHNlY29uZFBvcyA9IHRleHQuaW5kZXhPZihzZWNvbmRTdHJpbmcpO1xyXG5cclxuICAgIGlmIChmaXJzdFBvcyA+PSAwICYmIHNlY29uZFBvcyA+PSAwICYmIHNlY29uZFBvcyA+IGZpcnN0UG9zKSB7XHJcbiAgICAgICAgcmV0dXJuIHRleHQuc3Vic3RyKGZpcnN0UG9zICsgMSwgc2Vjb25kUG9zIC0gZmlyc3RQb3MgLSAxKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxufTtcclxuXHJcbi8vIC0tLS0tLS0tLS0gUEFTU1dPUkQgUkVRVUlSRU1FTlRTIFZBTElEQVRPUiAtLS0tLS0tLS0tXHJcbnZhciBQYXNzd29yZFJlcXVpcmVtZW50c1ZhbGlkYXRvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIC8vIGRlZmF1bHQgY29uZmlndXJhdGlvblxyXG4gICAgdmFyIGRlZmF1bHRDb25maWcgPSB7XHJcbiAgICAgICAgbWluTGVuZ3RoOiA4LFxyXG4gICAgICAgIG1heExlbmd0aDogdW5kZWZpbmVkLFxyXG4gICAgICAgIGxvd2VyY2FzZUNoYXJzOiAxLFxyXG4gICAgICAgIHVwcGVyY2FzZUNoYXJzOiAxLFxyXG4gICAgICAgIHNwZWNpYWxDaGFyczogMSxcclxuICAgICAgICBudW1lcmljQ2hhcnM6IDFcclxuICAgIH07XHJcblxyXG4gICAgLy8gdXNlZCBjb25maWd1cmF0aW9uXHJcbiAgICB2YXIgY29uZmlndXJhdGlvbiA9IG51bGw7XHJcblxyXG4gICAgLy8gcGFzc3dvcmQgaW5wdXRcclxuICAgIHRoaXMuaW5wdXQgPSBudWxsO1xyXG5cclxuICAgIHRoaXMuY2hlY2sgPSBmdW5jdGlvbihfaW5wdXQpIHtcclxuICAgICAgICAvLyBjaGVjayBpZiBhbiBpbnB1dCB3YXMgcGFzc2VkXHJcbiAgICAgICAgaWYgKHR5cGVvZiBfaW5wdXQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBtYW5kYXRvcnkgaW5wdXQgcGFyYW1ldGVyJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBjaGVjayBpZiBwYXNzZWQgaW5wdXQgaXMgb2YgdHlwZSBcInN0cmluZ1wiXHJcbiAgICAgICAgaWYgKHR5cGVvZiBfaW5wdXQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmlyc3QgaW5wdXQgcGFyYW1ldGVyIG11c3QgYmUgb2YgdHlwZSBcXFwic3RyaW5nXFxcIicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0IGlucHV0IHZhcmlhYmxlXHJcbiAgICAgICAgdGhpcy5pbnB1dCA9IF9pbnB1dDtcclxuXHJcbiAgICAgICAgLy8gYXJyYXkgY29udGFpbmluZyBhbGwgZmFpbGVkIGNoZWNrc1xyXG4gICAgICAgIHZhciBmYWlsZWRDaGVja3MgPSBbXTtcclxuXHJcbiAgICAgICAgLy8gZ2V0IGFsbCBzZXQgY29uZmlnIHByb3BlcnRpZXNcclxuICAgICAgICB2YXIgY29uZmlnUHJvcGVydGllcyA9IGdldENvbmZpZ1Byb3BlcnRpZXMoKTtcclxuXHJcbiAgICAgICAgY29uZmlnUHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKGNvbmZpZ1Byb3ApIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHBlcmZvcm1DaGVjayhjb25maWdQcm9wKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChyZXN1bHQgIT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgIGZhaWxlZENoZWNrcy5wdXNoKGNvbmZpZ1Byb3ApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHJldHVybiByZXN1bHRcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBwYXNzd29yZE9rOiBmYWlsZWRDaGVja3MubGVuZ3RoID09PSAwLFxyXG4gICAgICAgICAgICBmYWlsZWRDaGVja3M6IGZhaWxlZENoZWNrc1xyXG4gICAgICAgIH07XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuc2V0Q29uZmlnID0gZnVuY3Rpb24oX2NvbmZpZykge1xyXG4gICAgICAgIGNvbmZpZ3VyYXRpb24gPSBfY29uZmlnO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmdldENvbmZpZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBjb25maWd1cmF0aW9uIHx8IGRlZmF1bHRDb25maWc7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBpc0NvbmZpZ1Byb3BlcnR5U2V0ID0gZnVuY3Rpb24ocHJvcCkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2Ygc2VsZi5nZXRDb25maWcoKVtwcm9wXSAhPT0gJ3VuZGVmaW5lZCc7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBnZXRDb25maWdQcm9wZXJ0aWVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHNlbGYuZ2V0Q29uZmlnKCkpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZ2V0Q29uZmlnUHJvcGVydHkgPSBmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYuZ2V0Q29uZmlnKClbcHJvcF07XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwZXJmb3JtQ2hlY2sgPSBmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBzZWxmLmlucHV0ICE9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgcHJvcGVydHlWYWx1ZSA9IGdldENvbmZpZ1Byb3BlcnR5KHByb3ApO1xyXG5cclxuICAgICAgICBpZiAoIXByb3BlcnR5VmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzd2l0Y2ggKHByb3ApIHtcclxuICAgICAgICAgICAgY2FzZSAnbWluTGVuZ3RoJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmlucHV0Lmxlbmd0aCA+PSBwcm9wZXJ0eVZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnbWF4TGVuZ3RoJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmlucHV0Lmxlbmd0aCA8PSBwcm9wZXJ0eVZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnbG93ZXJjYXNlQ2hhcnMnOlxyXG4gICAgICAgICAgICAgICAgdmFyIG51bUxvd2VyID0gc2VsZi5pbnB1dC5sZW5ndGggLSBzZWxmLmlucHV0LnJlcGxhY2UoL1thLXpdL2csICcnKS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bUxvd2VyID49IHByb3BlcnR5VmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlICd1cHBlcmNhc2VDaGFycyc6XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtVXBwZXIgPSBzZWxmLmlucHV0Lmxlbmd0aCAtIHNlbGYuaW5wdXQucmVwbGFjZSgvW0EtWl0vZywgJycpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVtVXBwZXIgPj0gcHJvcGVydHlWYWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ3NwZWNpYWxDaGFycyc6XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtU3BlY2lhbHMgPSBzZWxmLmlucHV0Lmxlbmd0aCAtIHNlbGYuaW5wdXQucmVwbGFjZSgvWyFAwqckJSYjXipfOjsuLCtcIidgwrRcXHtcXH1cXChcXClcXFtcXF1cXC9cXFxcLV0vZywgJycpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVtU3BlY2lhbHMgPj0gcHJvcGVydHlWYWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ251bWVyaWNDaGFycyc6XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtTnVtYmVycyA9IHNlbGYuaW5wdXQubGVuZ3RoIC0gc2VsZi5pbnB1dC5yZXBsYWNlKC9bMC05XS9nLCAnJykubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1OdW1iZXJzID49IHByb3BlcnR5VmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG5cclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59O1xyXG5cclxuUGFzc3dvcmRSZXF1aXJlbWVudHNWYWxpZGF0b3IuQ09ORklHX1BST1BFUlRJRVMgPSBbXHJcbiAgICAnbWluTGVuZ3RoJywgICAgICAgIC8vIG1pbmltdW0gbGVuZ3RoIG9mIHBhc3N3b3JkXHJcbiAgICAnbWF4TGVuZ3RoJywgICAgICAgIC8vIG1heGltdW0gbGVuZ3RoIG9mIHBhc3N3b3JkICh1bmRlZmluZWQgZm9yIG5vIG1heGltdW0gbGVuZ3RoKVxyXG4gICAgJ2xvd2VyY2FzZUNoYXJzJywgICAvLyBudW1iZXIgb2YgbWFuZGF0b3J5IGxvd2VyY2FzZSBjaGFyYWN0ZXJzXHJcbiAgICAndXBwZXJjYXNlQ2hhcnMnLCAgIC8vIG51bWJlciBvZiBtYW5kYXRvcnkgdXBwZXJjYXNlIGNoYXJhY3RlcnNcclxuICAgICdzcGVjaWFsQ2hhcnMnLCAgICAgLy8gbnVtYmVyIG9mIG1hbmRhdG9yeSBzcGVjaWFsIGNoYXJhY3RlcnNcclxuICAgICdudW1lcmljQ2hhcnMnICAgICAgIC8vIG51bWJlciBvZiBtYW5kYXRvcnkgbnVtYmVyIGNoYXJhY3RlcnNcclxuXTtcclxuXHJcbmlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykge1xyXG4gICAgbW9kdWxlLmV4cG9ydHMuUXVlc3Rpb24gPSBRdWVzdGlvbjtcclxuICAgIG1vZHVsZS5leHBvcnRzLlF1aXogPSBRdWl6O1xyXG4gICAgbW9kdWxlLmV4cG9ydHMuUGFzc3dvcmRSZXF1aXJlbWVudHNWYWxpZGF0b3IgPSBQYXNzd29yZFJlcXVpcmVtZW50c1ZhbGlkYXRvcjtcclxufVxuYW5ndWxhci5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb25maWcoW1wiJGxvY2F0aW9uUHJvdmlkZXJcIiwgXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlciwgJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgIC8vIGVuYWJsZSBIVE1MNSBwdXNoc3RhdGVcclxuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblxyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9ob21lJyk7XHJcblxyXG4gICAgICAgIHZhciBhdXRob3JpemUgPSBmdW5jdGlvbihBdXRoU3J2LCBMb2dTcnYsICRxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBBdXRoU3J2LmdldFVzZXIoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odXNlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB1c2VyO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVqZWN0KCdOb3QgYXV0aG9yaXplZCcpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICBhdXRob3JpemUuJGluamVjdCA9IFtcIkF1dGhTcnZcIiwgXCJMb2dTcnZcIiwgXCIkcVwiXTtcclxuXHJcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcclxuICAgICAgICAgICAgLnN0YXRlKCdob21lJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2hvbWUnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvaG9tZS5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgncXVpeicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9xdWl6JyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL3F1aXoucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb3VudHJpZXMnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2NvdW50cmllcy5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2NvdW50cmllcy5kZXRhaWwnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvOmFscGhhM0NvZGUnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvY291bnRyaWVzLWRldGFpbC5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ2luJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2xvZ2luLnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdsb2dvdXQnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvbG9nb3V0JyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdMb2dvdXRDdHJsJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3JlZ2lzdGVyJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3JlZ2lzdGVyJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL3JlZ2lzdGVyLnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdzZXR0aW5ncycsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9zZXR0aW5ncycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9zZXR0aW5ncy5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3Bhc3N3b3JkJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3Bhc3N3b3JkJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL3Bhc3N3b3JkLWNoYW5nZS5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3Jlc2V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3Bhc3N3b3JkL3Jlc2V0Lzp0b2tlbicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9wYXNzd29yZC1yZXNldC5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnZm9yZ290Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL3Bhc3N3b3JkL2ZvcmdvdCcsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9wYXNzd29yZC1mb3Jnb3QucGFydGlhbC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2Fib3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2Fib3V0JyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2Fib3V0LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdoaWdoc2NvcmUnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvaGlnaHNjb3JlJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hpZ2hzY29yZS5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGF1dGg6IGF1dGhvcml6ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2ZhcScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9mYXEnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvZmFxLnBhcnRpYWwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBwYXJhbXM6IHtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IG51bGxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb3VudHJpZXMtZGlmZmljdWx0eScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9jb3VudHJpZXMtZGlmZmljdWx0eScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9jb3VudHJ5LWRpZmZpY3VsdHkucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdDb3VudHJpZXNDdHJsJywgW1wiJHNjb3BlXCIsIFwiQ291bnRyeVNydlwiLCBmdW5jdGlvbigkc2NvcGUsIENvdW50cnlTcnYpIHtcclxuICAgICAgICB2YXIgY291bnRyaWVzQnlMZXR0ZXIgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJ5S2V5cyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyID0gQ291bnRyeVNydi5nZXRDb3VudHJpZXNCeUxldHRlcigpO1xyXG4gICAgICAgICAgICBjb3VudHJ5S2V5cyA9IE9iamVjdC5rZXlzKGNvdW50cmllc0J5TGV0dGVyKS5zb3J0KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoISRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5S2V5cyA9IGNvdW50cnlLZXlzO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJpZXNCeUxldHRlciA9IGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeUtleXMgPSBjb3VudHJ5S2V5cztcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJpZXNCeUxldHRlciA9IGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKENvdW50cnlTcnYuYXJlQ291bnRyaWVzTG9hZGVkKCkpIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignY291bnRyaWVzLmxvYWRlZCcsIGZ1bmN0aW9uKCkgIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0NvdW50cnlEZXRhaWxDdHJsJywgW1wiJHNjb3BlXCIsIFwiQ291bnRyeVNydlwiLCBcIiRzdGF0ZVBhcmFtc1wiLCBmdW5jdGlvbigkc2NvcGUsIENvdW50cnlTcnYsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgICAgIHZhciBhbHBoYTNDb2RlID0gJHN0YXRlUGFyYW1zLmFscGhhM0NvZGU7XHJcblxyXG4gICAgICAgIGlmIChDb3VudHJ5U3J2LmFyZUNvdW50cmllc0xvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzQ29kZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjb3VudHJpZXMubG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeSA9IENvdW50cnlTcnYuZ2V0Q291bnRyeUJ5QWxwaGEzKGFscGhhM0NvZGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyeUZyb21TZXJ2aWNlID0gZnVuY3Rpb24oYWxwaGEzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb3VudHJ5U3J2LmdldENvdW50cnlCeUFscGhhMyhhbHBoYTMpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRDb3VudHJ5RnJvbVNlcnZpY2UgPSBnZXRDb3VudHJ5RnJvbVNlcnZpY2U7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignQ291bnRyeURpZmZpY3VsdHlDdHJsJywgW1wiJHNjb3BlXCIsIFwiQ291bnRyeVNydlwiLCBmdW5jdGlvbigkc2NvcGUsIENvdW50cnlTcnYpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY291bnRyaWVzID0gQ291bnRyeVNydi5nZXRDb3VudHJpZXMoKTtcclxuICAgICAgICAgICAgdmFyIGRpZmZpY3VsdGllcyA9IHtcclxuICAgICAgICAgICAgICAgICdlYXN5JzogW10sXHJcbiAgICAgICAgICAgICAgICAnbWVkaXVtJzogW10sXHJcbiAgICAgICAgICAgICAgICAnaGFyZCc6IFtdLFxyXG4gICAgICAgICAgICAgICAgJ3VuYXNzaWduZWQnOiBbXVxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIGRpZmZpY3VsdHlcclxuICAgICAgICAgICAgY291bnRyaWVzLnNvcnQoZnVuY3Rpb24oYSwgYikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGIucG9wdWxhdGlvbiAtIGEucG9wdWxhdGlvbjtcclxuICAgICAgICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbihjKSB7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgIGRpZmZpY3VsdGllc1tjLmRpZmZpY3VsdHldLnB1c2goYyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0aWVzID0gZGlmZmljdWx0aWVzO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRpZmZpY3VsdHlLZXlzID0gT2JqZWN0LmtleXMoZGlmZmljdWx0aWVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRpZmZpY3VsdGllcyA9IGRpZmZpY3VsdGllcztcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZGlmZmljdWx0eUtleXMgPSBPYmplY3Qua2V5cyhkaWZmaWN1bHRpZXMpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoQ291bnRyeVNydi5hcmVDb3VudHJpZXNMb2FkZWQoKSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjb3VudHJpZXMubG9hZGVkJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0Ryb3Bkb3duQ3RybCcsIFtcIiRzY29wZVwiLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdmlzaWJsZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAkc2NvcGUudG9nZ2xlRHJvcGRvd24gPSB0b2dnbGVEcm9wZG93bjtcclxuICAgICAgICAkc2NvcGUuc2hvd0Ryb3Bkb3duID0gc2hvd0Ryb3Bkb3duO1xyXG4gICAgICAgICRzY29wZS5oaWRlRHJvcGRvd24gPSBoaWRlRHJvcGRvd247XHJcbiAgICAgICAgJHNjb3BlLmlzRHJvcGRvd25WaXNpYmxlID0gaXNEcm9wZG93blZpc2libGU7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NsaWNrLm91dHNpZGUnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoaXNEcm9wZG93blZpc2libGUoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZURyb3Bkb3duKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVEcm9wZG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZURyb3Bkb3duKCkge1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gIXZpc2libGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzaG93RHJvcGRvd24oKSB7XHJcbiAgICAgICAgICAgIHZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaGlkZURyb3Bkb3duKCkge1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpc0Ryb3Bkb3duVmlzaWJsZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2libGU7XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0ZhcUN0cmwnLCBbXCIkc2NvcGVcIiwgXCJMb2dTcnZcIiwgXCIkc3RhdGVQYXJhbXNcIiwgZnVuY3Rpb24oJHNjb3BlLCBMb2dTcnYsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gY2hlY2sgc3RhdGUgcGFyYW1zXHJcbiAgICAgICAgaWYgKCRzdGF0ZVBhcmFtcy5hY3Rpb24pIHtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9ICRzdGF0ZVBhcmFtcy5hY3Rpb247XHJcblxyXG4gICAgICAgICAgICBzd2l0Y2ggKGFjdGlvbikge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAncmVnaXN0ZXIuc3VjY2Vzc2Z1bCc6XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0dyYXR1bGF0aW9uISBEaWUgQW5tZWxkdW5nIHdhciBlcmZvbGdyZWljaC4gSGVyemxpY2ggd2lsbGtvbW1lbiBiZWkgTWFnZWxsYW4uJ1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0ZvcmdvdEN0cmwnLCBbXCIkc2NvcGVcIiwgXCJVc2VyU3J2XCIsIFwiTG9nU3J2XCIsIFwiRm9jdXNTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2LCBMb2dTcnYsIEZvY3VzU3J2KSB7XHJcbiAgICAgICAgJHNjb3BlLnBhc3NPYmogPSB7fTtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHt9O1xyXG5cclxuICAgICAgICB2YXIgZm9yZ290UGFzc3dvcmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUucGFzc09iai5lbWFpbCkge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnQWxsZSBGZWxkZXIgbcO8c3NlbiBhdXNnZWbDvGxsdCBzZWluJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFVzZXJTcnYuZm9yZ290UGFzc3dvcmQoe1xyXG4gICAgICAgICAgICAgICAgZW1haWw6ICRzY29wZS5wYXNzT2JqLmVtYWlsXHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHZhbGlkaXR5ID0gZGF0YS52YWxpZDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgdmFsaWRUZXh0ID0gdmFsaWRpdHkgIT09IHVuZGVmaW5lZCA/IFwiIERlciBMaW5rIGlzdCBcIiArIHZhbGlkaXR5ICsgXCIgU3R1bmRlbiBsYW5nIGfDvGx0aWcuXCIgOiBcIlwiO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ3N1Y2Nlc3MnLCAnRGFzIEUtTWFpbCB3dXJkZSBlcmZvbGdyZWljaCB2ZXJzYW5kdC4nICsgdmFsaWRUZXh0KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyLm1lc3NhZ2UgPT09IFwiTm8gdXNlciB3aXRoIHRoaXMgZS1tYWlsIGFkZHJlc3MgZm91bmRcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0VzIHd1cmRlIGtlaW4gQmVudXR6ZXIgbWl0IGRpZXNlciBFLU1haWwtQWRyZXNzZSBnZWZ1bmRlbicpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdCZWltIFZlcnNlbmRlbiBkZXMgTGlua3MgaXN0IGV0d2FzIHNjaGllZmdlZ2FuZ2VuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWxlZ2F0ZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBmb3Jnb3RQYXNzd29yZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzZXRNZXNzYWdlID0gZnVuY3Rpb24odHlwZSwgdGV4dCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEZvY3VzU3J2KCcjZW1haWwnKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmZvcmdvdFBhc3N3b3JkID0gZm9yZ290UGFzc3dvcmQ7XHJcbiAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignSGlnaHNjb3JlQ3RybCcsIFtcIiRzY29wZVwiLCBcIlNjb3JlU3J2XCIsIFwiTG9nU3J2XCIsIGZ1bmN0aW9uKCRzY29wZSwgU2NvcmVTcnYsIExvZ1Nydikge1xyXG4gICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBbXTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmlzRGF0YUxvYWRpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICBTY29yZVNydi5nZXRIaWdoc2NvcmVMaXN0KClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24obGlzdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnNjb3JlTGlzdCA9IGNyZWF0ZVJhbmtpbmcobGlzdCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBjcmVhdGVSYW5raW5nKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNldExvYWRpbmdTdGF0ZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldExvYWRpbmdTdGF0ZShmYWxzZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgc2V0TG9hZGluZ1N0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuaXNEYXRhTG9hZGluZyA9IHN0YXRlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNEYXRhTG9hZGluZyA9IHN0YXRlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaXNNeXNlbGYgPSBmdW5jdGlvbihpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjb3BlLnVzZXIuX2lkID09PSBpZDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlUmFua2luZyA9IGZ1bmN0aW9uKGxpc3QpIHtcclxuICAgICAgICAgICAgdmFyIHJhbmsgPSAwO1xyXG5cclxuICAgICAgICAgICAgdmFyIHByZXZpb3VzU2NvcmUgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgbGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGVudHJ5KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZXZpb3VzU2NvcmUgfHwgZW50cnkuc2NvcmUgIT09IHByZXZpb3VzU2NvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICByYW5rKys7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGVudHJ5LnJhbmsgPSByYW5rICsgJy4nO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHByZXZpb3VzU2NvcmUgPSBlbnRyeS5zY29yZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbGlzdDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUuaXNNeXNlbGYgPSBpc015c2VsZjtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBbXCIkc2NvcGVcIiwgXCJVc2VyU3J2XCIsIFwiRm9jdXNTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2LCBGb2N1c1Nydikge1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIFVzZXJTcnYubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluZm9ybSBhcHBsaWNhdGlvbiBjb250cm9sIGFib3V0IGxvZ2luIGV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdhcHAubG9naW4nLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZVRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRmFsc2NoZXIgQmVudXR6ZXJuYW1lIG9kZXIgUGFzc3dvcnQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0JlaW0gRWlubG9nZ2VuIHNjaGVpbnQgZXR3YXMgc2NoaWVmIGdlZ2FuZ2VuIHp1IHNlaW4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGZvY3VzIHVzZXJuYW1lIGZpZWxkXHJcbiAgICAgICAgRm9jdXNTcnYoJyN1c2VybmFtZScpO1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ291dEN0cmwnLCBbXCIkc2NvcGVcIiwgXCJVc2VyU3J2XCIsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclNydikge1xyXG4gICAgICAgIFVzZXJTcnYubG9nb3V0KClcclxuICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwbGljYXRpb24gY29udHJvbCBhYm91dCBsb2dvdXQgZXZlbnRcclxuICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ291dCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdNYXBDdHJsJywgW1wiJHNjb3BlXCIsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG5cclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdQYXNzd29yZEN0cmwnLCBbXCIkc2NvcGVcIiwgXCJVc2VyU3J2XCIsIFwiTG9nU3J2XCIsIFwiRm9jdXNTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2LCBMb2dTcnYsIEZvY3VzU3J2KSB7XHJcbiAgICAgICAgJHNjb3BlLnBhc3NPYmogPSB7fTtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHt9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlUGFzc3dvcmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUucGFzc09iai5vbGQgfHwgISRzY29wZS5wYXNzT2JqLm5ldyB8fCAhJHNjb3BlLnBhc3NPYmouY29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdBbGxlIEZlbGRlciBtw7xzc2VuIGF1c2dlZsO8bGx0IHNlaW4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFzc09iai5uZXcgIT09ICRzY29wZS5wYXNzT2JqLmNvbmZpcm1hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnRGllIFBhc3N3w7ZydGVyIHN0aW1tZW4gbmljaHQgw7xiZXJlaW4nKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFVzZXJTcnYudXBkYXRlUGFzc3dvcmQoe1xyXG4gICAgICAgICAgICAgICAgb2xkOiAkc2NvcGUucGFzc09iai5vbGQsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogJHNjb3BlLnBhc3NPYmoubmV3XHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnc3VjY2VzcycsICdEYXMgbmV1ZSBQYXNzd29ydCB3dXJkZSBlcmZvbGdyZWljaCBnZXNwZWljaGVydCcpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgIGlmIChlcnIubWVzc2FnZSA9PT0gXCJPbGQgcGFzc3dvcmQgaW5jb3JyZWN0XCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdEYXMgYWx0ZSBQYXNzd29ydCBpc3QgbmljaHQga29ycmVrdCcpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdEYXMgbmV1ZSBQYXNzd29ydCBrb25udGUgbmljaHQgZ2VzcGVpY2hlcnQgd2VyZGVuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWxlZ2F0ZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB1cGRhdGVQYXNzd29yZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzZXRNZXNzYWdlID0gZnVuY3Rpb24odHlwZSwgdGV4dCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEZvY3VzU3J2KCcjcGFzc3dvcmQtY3VycmVudCcpO1xyXG5cclxuICAgICAgICAkc2NvcGUudXBkYXRlUGFzc3dvcmQgPSB1cGRhdGVQYXNzd29yZDtcclxuICAgICAgICAkc2NvcGUuZGVsZWdhdGVTdWJtaXQgPSBkZWxlZ2F0ZVN1Ym1pdDtcclxuICAgIH1dKTtcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUXVpekRpcmVjdGl2ZUNvbnRyb2xsZXInLCBbXCIkc2NvcGVcIiwgXCJRdWl6U3J2XCIsIFwiTG9nU3J2XCIsIFwiRm9jdXNTcnZcIiwgXCJuZ1Byb2dyZXNzRmFjdG9yeVwiLCBcIiRmaWx0ZXJcIiwgZnVuY3Rpb24oJHNjb3BlLCBRdWl6U3J2LCBMb2dTcnYsIEZvY3VzU3J2LCBuZ1Byb2dyZXNzRmFjdG9yeSwgJGZpbHRlcikge1xyXG4gICAgICAgIHZhciBxdWVzdGlvbjtcclxuXHJcbiAgICAgICAgdmFyIGluaXRDdHJsID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIFByb2dyZXNzIGJhciBpbml0aWFsaXphdGlvblxyXG4gICAgICAgICAgICAkc2NvcGUucHJvZ3Jlc3NiYXIgPSBuZ1Byb2dyZXNzRmFjdG9yeS5jcmVhdGVJbnN0YW5jZSgpO1xyXG4gICAgICAgICAgICAkc2NvcGUucHJvZ3Jlc3NiYXIuc2V0UGFyZW50KGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdxdWl6LXByb2dyZXNzJykpO1xyXG4gICAgICAgICAgICAkc2NvcGUucHJvZ3Jlc3NiYXIuc2V0QWJzb2x1dGUoKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldENvbG9yKFwiIzMzNmU3YlwiKTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5pc1Jlc3VsdHNQYWdlVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuYWNoaWV2ZW1lbnRzID0gW107XHJcbiAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0ID0ge307XHJcbiAgICAgICAgICAgICRzY29wZS5oaW50ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIC8vIGFkZCBvcHRpb25zIGZvciBtdWx0aXBsaWVyIHNlbGVjdGlvblxyXG4gICAgICAgICAgICAkc2NvcGUubXVsdGlwbGllck9wdGlvbnMgPSBbXHJcbiAgICAgICAgICAgICAgICB7IHZhbHVlOiAxLCBsYWJlbDogJycgfSxcclxuICAgICAgICAgICAgICAgIHsgdmFsdWU6IDEwMDAsIGxhYmVsOiAnVHNkLid9LFxyXG4gICAgICAgICAgICAgICAgeyB2YWx1ZTogMTAwMDAwMCwgbGFiZWw6ICdNaW8uJ31cclxuICAgICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gbnVsbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlVWkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gZ2V0IGN1cnJlbnQgcXVlc3Rpb24gZnJvbSBxdWl6IHNlcnZpY2VcclxuICAgICAgICAgICAgcXVlc3Rpb24gPSBRdWl6U3J2LmdldEN1cnJlbnRRdWVzdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgLy8gZGVsZXRlIHByZXZpb3VzIGhpbnRzXHJcbiAgICAgICAgICAgICRzY29wZS5oaW50ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGlmIChxdWVzdGlvbiAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbXVsdGlwbGllcnMgZm9yIHF1ZXN0aW9ucyBjb250YWluaW5nIG51bWJlcnNcclxuICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvbi5nZXRJbmZvKCkuaW5wdXQgJiYgcXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0LmluZGV4T2YoJ251bWJlcicpID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChxdWVzdGlvbi5nZXRJbmZvKCkuaW5wdXQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbnVtYmVyLmhpZ2gnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSB7IHZhbHVlOiAxMDAwMDAwLCBsYWJlbDogJ01pby4nfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbnVtYmVyLm1lZGl1bSc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYW5zd2VySW5wdXQubXVsdGlwbGllciA9IHsgdmFsdWU6IDEwMDAsIGxhYmVsOiAnVHNkLid9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSB7IHZhbHVlOiAxLCBsYWJlbDogJycgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBwcm9ncmVzcyBiYXJcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVByb2dyZXNzQmFyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gZm9jdXMgYW5zd2VyIGlucHV0XHJcbiAgICAgICAgICAgICAgICBGb2N1c1NydignLmFuc3dlcklucHV0Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldE51bWJlck9mUXVpelF1ZXN0aW9ucyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5nZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVuZGVyUXVlc3Rpb25UZXh0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZW5kZXIoZ2V0UXVlc3Rpb24oKS5xdWVzdGlvbigpLCAncXVlc3Rpb24taGlnaGxpZ2h0JykgKyAnPyc7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uTWVkaWEgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFxdWVzdGlvbiB8fCAhcXVlc3Rpb24uZ2V0SW5mbygpLm1lZGlhKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uZ2V0SW5mbygpLm1lZGlhO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzaG93UmVzdWx0c1BhZ2UgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmlzUmVzdWx0c1BhZ2VWaXNpYmxlID0gdHJ1ZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGlkZVJlc3VsdHNQYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzUmVzdWx0c1BhZ2VWaXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5pc1Jlc3VsdHNQYWdlVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGludHNBdmFpbGFibGUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHF1ZXN0aW9uID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChxdWVzdGlvbi5oaW50c1JlbWFpbmluZygpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWVzdGlvbi5oaW50c1JlbWFpbmluZygpID4gMDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc3VibWl0QW5zd2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuYW5zd2VySW5wdXQuYW5zd2VyICYmICFxdWVzdGlvbi5hbnN3ZXJlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gc3VibWl0dGVkIGFuc3dlciB0byBTdHJpbmcgYW5kIHRyaW0gYW55IHdoaXRlc3BhY2VzIGF0IHRoZSBiZWdpbiBvciBlbmQgb2YgdGhlIGFuc3dlclxyXG4gICAgICAgICAgICAgICAgdmFyIGFuc3dlciA9IFN0cmluZygkc2NvcGUuYW5zd2VySW5wdXQuYW5zd2VyKS50cmltKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gaWYgaXQgaXMgYSBudW1iZXIgaW5wdXQsIHJlcGxhY2UgJywnIHdpdGggJy4nXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlciA9IGFuc3dlci5yZXBsYWNlKCcsJywgJy4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBpZiBhIG11bHRpcGxpZXIgaXMgYXZhaWxhYmxlLCBjYWxjdWxhdGUgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXIgKj0gJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIudmFsdWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0LnBvaW50cyA9IHF1ZXN0aW9uLmFuc3dlcihhbnN3ZXIpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIHNldCBmb2N1c1xyXG4gICAgICAgICAgICAgICAgaWYgKCF3YXNMYXN0UXVlc3Rpb24oKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIEZvY3VzU3J2KCcjYnRuTmV4dFF1ZXN0aW9uJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIEZvY3VzU3J2KCcjYnRuQ29udGludWVGaW5pc2hlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHF1ZXN0aW9uQW5zd2VyZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFRdWl6U3J2LmlzUXVpelJ1bm5pbmcoKSB8fCBxdWVzdGlvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uYW5zd2VyZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYubmV4dFF1ZXN0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuYW5zd2VySW5wdXQuYW5zd2VyID0gXCJcIjtcclxuXHJcbiAgICAgICAgICAgIHVwZGF0ZVVpKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJlcXVlc3RIaW50ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5oaW50ID0gcXVlc3Rpb24uaGludCgpO1xyXG5cclxuICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZW5kZXIgPSBmdW5jdGlvbih0ZXh0LCBjbGFzc05hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRleHRcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiW1wiLCBcIjxzcGFuIGNsYXNzPSdcIiArIGNsYXNzTmFtZSArIFwiJz5cIilcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKFwiXVwiLCBcIjwvc3Bhbj5cIik7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhhbmRsZUtleVByZXNzID0gZnVuY3Rpb24oa2V5RXZlbnQpIHtcclxuICAgICAgICAgICAgaWYgKGtleUV2ZW50LndoaWNoID09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBzdWJtaXRBbnN3ZXIoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQcm9ncmVzc0JhciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3NQZXJjZW50ID0gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyKCkgLyBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKSAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXQocHJvZ3Jlc3NQZXJjZW50KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgd2FzTGFzdFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKSA+PSBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VFdmVudHMgPSBmdW5jdGlvbihldmVudHMsIHBlcnNvbmFsQmVzdCwgb3ZlcmFsbEJlc3QpIHtcclxuICAgICAgICAgICAgdmFyIGFjaGlldmVtZW50cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgdmFyIHNob3dCZXN0cyA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ292ZXJhbGxfYmVzdCcpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRHUgaGFzdCBlaW5lbiBuZXVlbiBhYnNvbHV0ZW4gUmVrb3JkIGdlc2NoYWZmdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdvdmVyYWxsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGRlbiBha3R1ZWxsZW4gYWJzb2x1dGVuIFJla29yZCBlaW5nZXN0ZWxsdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdwZXJzb25hbF9iZXN0JykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0JykgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBSZWtvcmQgZ2VzY2hhZmZ0ISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ3BlcnNvbmFsX2Jlc3RfZXF1YWxpc2VkJykgPj0gMCAmJiBldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0X2VxdWFsaXNlZCcpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGdsZWljaCB2aWVsZSBQdW5rdGUgZ2VzY2hhZmZ0IHdpZSBiZWkgZGVpbmVtIHBlcnPDtm5saWNoZW4gUmVrb3JkISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIHNob3dCZXN0cyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoZXZlbnRzLmluZGV4T2YoJ25ld19kYWlseV9iZXN0JykgPj0gMCAmJiBhY2hpZXZlbWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gcGVyc8O2bmxpY2hlbiBUYWdlc3Jla29yZCBnZXNjaGFmZnQhJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmFjaGlldmVtZW50cyA9IGFjaGlldmVtZW50cztcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFjaGlldmVtZW50cyA9IGFjaGlldmVtZW50cztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoc2hvd0Jlc3RzICYmIHBlcnNvbmFsQmVzdCAmJiBwZXJzb25hbEJlc3QuaWQgJiYgcGVyc29uYWxCZXN0LmRhdGUgJiYgcGVyc29uYWxCZXN0LnNjb3JlICYmIG92ZXJhbGxCZXN0ICYmIG92ZXJhbGxCZXN0LmlkICYmIG92ZXJhbGxCZXN0LmRhdGUgJiYgb3ZlcmFsbEJlc3Quc2NvcmUpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiZXN0cyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIG92ZXJhbGxCZXN0LnR5cGUgPSAnb3ZlcmFsbCc7XHJcbiAgICAgICAgICAgICAgICBiZXN0cy5wdXNoKG92ZXJhbGxCZXN0KTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocGVyc29uYWxCZXN0LmlkICE9PSBvdmVyYWxsQmVzdC5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBlcnNvbmFsQmVzdC50eXBlID0gJ3BlcnNvbmFsJztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYmVzdHMucHVzaChwZXJzb25hbEJlc3QpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IGJlc3RzO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBiZXN0cztcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5iZXN0cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY29udGludWVGaW5pc2hlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBxdWl6IGhhcyBlbmRlZCwgc2V0IHByb2dyZXNzIGJhciB0byAwXHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXQoMCk7XHJcblxyXG4gICAgICAgICAgICBzaG93UmVzdWx0c1BhZ2UoKTtcclxuXHJcbiAgICAgICAgICAgIG5leHRRdWVzdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgLy8gY29uY2x1ZGUgdGhlIHF1aXogYW5kIHdyaXRlIHJlc3VsdCB0byBkYXRhYmFzZVxyXG4gICAgICAgICAgICBRdWl6U3J2LmNvbmNsdWRlKClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZUV2ZW50cyhkYXRhLmV2ZW50cyB8fCBbXSwgZGF0YS5wZXJzb25hbEJlc3QsIGRhdGEub3ZlcmFsbEJlc3QpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRCZXN0VGV4dCA9IGZ1bmN0aW9uKGJlc3QpIHtcclxuICAgICAgICAgICAgdmFyIHRleHQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoYmVzdC50eXBlID09PSAncGVyc29uYWwnKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBwZXJzb25hbCBiZXN0XHJcbiAgICAgICAgICAgICAgICB0ZXh0ID0gXCJEZWluIHBlcnPDtm5saWNoZXIgUmVrb3JkIGxpZWd0IGJlaSA8c3BhbiBjbGFzcz0nYm9sZCc+e1BPSU5UU30gUHVua3Rlbjwvc3Bhbj4sIGF1Zmdlc3RlbGx0IGFtIHtEQVRFfS5cIjtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vIG92ZXJhbGwgYmVzdFxyXG4gICAgICAgICAgICAgICAgdmFyIGZyb21NeXNlbGYgPSBiZXN0LmlkID09PSAkc2NvcGUudXNlci5faWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGZyb21NeXNlbGYpIHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gXCJEdSBow6RsdHN0IGRlbiBhYnNvbHV0ZW4gUmVrb3JkIG1pdCA8c3BhbiBjbGFzcz0nYm9sZCc+e1BPSU5UU30gUHVua3Rlbjwvc3Bhbj4sIGF1Zmdlc3RlbGx0IGFtIHtEQVRFfS5cIjtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiPHNwYW4gY2xhc3M9J2hpZ2hsaWdodCc+e1VTRVJOQU1FfTwvc3Bhbj4gaMOkbHQgZGVuIGFic29sdXRlbiBSZWtvcmQgbWl0IDxzcGFuIGNsYXNzPSdib2xkJz57UE9JTlRTfSBQdW5rdGVuPC9zcGFuPiwgYXVmZ2VzdGVsbHQgYW0ge0RBVEV9LlwiO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKCd7UE9JTlRTfScsICRmaWx0ZXIoJ251bWJlcicpKGJlc3Quc2NvcmUpKVxyXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJ3tEQVRFfScsIGdldEZvcm1hdHRlZERhdGUoYmVzdC5kYXRlKSlcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKCd7VVNFUk5BTUV9JywgYmVzdC51c2VybmFtZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEZvcm1hdHRlZERhdGUgPSBmdW5jdGlvbihkYXRlKSB7XHJcbiAgICAgICAgICAgIGRhdGUgPSBuZXcgRGF0ZShkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwYWQoZGF0ZS5nZXREYXRlKCksICcwMCcpICsgJy4nICsgcGFkKGRhdGUuZ2V0TW9udGgoKSArIDEsICcwMCcpICsgJy4nICsgKGRhdGUuZ2V0WWVhcigpICsgMTkwMCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHBhZCA9IGZ1bmN0aW9uKHN0ciwgcGFkVmFsdWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFN0cmluZyhwYWRWYWx1ZSArIHN0cikuc2xpY2UoLXBhZFZhbHVlLmxlbmd0aCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJlc3RhcnRRdWl6ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHF1aXogPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdxdWl6LnJlc3RhcnQnKTtcclxuXHJcbiAgICAgICAgICAgIGluaXRDdHJsKCk7XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVVaSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBlbnRlckxpc3RlbmVyID0gZnVuY3Rpb24oa2V5UHJlc3MsIGZ1bmMpIHtcclxuICAgICAgICAgICAgaWYgKGtleVByZXNzLndoaWNoID09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGZ1bmMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICduZXh0X3F1ZXN0aW9uJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmV4dFF1ZXN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdjb250aW51ZV9maW5pc2hlZCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlRmluaXNoZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigncXVpei5zdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGhpZGVSZXN1bHRzUGFnZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIC8vIGNvbnRyb2xsZXIgaXMgYmVpbmcgZGVzdHJveWVkIChpLmUuIHVzZXIgbGVhdmVzIHRoZSBwYWdlLCBzbyB3ZSB0ZWxsIHRoZSBxdWl6IHNlcnZpY2UgdG8gZGlzcG9zZSBvZiB0aGUgcXVpeiBvYmplY3RcclxuICAgICAgICAgICAgaWYgKFF1aXpTcnYuaGFzUXVpelN0YXJ0ZWQoKSAmJiBRdWl6U3J2Lmhhc1F1aXpFbmRlZCgpKSB7XHJcbiAgICAgICAgICAgICAgICBRdWl6U3J2LmRpc3Bvc2UoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBpbml0IGNvbnRyb2xsZXJcclxuICAgICAgICBpbml0Q3RybCgpO1xyXG5cclxuICAgICAgICAvLyBpbml0aWFsbHkgdXBkYXRlIFVJXHJcbiAgICAgICAgdXBkYXRlVWkoKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmdldFF1ZXN0aW9uID0gZ2V0UXVlc3Rpb247XHJcbiAgICAgICAgJHNjb3BlLmdldEN1cnJlbnRRdWVzdGlvbk51bWJlciA9IGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcjtcclxuICAgICAgICAkc2NvcGUucmVuZGVyUXVlc3Rpb25UZXh0ID0gcmVuZGVyUXVlc3Rpb25UZXh0O1xyXG4gICAgICAgICRzY29wZS5zdWJtaXRBbnN3ZXIgPSBzdWJtaXRBbnN3ZXI7XHJcbiAgICAgICAgJHNjb3BlLnF1ZXN0aW9uQW5zd2VyZWQgPSBxdWVzdGlvbkFuc3dlcmVkO1xyXG4gICAgICAgICRzY29wZS5uZXh0UXVlc3Rpb24gPSBuZXh0UXVlc3Rpb247XHJcbiAgICAgICAgJHNjb3BlLmhhbmRsZUtleVByZXNzID0gaGFuZGxlS2V5UHJlc3M7XHJcbiAgICAgICAgJHNjb3BlLmdldFF1ZXN0aW9uTWVkaWEgPSBnZXRRdWVzdGlvbk1lZGlhO1xyXG4gICAgICAgICRzY29wZS5yZXF1ZXN0SGludCA9IHJlcXVlc3RIaW50O1xyXG4gICAgICAgICRzY29wZS53YXNMYXN0UXVlc3Rpb24gPSB3YXNMYXN0UXVlc3Rpb247XHJcbiAgICAgICAgJHNjb3BlLmNvbnRpbnVlRmluaXNoZWQgPSBjb250aW51ZUZpbmlzaGVkO1xyXG4gICAgICAgICRzY29wZS5nZXRCZXN0VGV4dCA9IGdldEJlc3RUZXh0O1xyXG4gICAgICAgICRzY29wZS5yZXN0YXJ0UXVpeiA9IHJlc3RhcnRRdWl6O1xyXG4gICAgICAgICRzY29wZS5oaW50c0F2YWlsYWJsZSA9IGhpbnRzQXZhaWxhYmxlO1xyXG4gICAgICAgICRzY29wZS5lbnRlckxpc3RlbmVyID0gZW50ZXJMaXN0ZW5lcjtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdRdWl6Q3RybCcsIFtcIiRzY29wZVwiLCBcIlF1aXpTcnZcIiwgXCJMb2dTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCBRdWl6U3J2LCBMb2dTcnYpIHtcclxuXHJcbiAgICAgICAgdmFyIHN0YXJ0UXVpeiA9IGZ1bmN0aW9uKGNiKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYuaW5pdCgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY2IgJiYgdHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNiKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBpc1F1aXpSdW5uaW5nID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmlzUXVpelJ1bm5pbmcoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpelN0YXJ0ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuaGFzUXVpelN0YXJ0ZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpekVuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2Lmhhc1F1aXpFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRUb3RhbFBvaW50cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5nZXRUb3RhbFBvaW50cygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3F1aXoucmVzdGFydCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIFF1aXpTcnYuZGlzcG9zZSgpO1xyXG5cclxuICAgICAgICAgICAgc3RhcnRRdWl6KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRicm9hZGNhc3QoJ3F1aXouc3RhcnQnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICRzY29wZS5zdGFydFF1aXogPSBzdGFydFF1aXo7XHJcbiAgICAgICAgJHNjb3BlLmlzUXVpelJ1bm5pbmcgPSBpc1F1aXpSdW5uaW5nO1xyXG4gICAgICAgICRzY29wZS5oYXNRdWl6U3RhcnRlZCA9IGhhc1F1aXpTdGFydGVkO1xyXG4gICAgICAgICRzY29wZS5oYXNRdWl6RW5kZWQgPSBoYXNRdWl6RW5kZWQ7XHJcbiAgICAgICAgJHNjb3BlLmdldFRvdGFsUG9pbnRzID0gZ2V0VG90YWxQb2ludHM7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJywgW1wiJHNjb3BlXCIsIFwiTG9nU3J2XCIsIFwiRm9jdXNTcnZcIiwgXCJVc2VyU3J2XCIsIFwiJHN0YXRlXCIsIFwiJHdpbmRvd1wiLCBmdW5jdGlvbigkc2NvcGUsIExvZ1NydiwgRm9jdXNTcnYsIFVzZXJTcnYsICRzdGF0ZSwgJHdpbmRvdykge1xyXG4gICAgICAgIC8vIG5ldyB1c2VyIG9iamVjdFxyXG4gICAgICAgICRzY29wZS5uZXdVc2VyID0ge307XHJcblxyXG4gICAgICAgIC8vIG1lc3NhZ2Ugb2JqZWN0XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbiAoaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHZhbGlkYXRlQmVmb3JlU3VibWl0KCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBlcmZvcm0gYXBpIGNhbGxcclxuICAgICAgICAgICAgICAgIFVzZXJTcnYucmVnaXN0ZXIoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwIGNvbnRyb2xsZXIgYWJvdXQgbG9naW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ2luJywgcmVzcG9uc2UuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gaG9tZSBwYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2ZhcScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdyZWdpc3Rlci5zdWNjZXNzZnVsJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdCZWkgZGVyIEFubWVsZHVuZyBzY2hlaW50IGV0d2FzIHNjaGllZiBnZWdhbmdlbiB6dSBzZWluJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlcnIubWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnVXNlcm5hbWUgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RlciBCZW51dHplcm5hbWUgaXN0IGJlcmVpdHMgaW4gVmVyd2VuZHVuZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnRW1haWwgYWRkcmVzcyBhbHJlYWR5IGV4aXN0cyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGllIEUtTWFpbC1BZHJlc3NlIGlzdCBiZXJlaXRzIGluIFZlcndlbmR1bmcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1Bhc3N3b3JkIGRvZXMgbm90IG1hdGNoIHJlcXVpcmVtZW50cyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGFzIFBhc3N3b3J0IGVudHNwcmljaHQgbmljaHQgZGVuIFNpY2hlcmhlaXRzcmljaHRsaW5pZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnQmVpIGRlciBBbm1lbGR1bmcgc2NoZWludCBldHdhcyBzY2hpZWYgZ2VnYW5nZW4genUgc2Vpbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHZhbGlkYXRlQmVmb3JlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSB0d28gcGFzc3dvcmRzIG1hdGNoXHJcbiAgICAgICAgICAgIHZhciBwYXNzd29yZCA9ICRzY29wZS5uZXdVc2VyLnBhc3N3b3JkO1xyXG4gICAgICAgICAgICB2YXIgcGFzc3dvcmQyID0gJHNjb3BlLm5ld1VzZXIucGFzc3dvcmQyO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUubmV3VXNlci51c2VybmFtZSB8fCAhJHNjb3BlLm5ld1VzZXIuZW1haWwgfHwgIXBhc3N3b3JkIHx8ICFwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbidcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFzc3dvcmQgPT09IFwiXCIgfHwgcGFzc3dvcmQyID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEaWUgUGFzc3fDtnJ0ZXIga8O2bm5lbiBuaWNodCBsZWVyIHNlaW4nXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhc3N3b3JkICE9PSBwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0RpZSBQYXNzd8O2cnRlciBzdGltbWVuIG5pY2h0IMO8YmVyZWluJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuICEkc2NvcGUubWVzc2FnZSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVsZWdhdGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmVnaXN0ZXIodHJ1ZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IHJlZ2lzdGVyO1xyXG5cclxuICAgICAgICAvLyBmb2N1cyB1c2VyIG5hbWUgZmllbGRcclxuICAgICAgICBGb2N1c1NydignI3VzZXJuYW1lJyk7XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUmVzZXRDdHJsJywgW1wiJHNjb3BlXCIsIFwiVXNlclNydlwiLCBcIkxvZ1NydlwiLCBcIkZvY3VzU3J2XCIsIFwiJHN0YXRlUGFyYW1zXCIsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclNydiwgTG9nU3J2LCBGb2N1c1NydiwgJHN0YXRlUGFyYW1zKSB7XHJcbiAgICAgICAgJHNjb3BlLnBhc3NPYmogPSB7fTtcclxuICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHt9O1xyXG5cclxuICAgICAgICB2YXIgdG9rZW4gPSAkc3RhdGVQYXJhbXMudG9rZW47XHJcblxyXG4gICAgICAgIHZhciByZXNldFBhc3N3b3JkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLnBhc3NPYmoubmV3IHx8ICEkc2NvcGUucGFzc09iai5jb25maXJtYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnBhc3NPYmoubmV3ICE9PSAkc2NvcGUucGFzc09iai5jb25maXJtYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0RpZSBQYXNzd8O2cnRlciBzdGltbWVuIG5pY2h0IMO8YmVyZWluJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0tlaW4gZ8O8bHRpZ2VyIFp1csO8Y2tzZXR6ZW4tTGluaycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBVc2VyU3J2LnJlc2V0UGFzc3dvcmQoe1xyXG4gICAgICAgICAgICAgICAgdG9rZW46IHRva2VuLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6ICRzY29wZS5wYXNzT2JqLm5ld1xyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ3N1Y2Nlc3MnLCAnRGFzIFBhc3N3b3J0IHd1cmRlIGVyZm9sZ3JlaWNoIGdlc3BlaWNoZXJ0Jyk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVyci5tZXNzYWdlID09PSBcIkludmFsaWQgdG9rZW5cIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0RlciBadXLDvGNrc2V0emVuLUxpbmsgaXN0IGxlaWRlciBuaWNodCBtZWhyIGfDvGx0aWcnKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnRGFzIG5ldWUgUGFzc3dvcnQga29ubnRlIG5pY2h0IGdlc3BlaWNoZXJ0IHdlcmRlbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVsZWdhdGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmVzZXRQYXNzd29yZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzZXRNZXNzYWdlID0gZnVuY3Rpb24odHlwZSwgdGV4dCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIEZvY3VzU3J2KCcjcGFzc3dvcmQtbmV3Jyk7XHJcblxyXG4gICAgICAgICRzY29wZS5yZXNldFBhc3N3b3JkID0gcmVzZXRQYXNzd29yZDtcclxuICAgICAgICAkc2NvcGUuZGVsZWdhdGVTdWJtaXQgPSBkZWxlZ2F0ZVN1Ym1pdDtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdTZXR0aW5nc0N0cmwnLCBbXCIkc2NvcGVcIiwgXCJBcHBDb25maWdcIiwgXCJGb2N1c1NydlwiLCBcIkxvZ1NydlwiLCBcIlVzZXJTcnZcIiwgZnVuY3Rpb24oJHNjb3BlLCBBcHBDb25maWcsIEZvY3VzU3J2LCBMb2dTcnYsIFVzZXJTcnYpIHtcclxuICAgICAgICB2YXIgaW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyB1c2VyIGNvbG91cnNcclxuICAgICAgICAgICAgdmFyIGNvbG9ycyA9IEFwcENvbmZpZ1snc2V0dGluZ3MudXNlci5jb2xvcnMnXTtcclxuXHJcbiAgICAgICAgICAgIC8vIHVzZXIgb2JqZWN0XHJcbiAgICAgICAgICAgICRzY29wZS51c2VyT2JqID0ge1xyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6ICRzY29wZS51c2VyLnVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgZW1haWw6ICRzY29wZS51c2VyLmVtYWlsLFxyXG4gICAgICAgICAgICAgICAgY29sb3I6ICRzY29wZS51c2VyLmNvbG9yXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUudXNlckNvbG9ycyA9IGNvbG9ycztcclxuXHJcbiAgICAgICAgICAgIHZhciBzZXRDb2xvciA9IGZ1bmN0aW9uKG5ld0NvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUudXNlck9iai5jb2xvciA9IG5ld0NvbG9yO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIHVwZGF0ZVVzZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIFVzZXJTcnYudXBkYXRlQmFzaWMoJHNjb3BlLnVzZXJPYmopLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSB1c2VyIG9iamVjdFxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLnVzZXJuYW1lID0gJHNjb3BlLnVzZXJPYmoudXNlcm5hbWU7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIuZW1haWwgPSAkc2NvcGUudXNlck9iai5lbWFpbDtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlci5jb2xvciA9ICRzY29wZS51c2VyT2JqLmNvbG9yO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdFaW5zdGVsbHVuZ2VuIHd1cmRlbiBlcmZvbGdyZWljaCBnZXNwZWljaGVydCdcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcignVXBkYXRlIHVzZXInLCBlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZVRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZXJyLm1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnVXNlcm5hbWUgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGVyIEJlbnV0emVybmFtZSBpc3QgYmVyZWl0cyB2ZXJnZWJlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ0VtYWlsIGFkZHJlc3MgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGllIEUtTWFpbC1BZHJlc3NlIGlzdCBiZXJlaXRzIHZlcmdlYmVuJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RpZSBFaW5zdGVsbHVuZ2VuIGtvbm50ZW4gbmljaHQgZ2VzcGVpY2hlcnQgd2VyZGVuJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogbWVzc2FnZVRleHRcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGRlbGVnYXRlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVVc2VyKHRydWUpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLnNldENvbG9yID0gc2V0Q29sb3I7XHJcbiAgICAgICAgICAgICRzY29wZS51cGRhdGVVc2VyID0gdXBkYXRlVXNlcjtcclxuICAgICAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcblxyXG4gICAgICAgICAgICAvLyBmb2N1cyB1c2VybmFtZSBmaWVsZFxyXG4gICAgICAgICAgICBGb2N1c1NydignI3VzZXJuYW1lJyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKCRzY29wZS51c2VyKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIG90aGVyd2lzZSwgd2FpdCBmb3IgdXNlci5sb2FkZWQgZXZlbnRcclxuICAgICAgICAkc2NvcGUuJG9uKCd1c2VyLmxvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5maWx0ZXIoJ3JlbmRlckh0bWwnLCBbXCIkc2NlXCIsIGZ1bmN0aW9uKCRzY2UpIHtcclxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odGV4dCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbCh0ZXh0KTtcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZpbHRlcigndGV4dE9yTnVtYmVyJywgW1wiJGZpbHRlclwiLCBmdW5jdGlvbigkZmlsdGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBmcmFjdGlvblNpemUpIHtcclxuICAgICAgICAgICAgZnJhY3Rpb25TaXplID0gZnJhY3Rpb25TaXplICE9PSB1bmRlZmluZWQgPyAwIDogZnJhY3Rpb25TaXplO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzTmFOKGlucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRmaWx0ZXIoJ251bWJlcicpKGlucHV0LCBmcmFjdGlvblNpemUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmRpcmVjdGl2ZSgnY2xpY2tPdXRzaWRlJywgW1wiJHBhcnNlXCIsIFwiJGRvY3VtZW50XCIsIFwiJHJvb3RTY29wZVwiLCBmdW5jdGlvbigkcGFyc2UsICRkb2N1bWVudCwgJHJvb3RTY29wZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICAkZG9jdW1lbnQuYmluZCgnY2xpY2snLCBjbGlja091dHNpZGVIYW5kbGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmJpbmQoJ3JlbW92ZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRkb2N1bWVudC51bmJpbmQoJ2NsaWNrJywgY2xpY2tPdXRzaWRlSGFuZGxlcik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiBjbGlja091dHNpZGVIYW5kbGVyKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRQYXJlbnRzID0gJChldmVudC50YXJnZXQpLnBhcmVudHMoKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaW5zaWRlID0gdGFyZ2V0UGFyZW50cy5pbmRleCgkKGVsZW1lbnQpKSAhPT0gLTE7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9uID0gZXZlbnQudGFyZ2V0ID09PSBlbGVtZW50WzBdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvdXRzaWRlID0gIWluc2lkZSAmJiAhb247XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRzaWRlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnY2xpY2sub3V0c2lkZScsIGV2ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XSlcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5kaXJlY3RpdmUoJ21hcCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYnVpbGQvdmlld3MvdGVtcGxhdGVzL21hcC50ZW1wbGF0ZS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ01hcEN0cmwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG1hcCA9IG5ldyBEYXRhbWFwKHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwLWNvbnRhaW5lcicpLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGxzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHRGaWxsOiAnIzIyYTdmMCdcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGdlb2dyYXBoeUNvbmZpZzoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRPbkhvdmVyOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwb3B1cG9uSG92ZXI6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEZpbGxDb2xvcjogJyMwMTk4NzUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRCb3JkZXJDb2xvcjogJ3JnYmEoMjAwLCAyNDcsIDE5NywgMC40KSdcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZGlyZWN0aXZlKCdxdWl6JywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdidWlsZC92aWV3cy90ZW1wbGF0ZXMvcXVpei1kaXJlY3RpdmUudGVtcGxhdGUuaHRtbCcsXHJcbiAgICAgICAgICAgIHNjb3BlOiB0cnVlLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnUXVpekRpcmVjdGl2ZUNvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pXG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnQXV0aEludGVyY2VwdG9yJywgW1wiQXV0aFRva2VuU3J2XCIsIGZ1bmN0aW9uKEF1dGhUb2tlblNydikge1xyXG4gICAgICAgIHZhciBhZGRUb2tlbiA9IGZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgICAgICAgICB2YXIgdG9rZW4gPSBBdXRoVG9rZW5TcnYuZ2V0VG9rZW4oKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5oZWFkZXJzWydYLUF1dGgnXSA9IHRva2VuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY29uZmlnO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcXVlc3Q6IGFkZFRva2VuXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdBdXRoVG9rZW5TcnYnLCBbXCIkd2luZG93XCIsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSAkd2luZG93LnNlc3Npb25TdG9yYWdlO1xyXG4gICAgICAgIHZhciBrZXkgPSAnYXV0aC10b2tlbic7XHJcblxyXG4gICAgICAgIHZhciBnZXRUb2tlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RvcmUuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzZXRUb2tlbiA9IGZ1bmN0aW9uKHRva2VuKSB7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgc3RvcmUuc2V0SXRlbShrZXksIHRva2VuKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN0b3JlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFRva2VuOiBnZXRUb2tlbixcclxuICAgICAgICAgICAgc2V0VG9rZW46IHNldFRva2VuXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdBdXRoU3J2JywgW1wiVXNlclNydlwiLCBmdW5jdGlvbihVc2VyU3J2KSB7XHJcbiAgICAgICAgdmFyIHVzZXIgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodXNlciAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUodXNlcik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIFVzZXJTcnYuZ2V0VXNlckZyb21TdG9yYWdlKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oX3VzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBfdXNlcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKF91c2VyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdOb3QgbG9nZ2VkIGluJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc2V0VXNlciA9IGZ1bmN0aW9uKF91c2VyKSB7XHJcbiAgICAgICAgICAgIHVzZXIgPSBfdXNlcjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY2xlYXJVc2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHVzZXIgPSBudWxsO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHNldFVzZXI6IHNldFVzZXIsXHJcbiAgICAgICAgICAgIGdldFVzZXI6IGdldFVzZXIsXHJcbiAgICAgICAgICAgIGNsZWFyVXNlcjogY2xlYXJVc2VyXHJcbiAgICAgICAgfVxyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0NvdW50cnlTcnYnLCBbXCIkaHR0cFwiLCBcIkluZGV4ZWREQlNydlwiLCBcIkxvZ1NydlwiLCBmdW5jdGlvbigkaHR0cCwgSW5kZXhlZERCU3J2LCBMb2dTcnYpIHtcclxuICAgICAgICAvLyBDb3VudHJpZXMgYXJyYXlcclxuICAgICAgICB2YXIgY291bnRyaWVzID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGNvdW50cmllc0J5QWxwaGEzID0gbnVsbDtcclxuICAgICAgICB2YXIgY291bnRyaWVzQnlMZXR0ZXIgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBJbmRleGVkREJcclxuICAgICAgICB2YXIgZGF0YWJhc2UgPSAnbWFnZWxsYW4nO1xyXG4gICAgICAgIHZhciBzdG9yZSA9ICdjb3VudHJ5U3RvcmUnO1xyXG4gICAgICAgIHZhciBrZXlDb3VudHJpZXMgPSAnY291bnRyaWVzJztcclxuICAgICAgICB2YXIga2V5VmVyc2lvbiA9ICd2ZXJzaW9uJztcclxuXHJcbiAgICAgICAgdmFyIGluZGV4ZWREQkF2YWlsYWJsZSA9IEluZGV4ZWREQlNydi5pbmRleGVkREJBdmFpbGFibGUoKTtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGxvYWRDb3VudHJpZXMoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbG9hZENvdW50cmllcyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBjaGVjayBpZiBpbmRleGVkREIgaXMgYXZhaWxhYmxlXHJcbiAgICAgICAgICAgIGlmIChpbmRleGVkREJBdmFpbGFibGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgZGF0YWJhc2UgZXhpc3RzXHJcbiAgICAgICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LmNyZWF0ZURhdGFiYXNlKGRhdGFiYXNlLCBzdG9yZSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZ2V0RW1wdHlPYmplY3QpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGdldEludGVybmFsVmVyc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZ2V0RXh0ZXJuYWxWZXJzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihkZXRlcm1pbmVMb2FkU3RyYXRlZ3kpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGxvYWREYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllcyA9IG9ialsnY291bnRyaWVzJ107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmluZm8oXCJsb2FkZWQgY291bnRyaWVzIGZyb21cIiwgb2JqWydsb2FkU3RyYXRlZ3knXS50b1VwcGVyQ2FzZSgpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGRpdGlvbmFsbHkgbWFwIGNvdW50cmllcyBieSB2YXJpb3VzIHByb3BlcnRpZXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5QWxwaGEzID0ge307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlciA9IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllcy5mb3JFYWNoKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBieSBhbHBoYTMgY29kZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5QWxwaGEzW2NbJ2FscGhhM0NvZGUnXV0gPSBjO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBieSBsZXR0ZXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RMZXR0ZXIgPSBjWyduYW1lJ10uc3Vic3RyKDAsIDEpLnRvVXBwZXJDYXNlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZmlyc3RMZXR0ZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnw4QnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RMZXR0ZXIgPSAnQSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ8OWJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0TGV0dGVyID0gJ08nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICfDnCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdExldHRlciA9ICdVJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudHJpZXNCeUxldHRlcltmaXJzdExldHRlcl0gPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlcltmaXJzdExldHRlcl0gPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc0J5TGV0dGVyW2ZpcnN0TGV0dGVyXS5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEzQ29kZTogYy5hbHBoYTNDb2RlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBjLm5hbWVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoY291bnRyaWVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKFwiZmFpbGVkIHRvIGxvYWQgY291bnRyaWVzXCIsIGVycik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpZiBub3QsIHdlIGFsd2F5cyB0cnkgdG8gZG93bmxvYWQgaXQgZnJvbSB0aGUgY291bnRyeSBBUEkgZW5kcG9pbnRcclxuICAgICAgICAgICAgICAgIHJldHVybiBnZXRDb3VudHJpZXNGcm9tQVBJKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGV0ZXJtaW5lTG9hZFN0cmF0ZWd5ID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBzdHJhdGVneTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgaW50ZXJuYWxWZXJzaW9uID0gb2JqW1wiaW50ZXJuYWxWZXJzaW9uXCJdO1xyXG4gICAgICAgICAgICAgICAgdmFyIGV4dGVybmFsVmVyc2lvbiA9IG9ialtcImV4dGVybmFsVmVyc2lvblwiXTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaW50ZXJuYWxWZXJzaW9uID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnYXBpJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXh0ZXJuYWxWZXJzaW9uID4gaW50ZXJuYWxWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnYXBpJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc3RyYXRlZ3kgPSAnZGInO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIG9ialsnbG9hZFN0cmF0ZWd5J10gPSBzdHJhdGVneTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBsb2FkRGF0YSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3kgPSBvYmpbJ2xvYWRTdHJhdGVneSddO1xyXG5cclxuICAgICAgICAgICAgICAgIHN3aXRjaCAoc3RyYXRlZ3kpIHtcclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdhcGknOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3VudHJpZXNGcm9tQVBJKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGNvdW50cmllcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImNvdW50cmllc1wiXSA9IGNvdW50cmllcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgY291bnRyaWVzIGFuZCB2ZXJzaW9uIG51bWJlciBpbiBkYXRhYmFzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5wdXRJdGVtKGRhdGFiYXNlLCBzdG9yZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBrZXlDb3VudHJpZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlOiAgY291bnRyaWVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5wdXRJdGVtKGRhdGFiYXNlLCBzdG9yZSwge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBrZXlWZXJzaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogb2JqW1wiZXh0ZXJuYWxWZXJzaW9uXCJdXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBjYXNlICdkYic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGdldENvdW50cmllc0Zyb21EQihvYmopXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihfb2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfb2JqKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoJ1Vua25vd24gbG9hZCBzdHJhdGVneScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0RW1wdHlPYmplY3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSh7fSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRJbnRlcm5hbFZlcnNpb24gPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnJldHJpZXZlSXRlbShkYXRhYmFzZSwgc3RvcmUsIGtleVZlcnNpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJpbnRlcm5hbFZlcnNpb25cIl0gPSBpdGVtLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJpbnRlcm5hbFZlcnNpb25cIl0gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0RXh0ZXJuYWxWZXJzaW9uID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBnZXRWZXJzaW9uRnJvbUFQSSgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbih2ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqW1wiZXh0ZXJuYWxWZXJzaW9uXCJdID0gdmVyc2lvbjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXNGcm9tREIgPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgSW5kZXhlZERCU3J2LnJldHJpZXZlSXRlbShkYXRhYmFzZSwgc3RvcmUsIGtleUNvdW50cmllcylcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ialtcImNvdW50cmllc1wiXSA9IGl0ZW0udmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cmllc0Zyb21BUEkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL2NvdW50cmllcycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRWZXJzaW9uRnJvbUFQSSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvY291bnRyaWVzL3ZlcnNpb24nKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UuZGF0YS52ZXJzaW9uIHx8IDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKDApO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyeUJ5QWxwaGEzID0gZnVuY3Rpb24oYWxwaGEzKSB7XHJcbiAgICAgICAgICAgIGlmIChjb3VudHJpZXNCeUFscGhhMyA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXNCeUFscGhhM1thbHBoYTNdO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyaWVzQnlMZXR0ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKGNvdW50cmllc0J5TGV0dGVyID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllc0J5TGV0dGVyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBhcmVDb3VudHJpZXNMb2FkZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGNvdW50cmllcyAhPT0gbnVsbCAmJiBjb3VudHJpZXMubGVuZ3RoID4gMDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbml0OiBpbml0LFxyXG4gICAgICAgICAgICBnZXRDb3VudHJpZXM6IGdldENvdW50cmllcyxcclxuICAgICAgICAgICAgZ2V0Q291bnRyeUJ5QWxwaGEzOiBnZXRDb3VudHJ5QnlBbHBoYTMsXHJcbiAgICAgICAgICAgIGdldENvdW50cmllc0J5TGV0dGVyOiBnZXRDb3VudHJpZXNCeUxldHRlcixcclxuICAgICAgICAgICAgYXJlQ291bnRyaWVzTG9hZGVkOiBhcmVDb3VudHJpZXNMb2FkZWRcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0V2ZW50U3J2JywgW1wiJGh0dHBcIiwgXCJMb2dTcnZcIiwgZnVuY3Rpb24oJGh0dHAsIExvZ1Nydikge1xyXG4gICAgICAgIHZhciBhZGQgPSBmdW5jdGlvbihuYW1lKSB7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvZXZlbnQvYWRkJywge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZVxyXG4gICAgICAgICAgICB9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIC8vIG5vIG5lZWQgdG8gcmVhY3QgdG8gc3VjY2VzcyBjYXNlXHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKCdmYWlsZWQgdG8gYWRkIGV2ZW50JywgZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWRkOiBhZGRcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0ZvY3VzU3J2JywgW1wiJHRpbWVvdXRcIiwgXCIkd2luZG93XCIsIGZ1bmN0aW9uKCR0aW1lb3V0LCAkd2luZG93KSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNlbGVjdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIHRpbWVvdXQgbWFrZXMgc3VyZSB0aGF0IGlzIGludm9rZWQgYWZ0ZXIgYW55IG90aGVyIGV2ZW50IGhhcyBiZWVuIHRyaWdnZXJlZC5cclxuICAgICAgICAgICAgLy8gZS5nLiBjbGljayBldmVudHMgdGhhdCBuZWVkIHRvIHJ1biBiZWZvcmUgdGhlIGZvY3VzIG9yXHJcbiAgICAgICAgICAgIC8vIGlucHV0cyBlbGVtZW50cyB0aGF0IGFyZSBpbiBhIGRpc2FibGVkIHN0YXRlIGJ1dCBhcmUgZW5hYmxlZCB3aGVuIHRob3NlIGV2ZW50c1xyXG4gICAgICAgICAgICAvLyBhcmUgdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdJbmRleGVkREJTcnYnLCBbXCIkd2luZG93XCIsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcclxuICAgICAgICB2YXIga2V5UGF0aCA9ICduYW1lJztcclxuXHJcbiAgICAgICAgdmFyIGluZGV4ZWREQiA9ICR3aW5kb3cuaW5kZXhlZERCIHx8ICR3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8ICR3aW5kb3cubXNJbmRleGVkREI7XHJcbiAgICAgICAgdmFyIElEQktleVJhbmdlID0gJHdpbmRvdy5JREJLZXlSYW5nZSB8fCAkd2luZG93LndlYmtpdElEQktleVJhbmdlO1xyXG5cclxuICAgICAgICB2YXIgSURCVHJhbnNhY3Rpb24gPSAkd2luZG93LklEQlRyYW5zYWN0aW9uIHx8ICR3aW5kb3cud2Via2l0SURCVHJhbnNhY3Rpb247XHJcblxyXG4gICAgICAgIGlmIChJREJUcmFuc2FjdGlvbikge1xyXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFID0gSURCVHJhbnNhY3Rpb24uUkVBRF9XUklURSB8fCAncmVhZHdyaXRlJztcclxuICAgICAgICAgICAgSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZID0gSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZIHx8ICdyZWFkb25seSc7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaW5kZXhlZERCQXZhaWxhYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpbmRleGVkREIgPyB0cnVlIDogZmFsc2U7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNyZWF0ZURhdGFiYXNlID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGUgaXMgYW4gaW5zdGFuY2Ugb2YgSURCVmVyc2lvbkNoYW5nZUV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gaWRiLmNyZWF0ZU9iamVjdFN0b3JlKHN0b3JlTmFtZSwgeyBrZXlQYXRoOiBrZXlQYXRoIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGQsIHVwZGF0ZSwgZGVsZXRlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBlcnJvclxyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkcm9wRGF0YWJhc2UgPSBmdW5jdGlvbihkYk5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBkcm9wIHN1Y2Nlc3NmdWxcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJvcCBmYWlsZWRcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgYWRkSXRlbSA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lLCBpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfV1JJVEUpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGFkZFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0QWRkID0gc3RvcmUuYWRkKGl0ZW0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXF1ZXN0QWRkLm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHB1dEl0ZW0gPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSwgaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdEFkZCA9IHN0b3JlLnB1dChpdGVtKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXRyaWV2ZUl0ZW0gPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSwgaXRlbU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaWRiID0gZS50YXJnZXQucmVzdWx0O1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGlkYi50cmFuc2FjdGlvbihzdG9yZU5hbWUsIElEQlRyYW5zYWN0aW9uLlJFQURfT05MWSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gSURCS2V5UmFuZ2Uub25seShpdGVtTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlLm9wZW5DdXJzb3IocmFuZ2UpLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnNvciA9IGUudGFyZ2V0LnJlc3VsdDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJzb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0gPSBjdXJzb3IudmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGl0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJldHJpZXZlSXRlbXMgPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX09OTFkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHN0b3JlLm9wZW5DdXJzb3IoKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSBlLnRhcmdldC5yZXN1bHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vyc29yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3Vyc29yLmNvbnRpbnVlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGl0ZW1zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNyZWF0ZURhdGFiYXNlOiBjcmVhdGVEYXRhYmFzZSxcclxuICAgICAgICAgICAgZHJvcERhdGFiYXNlOiBkcm9wRGF0YWJhc2UsXHJcbiAgICAgICAgICAgIGFkZEl0ZW06IGFkZEl0ZW0sXHJcbiAgICAgICAgICAgIHB1dEl0ZW06IHB1dEl0ZW0sXHJcbiAgICAgICAgICAgIHJldHJpZXZlSXRlbTogcmV0cmlldmVJdGVtLFxyXG4gICAgICAgICAgICByZXRyaWV2ZUl0ZW1zOiByZXRyaWV2ZUl0ZW1zLFxyXG4gICAgICAgICAgICBpbmRleGVkREJBdmFpbGFibGU6IGluZGV4ZWREQkF2YWlsYWJsZVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XG4ndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnTG9nU3J2JywgW1wiQXBwQ29uZmlnXCIsIGZ1bmN0aW9uKEFwcENvbmZpZykge1xyXG4gICAgICAgIHZhciBsb2dJbmZvID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChBcHBDb25maWdbXCJsb2cuaW5mb1wiXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBsb2dFcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoQXBwQ29uZmlnW1wibG9nLmVycm9yXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbmZvOiBsb2dJbmZvLFxyXG4gICAgICAgICAgICBlcnJvcjogbG9nRXJyb3JcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1F1aXpTcnYnLCBbXCJBcHBDb25maWdcIiwgXCJDb3VudHJ5U3J2XCIsIFwiU2NvcmVTcnZcIiwgXCJFdmVudFNydlwiLCBmdW5jdGlvbihBcHBDb25maWcsIENvdW50cnlTcnYsIFNjb3JlU3J2LCBFdmVudFNydikge1xyXG4gICAgICAgIHZhciBjb3VudHJpZXMgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUFscGhhMyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBxdWl6ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIHNldENvdW50cmllcyA9IGZ1bmN0aW9uKF9jb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgY291bnRyaWVzID0gX2NvdW50cmllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY291bnRyaWVzTG9hZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXMgIT09IG51bGwgJiYgY291bnRyaWVzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb3VudHJpZXNMb2FkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJDb3VudHJpZXMgaGF2ZSBub3QgYmVlbiBsb2FkZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcXVpeiA9IGNyZWF0ZVF1aXooJ2NvdW50cnknKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgcXVpeiBzdGFydCBldmVudFxyXG4gICAgICAgICAgICAgICAgRXZlbnRTcnYuYWRkKCdxdWl6LnN0YXJ0Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShxdWl6LnN0YXJ0KCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGlzcG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBxdWl6ID0gbnVsbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaXNRdWl6UnVubmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKSAmJiAhcXVpei5oYXNFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6U3RhcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpekVuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWl6ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouaGFzRW5kZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlUXVpeiA9IGZ1bmN0aW9uKHF1aXpUeXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocXVpelR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvdW50cnknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlQ291bnRyeVF1aXooKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVDb3VudHJ5UXVpeiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY291bnRyeVF1aXogPSBuZXcgUXVpeigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGZ1bGxQb2ludHMgPSAxMDA7XHJcbiAgICAgICAgICAgIHZhciBoaW50TWF4aW11bSA9IDM7XHJcbiAgICAgICAgICAgIHZhciBoaW50Q29zdCA9IDI1O1xyXG5cclxuICAgICAgICAgICAgdmFyIGxhc3RRdWVzdGlvbkJvbnVzID0gMi41O1xyXG5cclxuICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVHlwZXMgPSBBcHBDb25maWdbJ3F1aXouY291bnRyeS50eXBlcyddO1xyXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlc0xlbmd0aCA9IE9iamVjdC5rZXlzKHF1ZXN0aW9uVHlwZXMpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdCBjb3VudHJpZXMgZm9yIHF1ZXN0aW9uc1xyXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJpZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIG51bWJlck9mUXVlc3Rpb25zID0gQXBwQ29uZmlnWydxdWl6LmNvdW50cnkucXVlc3Rpb25zJ107XHJcblxyXG4gICAgICAgICAgICAvLyB0aGVyZSBhcmUgZml2ZSBlYXN5LCBmaXZlIG1lZGl1bSBhbmQgZml2ZSBoYXJkIHF1ZXN0aW9ucyAobGF0ZXIgdG8gYmUgc2h1ZmZsZWQgcmFuZG9tbHkpXHJcbiAgICAgICAgICAgIC8vIHRoZSAxNnRoIGFuZCBsYXN0IHF1ZXN0aW9uIGlzIGFsd2F5cyBhIGhhcmQgb25lLlxyXG5cclxuICAgICAgICAgICAgdmFyIGVhc3lDb3VudHJpZXMgPSBjb3VudHJpZXMuZmlsdGVyKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjLmRpZmZpY3VsdHkgPT09ICdlYXN5JztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWVkaXVtQ291bnRyaWVzID0gY291bnRyaWVzLmZpbHRlcihmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYy5kaWZmaWN1bHR5ID09PSAnbWVkaXVtJztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgaGFyZENvdW50cmllcyA9IGNvdW50cmllcy5maWx0ZXIoZnVuY3Rpb24oYykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGMuZGlmZmljdWx0eSA9PT0gJ2hhcmQnO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdCBjb3VudHJpZXNcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1iZXJPZlF1ZXN0aW9uczsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyeU9rID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyeTtcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoIWNvdW50cnlPaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDwgNSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5ID0gZWFzeUNvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgZWFzeUNvdW50cmllcy5sZW5ndGggLSAxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpIDwgMTApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeSA9IG1lZGl1bUNvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgbWVkaXVtQ291bnRyaWVzLmxlbmd0aCAtIDEpXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5ID0gaGFyZENvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgaGFyZENvdW50cmllcy5sZW5ndGggLSAxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5T2sgPSBzZWxlY3RlZENvdW50cmllcy5pbmRleE9mKGNvdW50cnlbJ2FscGhhM0NvZGUnXSkgPCAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyaWVzLnB1c2goY291bnRyeVsnYWxwaGEzQ29kZSddKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gc2h1ZmZsZSBhcnJheSAoLTIgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHNodWZmbGUgdGhlIGxhc3QgY291bnRyeSAoaXQgaGFzIHRvIHN0YXkgaW4gcGxhY2UpXHJcbiAgICAgICAgICAgIHZhciBhcnJheVRvU2h1ZmZsZSA9IHNlbGVjdGVkQ291bnRyaWVzLnNwbGljZSgwLCBzZWxlY3RlZENvdW50cmllcy5sZW5ndGggLSAxKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzaHVmZmxlZEFycmF5ID0gc2h1ZmZsZShhcnJheVRvU2h1ZmZsZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgbGFzdCBxdWVzdGlvbiB0byBzaHVmZmxlZCBhcnJheVxyXG4gICAgICAgICAgICBzaHVmZmxlZEFycmF5LnB1c2goc2VsZWN0ZWRDb3VudHJpZXNbc2VsZWN0ZWRDb3VudHJpZXMubGVuZ3RoIC0gMV0pO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHF1ZXN0aW9uIHR5cGUgYXJyYXlcclxuICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVHlwZUFycmF5ID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bWJlck9mUXVlc3Rpb25zOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goNik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qZm9yICh2YXIgaiA9IDA7IGogPCBudW1iZXJPZlF1ZXN0aW9uczsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaiA8IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVzdGlvblR5cGVBcnJheS5wdXNoKDEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqIDwgNikge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goMik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGogPCA5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCgzKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaiA8IDEyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCg0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaiA8IDE1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCg1KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG9uZSByYW5kb20gcXVlc3Rpb24gZm9yIHRoZSBsYXN0IG9uZVxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goZ2V0UmFuZG9tSW50KDEsIHF1ZXN0aW9uVHlwZXNMZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSovXHJcblxyXG4gICAgICAgICAgICB2YXIgc2h1ZmZsZWRRdWVzdGlvblR5cGVBcnJheSA9IHNodWZmbGUocXVlc3Rpb25UeXBlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHF1ZXN0aW9ucyBmb3IgcXVpelxyXG4gICAgICAgICAgICB2YXIgcWNudCA9IDA7XHJcbiAgICAgICAgICAgIHNodWZmbGVkQXJyYXkuZm9yRWFjaChmdW5jdGlvbihhbHBoYTMsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgcWNudCsrO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlID0gcXVlc3Rpb25UeXBlc1tzaHVmZmxlZFF1ZXN0aW9uVHlwZUFycmF5W2lkeF1dO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gZ2V0UXVlc3Rpb25UZXh0KHF1ZXN0aW9uVHlwZSwgY291bnRyeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBxdWVzdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogY291bnRyeS5kaWZmaWN1bHR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBnZXRRdWVzdGlvbklucHV0KHF1ZXN0aW9uVHlwZSksXHJcbiAgICAgICAgICAgICAgICAgICAgdW5pdDogZ2V0UXVlc3Rpb25Vbml0KHF1ZXN0aW9uVHlwZSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgYW5zd2VyID0gZ2V0UXVlc3Rpb25BbnN3ZXIocXVlc3Rpb25UeXBlLCBjb3VudHJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciBjaGVja0Fuc3dlciA9IGdldENoZWNrQW5zd2VyTGFtYmRhKHF1ZXN0aW9uVHlwZSwgZnVsbFBvaW50cywgbGFzdFF1ZXN0aW9uQm9udXMpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhpbnRzID0gZ2V0UXVlc3Rpb25IaW50cyhxdWVzdGlvblR5cGUsIGhpbnRNYXhpbXVtLCBoaW50Q29zdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGxhc3QgcXVlc3Rpb24gaXMgdGhlIGJvbnVzIHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAocWNudCA+PSBudW1iZXJPZlF1ZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm9bJ2JvbnVzJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGFkZCBpbmZvIGZvciBmbGFnIG9mIGNvdW50cnlcclxuICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvblR5cGUgPT09ICdGTEFHX09GX0NPVU5UUlknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5tZWRpYSA9ICdmbGFnJztcclxuICAgICAgICAgICAgICAgICAgICBpbmZvLmFscGhhMkNvZGUgPSBjb3VudHJ5LmFscGhhMkNvZGUudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgaW5mbyBmb3IgbG9jYXRpb24gb2YgY291bnRyeVxyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uVHlwZSA9PT0gJ0xPQ0FUSU9OX09GX0NPVU5UUlknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5tZWRpYSA9ICdtYXAnO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm8uYWxwaGEyQ29kZSA9IGNvdW50cnkuYWxwaGEyQ29kZS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvdW50cnlRdWl6LmFkZFF1ZXN0aW9uKG5ldyBRdWVzdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBpbmZvOiBpbmZvLFxyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcjogYW5zd2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQW5zd2VyOiBjaGVja0Fuc3dlcixcclxuICAgICAgICAgICAgICAgICAgICBoaW50czogaGludHNcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyeVF1aXo7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVGV4dCA9IGZ1bmN0aW9uKHR5cGUsIGNvdW50cnkpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDQVBJVEFMX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBoZWnDn3QgZGllIEhhdXB0c3RhZHQgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiW1wiICsgY291bnRyeS5jYXBpdGFsICsgXCJdIGlzdCBkaWUgSGF1cHRzdGFkdCB2b24gd2VsY2hlbSBMYW5kXCJcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSB2aWVsZSBNZW5zY2hlbiBsZWJlbiBpbiBbXCIgKyBjb3VudHJ5Lm5hbWUgKyBcIl1cIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBncm/DnyBpc3QgZGllIEZsw6RjaGUgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0ZMQUdfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2VsY2hlcyBMYW5kIGhhdCBkaWVzZSBGbGFnZ2VcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJXbyBiZWZpbmRldCBzaWNoIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiP1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25BbnN3ZXIgPSBmdW5jdGlvbih0eXBlLCBjb3VudHJ5KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWx0U3BlbGxpbmdzID0gY291bnRyeS5hbHRTcGVsbGluZ3MgIT09IHVuZGVmaW5lZCAmJiBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddICE9PSB1bmRlZmluZWQgPyBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddIDogW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnJlY3Q6IGNvdW50cnkuY2FwaXRhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0U3BlbGxpbmdzOiBhbHRTcGVsbGluZ3NcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbHRTcGVsbGluZ3MgPSBjb3VudHJ5LmFsdFNwZWxsaW5ncyAhPT0gdW5kZWZpbmVkICYmIGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gIT09IHVuZGVmaW5lZCA/IGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gOiBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHRTcGVsbGluZ3M6IGFsdFNwZWxsaW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LnBvcHVsYXRpb25cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5hcmVhXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LmFscGhhMkNvZGVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiP1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25JbnB1dCA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnbnVtYmVyLmhpZ2gnO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdudW1iZXIubWVkaXVtJztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ21hcC5wb2ludCc7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RleHQuc3RhbmRhcmQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVW5pdCA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAna23Csic7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0VpbndvaG5lcic7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDaGVja0Fuc3dlckxhbWJkYSA9IGZ1bmN0aW9uKHR5cGUsIGZ1bGxQb2ludHMsIGxhc3RRdWVzdGlvbkJvbnVzKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTE9DQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGFuc3dlciwgc3VibWl0dGVkQW5zd2VyLCBoaW50c1VzZWQsIGhpbnRDb3N0LCBpbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbGxvd2VkU3BlbGxpbmdzO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuc3dlci5hbHRTcGVsbGluZ3MgJiYgYW5zd2VyLmFsdFNwZWxsaW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU3BlbGxpbmdzID0gYW5zd2VyLmFsdFNwZWxsaW5ncy5tYXAoZnVuY3Rpb24oc3BlbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3BlbGxpbmcudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZFNwZWxsaW5ncyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29ycmVjdCA9IHN1Ym1pdHRlZEFuc3dlci50b0xvY2FsZUxvd2VyQ2FzZSgpID09PSBhbnN3ZXIuY29ycmVjdC50b0xvY2FsZUxvd2VyQ2FzZSgpIHx8IChhbGxvd2VkU3BlbGxpbmdzICYmIGFsbG93ZWRTcGVsbGluZ3MuaW5kZXhPZihzdWJtaXR0ZWRBbnN3ZXIpID49IDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50cyA9IGNvcnJlY3QgPyBmdWxsUG9pbnRzIDogMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGhpbnRzIGFyZSBhbGxvd2VkIGFuZCBoYXZlIGJlZW4gdXNlZCwgc3VidHJhY3QgdGhlIHBvaW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGludHNVc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzIC09IChoaW50c1VzZWQgKiBoaW50Q29zdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJvbnVzIHBvaW50cyBmb3IgbGFzdCBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mbyAhPT0gdW5kZWZpbmVkICYmIGluZm8uYm9udXMgIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgKj0gbGFzdFF1ZXN0aW9uQm9udXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYW5zd2VyLCBzdWJtaXR0ZWRBbnN3ZXIsIGhpbnRzVXNlZCwgaGludENvc3QsIGluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHBlcmNlbnRhZ2UgZGlmZmVyZW5jZSBmcm9tIGNvcnJlY3QgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvclBlcmNlbnRhZ2UgPSBNYXRoLmFicyhzdWJtaXR0ZWRBbnN3ZXIgLSBhbnN3ZXIuY29ycmVjdCkgLyBhbnN3ZXIuY29ycmVjdCAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludHM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDEwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gNikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gOTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDgwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNzA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDE0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA2MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAzMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDIwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAzMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBoaW50cyBhcmUgYWxsb3dlZCBhbmQgaGF2ZSBiZWVuIHVzZWQsIHN1YnRyYWN0IHRoZSBwb2ludHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhpbnRzVXNlZCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyAtPSAoaGludHNVc2VkICogaGludENvc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBib251cyBwb2ludHMgZm9yIGxhc3QgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8gIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzICE9PSB1bmRlZmluZWQgJiYgaW5mby5ib251cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzICo9IGxhc3RRdWVzdGlvbkJvbnVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25IaW50cyA9IGZ1bmN0aW9uKHR5cGUsIGhpbnRzUG9zc2libGUsIGhpbnRDb3N0KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heGltdW06IGhpbnRzUG9zc2libGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvc3Q6IGhpbnRDb3N0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnaXZlOiBmdW5jdGlvbihoaW50c1VzZWQsIGFuc3dlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuc3dlci5jb3JyZWN0LnN1YnN0cigwLCBoaW50c1VzZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2VkOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXROdW1iZXJPZlF1ZXN0aW9ucygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDdXJyZW50UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmN1cnJlbnRRdWVzdGlvbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBuZXh0UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcXVpei5uZXh0UXVlc3Rpb24oKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHF1aXogPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRUb3RhbFBvaW50cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29uY2x1ZGVzIHRoZSBxdWl6IGFuZCBwdXRzIHRoZSBzY29yZSB0byB0aGUgQVBJIGVuZHBvaW50LlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBjb25jbHVkZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocXVpeiAhPT0gbnVsbCAmJiBxdWl6Lmhhc0VuZGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocXVpei5zdWJtaXR0ZWQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdRdWl6IGhhcyBhbHJlYWR5IGJlZW4gc3VibWl0dGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBxdWl6LnN1Ym1pdHRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFNjb3JlU3J2LnB1dEhpZ2hzY29yZShxdWl6LmdldFRvdGFsUG9pbnRzKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBxdWl6IGZpbmlzaCBldmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRTcnYuYWRkKCdxdWl6LmZpbmlzaCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdObyBxdWl6IGlzIGN1cnJlbnRseSBydW5uaW5nJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNodWZmbGVzIGFuIGFycmF5IHJhbmRvbWx5XHJcbiAgICAgICAgICogQHBhcmFtIGFycmF5ICAgICB0aGUgYXJyYXkgdG8gYmUgc2h1ZmZsZWRcclxuICAgICAgICAgKiBAcmV0dXJucyB7Kn0gICAgIHRoZSBzaHVmZmxlZCBhcnJheVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBzaHVmZmxlID0gZnVuY3Rpb24gKGFycmF5KSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBhcnJheS5sZW5ndGgsIHRlbXBvcmFyeVZhbHVlLCByYW5kb21JbmRleDtcclxuXHJcbiAgICAgICAgICAgIC8vIFdoaWxlIHRoZXJlIHJlbWFpbiBlbGVtZW50cyB0byBzaHVmZmxlLi4uXHJcbiAgICAgICAgICAgIHdoaWxlICgwICE9PSBjdXJyZW50SW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBQaWNrIGEgcmVtYWluaW5nIGVsZW1lbnQuLi5cclxuICAgICAgICAgICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY3VycmVudEluZGV4KTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleCAtPSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFuZCBzd2FwIGl0IHdpdGggdGhlIGN1cnJlbnQgZWxlbWVudC5cclxuICAgICAgICAgICAgICAgIHRlbXBvcmFyeVZhbHVlID0gYXJyYXlbY3VycmVudEluZGV4XTtcclxuICAgICAgICAgICAgICAgIGFycmF5W2N1cnJlbnRJbmRleF0gPSBhcnJheVtyYW5kb21JbmRleF07XHJcbiAgICAgICAgICAgICAgICBhcnJheVtyYW5kb21JbmRleF0gPSB0ZW1wb3JhcnlWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXQsXHJcbiAgICAgICAgICAgIHNldENvdW50cmllczogc2V0Q291bnRyaWVzLFxyXG4gICAgICAgICAgICBpc1F1aXpSdW5uaW5nOiBpc1F1aXpSdW5uaW5nLFxyXG4gICAgICAgICAgICBoYXNRdWl6U3RhcnRlZDogaGFzUXVpelN0YXJ0ZWQsXHJcbiAgICAgICAgICAgIGhhc1F1aXpFbmRlZDogaGFzUXVpekVuZGVkLFxyXG4gICAgICAgICAgICBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXI6IGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcixcclxuICAgICAgICAgICAgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zOiBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMsXHJcbiAgICAgICAgICAgIGdldEN1cnJlbnRRdWVzdGlvbjogZ2V0Q3VycmVudFF1ZXN0aW9uLFxyXG4gICAgICAgICAgICBuZXh0UXVlc3Rpb246IG5leHRRdWVzdGlvbixcclxuICAgICAgICAgICAgZ2V0VG90YWxQb2ludHM6IGdldFRvdGFsUG9pbnRzLFxyXG4gICAgICAgICAgICBjb25jbHVkZTogY29uY2x1ZGUsXHJcbiAgICAgICAgICAgIGRpc3Bvc2U6IGRpc3Bvc2VcclxuICAgICAgICB9O1xyXG4gICAgfV0pO1xuJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1Njb3JlU3J2JywgW1wiJGh0dHBcIiwgZnVuY3Rpb24oJGh0dHApIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBlbnRpcmUgaGlnaHNjb3JlIGxpc3QgaW4gYW4gYXJyYXkgZnJvbSB0aGUgQVBJLlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBnZXRIaWdoc2NvcmVMaXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9zY29yZXMvYWxsJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobGlzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBoaWdoc2NvcmUgb2JqZWN0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogSWYgdGhlIHVzZXIgaGFzIG5vIHJlc3VsdCB5ZXQsIGFuIGVtcHR5IG9iamVjdCBpcyByZXR1cm5lZC5cclxuICAgICAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgZ2V0VXNlckhpZ2hzY29yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvc2NvcmVzL3VzZXInKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRmV0Y2hlcyB0aGUgaGlnaHNjb3JlIG9iamVjdCBmb3IgdGhlIG92ZXJhbGwgaGlnaHNjb3JlLlxyXG4gICAgICAgICAqIElmIHRoZXJlIGlzIGN1cnJlbnRseSBubyByZXN1bHQgeWV0LCBhbiBlbXB0eSBvYmplY3QgaXMgcmV0dXJuZWQuXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGdldE92ZXJhbGxIaWdoc2NvcmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3Njb3Jlcy9oaWdoJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihzY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNjb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFB1dHMgYSBoaWdoc2NvcmUgcmVzdWx0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogQHBhcmFtIHNjb3JlICAgICBOdW1iZXIgd2l0aCB0aGUgYWNoaWV2ZWQgc2NvcmUuXHJcbiAgICAgICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHB1dEhpZ2hzY29yZSA9IGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS9zY29yZXMnLCB7IHNjb3JlOiBzY29yZSB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldEhpZ2hzY29yZUxpc3Q6IGdldEhpZ2hzY29yZUxpc3QsXHJcbiAgICAgICAgICAgIGdldFVzZXJIaWdoc2NvcmU6IGdldFVzZXJIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIGdldE92ZXJhbGxIaWdoc2NvcmU6IGdldE92ZXJhbGxIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIHB1dEhpZ2hzY29yZTogcHV0SGlnaHNjb3JlXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdVc2VyU3J2JywgW1wiJGh0dHBcIiwgXCJBdXRoVG9rZW5TcnZcIiwgXCJBcHBDb25maWdcIiwgZnVuY3Rpb24oJGh0dHAsIEF1dGhUb2tlblNydiwgQXBwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXInKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlckZyb21TdG9yYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IEF1dGhUb2tlblNydi5nZXRUb2tlbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIEF1dGhUb2tlblNydi5zZXRUb2tlbih0b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGdldFVzZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyB0b2tlbiwgd2UgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gdG9rZW4gaW4gc3RvcmFnZVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb24nLCB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi50b2tlbiA9IHJlc3BvbnNlLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB0b2tlbiBsb2NhbGx5XHJcbiAgICAgICAgICAgICAgICBBdXRoVG9rZW5TcnYuc2V0VG9rZW4oc2VsZi50b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFVzZXIoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRva2VuID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdG9rZW4gbG9jYWxseVxyXG4gICAgICAgICAgICAgICAgQXV0aFRva2VuU3J2LnNldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbihuZXdVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBhIHJhbmRvbSBjb2xvciBmb3IgdGhlIHVzZXJcclxuICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcHBDb25maWdbJ3NldHRpbmdzLnVzZXIuY29sb3JzJ107XHJcbiAgICAgICAgICAgICAgICBuZXdVc2VyLmNvbG9yID0gY29sb3JzW2dldFJhbmRvbUludCgwLCBjb2xvcnMubGVuZ3RoIC0gMSldO1xyXG5cclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcicsIG5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSBsb2cgdGhlIHVzZXIgaW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9naW4obmV3VXNlci51c2VybmFtZSwgbmV3VXNlci5wYXNzd29yZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkgIDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlQmFzaWMgPSBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS91c2VyL2Jhc2ljJywgdXNlcilcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQYXNzd29yZCA9IGZ1bmN0aW9uKHBhc3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvYXBpL3VzZXIvcGFzc3dvcmQnLCBwYXNzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXNldFBhc3N3b3JkID0gZnVuY3Rpb24oYm9keSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3Bhc3N3b3JkL3Jlc2V0JywgYm9keSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZm9yZ290UGFzc3dvcmQgPSBmdW5jdGlvbihib2R5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvcGFzc3dvcmQvZm9yZ290JywgYm9keSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXRVc2VyOiBnZXRVc2VyLFxyXG4gICAgICAgICAgICBnZXRVc2VyRnJvbVN0b3JhZ2U6IGdldFVzZXJGcm9tU3RvcmFnZSxcclxuICAgICAgICAgICAgbG9naW46IGxvZ2luLFxyXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dCxcclxuICAgICAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyLFxyXG4gICAgICAgICAgICB1cGRhdGVCYXNpYzogdXBkYXRlQmFzaWMsXHJcbiAgICAgICAgICAgIHVwZGF0ZVBhc3N3b3JkOiB1cGRhdGVQYXNzd29yZCxcclxuICAgICAgICAgICAgcmVzZXRQYXNzd29yZDogcmVzZXRQYXNzd29yZCxcclxuICAgICAgICAgICAgZm9yZ290UGFzc3dvcmQ6IGZvcmdvdFBhc3N3b3JkXHJcbiAgICAgICAgfTtcclxuICAgIH1dKTsiLCIvLyBvd24gY2xhc3NlcyBhbmQgZnVuY3Rpb25zXHJcblxyXG4vLyAtLS0tLS0tLS0tIE1BUCAtLS0tLS0tLS0tXHJcbnZhciBjcmVhdGVNYXAgPSBmdW5jdGlvbigpIHtcclxuICAgIHZhciBtYXAgPSBuZXcgRGF0YW1hcCh7XHJcbiAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1jb250YWluZXInKSxcclxuICAgICAgICBnZW9ncmFwaHlDb25maWc6IHtcclxuICAgICAgICAgICAgaGlnaGxpZ2h0T25Ib3ZlcjogdHJ1ZSxcclxuICAgICAgICAgICAgcG9wdXBPbkhvdmVyOiBmYWxzZVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8gLS0tLS0tLS0tLSBRVUlaIC0tLS0tLS0tLS1cclxudmFyIFF1aXogPSBmdW5jdGlvbigpIHtcclxuICAgIC8vIGluZGV4IG9mIGN1cnJlbnQgcXVlc3Rpb25cclxuICAgIHZhciBjdXJyZW50UXVlc3Rpb25JZHggPSBudWxsO1xyXG5cclxuICAgIC8vIGFycmF5IGNvbnRhaW5pbmcgYWxsIHF1ZXN0aW9uc1xyXG4gICAgdmFyIHF1ZXN0aW9ucyA9IFtdO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU3RhcnRzIHRoZSBxdWl6LlxyXG4gICAgICovXHJcbiAgICB0aGlzLnN0YXJ0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgLy8gY2hlY2sgaWYgcXVpeiBoYXMgcXVlc3Rpb25zXHJcbiAgICAgICAgaWYgKHF1ZXN0aW9ucy5sZW5ndGggPD0gMClcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJDYW5ub3Qgc3RhcnQgYSBxdWl6IHdpdGhvdXQgcXVlc3Rpb25zXCIpO1xyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5uZXh0UXVlc3Rpb24oKTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5pc0FjdGl2ZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmhhc1N0YXJ0ZWQoKSAmJiAhdGhpcy5oYXNFbmRlZCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmhhc1N0YXJ0ZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gY3VycmVudFF1ZXN0aW9uSWR4ICE9PSBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmhhc0VuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzU3RhcnRlZCgpICYmIGN1cnJlbnRRdWVzdGlvbklkeCA+PSBxdWVzdGlvbnMubGVuZ3RoO1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLnN1Ym1pdHRlZCA9IGZhbHNlO1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkcyBhIG5ldyBxdWVzdGlvbiB0byB0aGUgcXVpei5cclxuICAgICAqIFRoZSBwYXJhbWV0ZXIgbXVzdCBiZSBhbiBxdWVzdGlvbiBvYmplY3QuXHJcbiAgICAgKiBJZiBubyBxdWVzdGlvbiBvYmplY3QgaXMgcGFzc2VkIG9yIGFuIG9iamVjdCB3aXRoIG1pc3NpbmcgcHJvcGVydGllcywgYW4gZXJyb3IgaXMgdGhyb3duLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmFkZFF1ZXN0aW9uID0gZnVuY3Rpb24ocXVlc3Rpb24pIHtcclxuICAgICAgICBpZiAocXVlc3Rpb24gPT09IHVuZGVmaW5lZClcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJObyBxdWVzdGlvbiBvYmplY3QgcGFzc2VkXCIpO1xyXG5cclxuICAgICAgICB2YXIgdmFsaWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBhIHF1ZXN0aW9uIG9iamVjdCBtdXN0IGNvbnRhaW4gYWxsIHRoZXNlIHByb3BlcnRpZXNcclxuICAgICAgICB2YXIgbmVjZXNzYXJ5UHJvcGVydGllcyA9IFsnY29uZmlnJywgJ2hpbnQnLCAnc29sdXRpb24nLCAnYW5zd2VyJywgJ3F1ZXN0aW9uJywgJ2dldEluZm8nLCAnaW5mbycsICdwb2ludHMnLCAnYW5zd2VyZWQnLCAnaGludHNBbGxvd2VkJywgJ2hpbnRzUmVtYWluaW5nJ107XHJcblxyXG4gICAgICAgIG5lY2Vzc2FyeVByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wZXJ0eSkge1xyXG4gICAgICAgICAgICBpZiAoIXF1ZXN0aW9uLmhhc093blByb3BlcnR5KHByb3BlcnR5KSkge1xyXG4gICAgICAgICAgICAgICAgdmFsaWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlF1ZXN0aW9uIG11c3QgaGF2ZSBwcm9wZXJ0eSAnXCIgKyBwcm9wZXJ0eSArIFwiJ1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAodmFsaWQpIHtcclxuICAgICAgICAgICAgcXVlc3Rpb25zLnB1c2gocXVlc3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBuZXh0IHF1ZXN0aW9uIG9mIHRoZSBxdWl6LlxyXG4gICAgICogSWYgdGhlIHF1aXogaGFzIGVuZGVkLCBpdCByZXR1cm5zIG5vdGhpbmcuXHJcbiAgICAgKi9cclxuICAgIHRoaXMubmV4dFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKGN1cnJlbnRRdWVzdGlvbklkeCA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjdXJyZW50UXVlc3Rpb25JZHggPSAwO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRRdWVzdGlvbklkeCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaGFzRW5kZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zW2N1cnJlbnRRdWVzdGlvbklkeF07XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuY3VycmVudFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zW2N1cnJlbnRRdWVzdGlvbklkeF07XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc1N0YXJ0ZWQoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0b3RhbFBvaW50cyA9IDA7XHJcblxyXG4gICAgICAgIHF1ZXN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHF1ZXN0aW9uKSB7XHJcbiAgICAgICAgICAgIHZhciBwb2ludHMgPSBxdWVzdGlvbi5wb2ludHMoKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChwb2ludHMgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdG90YWxQb2ludHMgKz0gcG9pbnRzO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiB0b3RhbFBvaW50cztcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBpZiAoY3VycmVudFF1ZXN0aW9uSWR4ID09PSBudWxsKVxyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRRdWVzdGlvbklkeCArIDE7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0TnVtYmVyT2ZRdWVzdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gcXVlc3Rpb25zLmxlbmd0aDtcclxuICAgIH07XHJcbn07XHJcblxyXG4vLyAtLS0tLS0tLS0tIFFVRVNUSU9OIC0tLS0tLS0tLS1cclxudmFyIFF1ZXN0aW9uID0gZnVuY3Rpb24ob3B0aW9ucykge1xyXG4gICAgLy8gVGV4dCBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciB0ZXh0ID0gbnVsbDtcclxuXHJcbiAgICAvLyBJbmZvIG9iamVjdCBmb3IgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgaW5mbyA9IG51bGw7XHJcblxyXG4gICAgLy8gQW5zd2VyIG9mIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIGFuc3dlciA9IG51bGw7XHJcblxyXG4gICAgLy8gSGludHMgb2YgdGhlIHF1ZXN0aW9uXHJcbiAgICB2YXIgaGludHMgPSBudWxsO1xyXG4gICAgdmFyIGhpbnRzVXNlZCA9IDA7XHJcblxyXG4gICAgLy8gTGFtYmRhIGZ1bmN0aW9uIHRvIGRldGVybWluZSB0aGUgYW5zd2VyIHN0YXR1cyBvZiB0aGUgcXVlc3Rpb25cclxuICAgIHZhciBjaGVja0Fuc3dlciA9IG51bGw7XHJcblxyXG4gICAgLy8gUG9pbnRzIGF3YXJkZWQgZm9yIHRoZSBxdWVzdGlvblxyXG4gICAgdmFyIHBvaW50cyA9IG51bGw7XHJcblxyXG4gICAgLy8gRmxhZyBpbmRpY2F0aW5nIHdoZXRoZXIgcXVlc3Rpb24gaGFzIGFscmVhZHkgYmVlbiBhbnN3ZXJlZFxyXG4gICAgdmFyIGFuc3dlcmVkID0gZmFsc2U7XHJcblxyXG4gICAgdmFyIGluaXQgPSBmdW5jdGlvbihvcHRzKSB7XHJcbiAgICAgICAgdGV4dCA9IG9wdHMudGV4dDtcclxuICAgICAgICBpbmZvID0gb3B0cy5pbmZvIHx8IHt9O1xyXG4gICAgICAgIGFuc3dlciA9IG9wdHMuYW5zd2VyO1xyXG4gICAgICAgIGNoZWNrQW5zd2VyID0gb3B0cy5jaGVja0Fuc3dlciB8fCBudWxsO1xyXG5cclxuICAgICAgICBoaW50cyA9IG9wdHMuaGludHMgfHwge1xyXG4gICAgICAgICAgICAgICAgYWxsb3dlZDogZmFsc2UsICAgICAvLyBpcyBhIGhpbnQgYWxsb3dlZD9cclxuICAgICAgICAgICAgICAgIG1heGltdW06IDAsICAgICAgICAgLy8gbWF4aW11bSBudW1iZXIgb2YgaGludHMgZm9yIHRoaXMgcXVlc3Rpb24gKGlycmVsZXZhbnQgaWYgYWxsb3dlZCBpcyBzZXQgdG8gZmFsc2UpXHJcbiAgICAgICAgICAgICAgICBjb3N0OiAwLCAgICAgICAgICAgIC8vIG51bWJlciBvZiBwb2ludHMgc3VidHJhY3RlZCBwZXIgdXNlZCBoaW50IChpcnJlbGV2YW50IGlmIGFsbG93ZWQgaXMgc2V0IHRvIGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgZ2l2ZTogbnVsbCAgICAgICAgICAvLyBsYW1iZGEgZnVuY3Rpb24gdG8gZ2l2ZSBhIGhpbnQgZm9yIGEgcXVlc3Rpb25cclxuICAgICAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgaWYgKG9wdGlvbnMpIHtcclxuICAgICAgICBpbml0KG9wdGlvbnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuY29uZmlnID0gZnVuY3Rpb24ob3B0cykge1xyXG4gICAgICAgIGluaXQob3B0cyk7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgcXVlc3Rpb24gdGV4dC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5xdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHF1ZXN0aW9uIGluZm8gb2JqZWN0LlxyXG4gICAgICogQWN0cyBhcyBnZXR0ZXIgKHdpdGggb25seSBvbmUgYXJndW1lbnQpIGFuZCBzZXR0ZXIgKHdpdGggdHdvIGFyZ3VtZW50cylcclxuICAgICAqL1xyXG4gICAgdGhpcy5pbmZvID0gZnVuY3Rpb24ocHJvcCwgdmFsdWUpIHtcclxuICAgICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAvLyBzZXR0ZXJcclxuICAgICAgICAgICAgaW5mb1twcm9wXSA9IHZhbHVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIGdldHRlclxyXG4gICAgICAgICAgICByZXR1cm4gaW5mb1twcm9wXTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyB0aGUgZW50aXJlIGluZm8gb2JqZWN0LlxyXG4gICAgICovXHJcbiAgICB0aGlzLmdldEluZm8gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gaW5mbztcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBjb3JyZWN0IGFuc3dlciB0byB0aGUgcXVlc3Rpb24gYWZ0ZXIgdGhlIHF1ZXN0aW9uIGhhcyBiZWVuIGFuc3dlcmVkLlxyXG4gICAgICogSWYgdGhlIHF1ZXN0aW9uIGhhcyBub3QgYmVlbiBhbnN3ZXJlZCB5ZXQsIGl0IHJldHVybnMgbnVsbC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5zb2x1dGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChhbnN3ZXJlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYW5zd2VyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGhpbnQgZm9yIHRoZSBxdWVzdGlvbi5cclxuICAgICAqIElmIG5vIGhpbnRzIGFyZSBhbGxvd2VkLCBvciB0aGUgbWF4aW11bSBudW1iZXIgb2YgaGludHMgaGF2ZSBiZWVuIHVzZWQsIG51bGwgaXMgcmV0dXJuZWQuXHJcbiAgICAgKi9cclxuICAgIHRoaXMuaGludCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmICghaGludHMuYWxsb3dlZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoaW50cy5hbGxvd2VkICYmICFoaW50cy5naXZlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkhpbnRzIGFsbG93ZWQgYnV0IG5vIGdpdmUgbWV0aG9kIHBhc3NlZFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoaW50c1VzZWQgPCBoaW50cy5tYXhpbXVtKSB7XHJcbiAgICAgICAgICAgIGhpbnRzVXNlZCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGhpbnRzLmdpdmUoaGludHNVc2VkLCBhbnN3ZXIpO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFN1Ym1pdHMgYW4gYW5zd2VyIHRvIHRoZSBxdWVzdGlvbi5cclxuICAgICAqIElmIHRoZSBxdWVzdGlvbiBoYXMgYWxyZWFkeSBiZWVuIGFuc3dlcmVkIG9yIG5vIGNoZWNrQW5zd2VyIGxhbWJkYSBoYXMgYmVlbiBzZXQsIHRoaXMgbWV0aG9kIGRvZXMgbm90aGluZy5cclxuICAgICAqL1xyXG4gICAgdGhpcy5hbnN3ZXIgPSBmdW5jdGlvbihzdWJtaXR0ZWRBbnN3ZXIpIHtcclxuICAgICAgICBpZiAoYW5zd2VyZWQgfHwhY2hlY2tBbnN3ZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYW5zd2VyZWQgPSB0cnVlO1xyXG5cclxuICAgICAgICAvLyBjaGVja0Fuc3dlciBtZXRob2Qgc2hvdWxkIHJldHVybiB0aGUgc3RhdHVzIHJlc3VsdHNcclxuICAgICAgICBwb2ludHMgPSBjaGVja0Fuc3dlcihhbnN3ZXIsIHN1Ym1pdHRlZEFuc3dlciwgaGludHNVc2VkLCBoaW50cy5jb3N0LCBpbmZvKTtcclxuXHJcbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgbm8gbmVnYXRpdmUgcG9pbnRzIGFyZSBhd2FyZGVkXHJcbiAgICAgICAgcG9pbnRzID0gTWF0aC5tYXgoMCwgcG9pbnRzKTtcclxuXHJcbiAgICAgICAgLy8gZW5zdXJlIHRoYXQgb25seSBpbnRlZ2VyIHZhbHVlcyBhcmUgc2F2ZWRcclxuICAgICAgICBwb2ludHMgPSBNYXRoLmZsb29yKHBvaW50cyk7XHJcblxyXG4gICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMucG9pbnRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCFhbnN3ZXJlZCB8fCBwb2ludHMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHBvaW50cztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIHN0YXRlIG9mIHRoZSBxdWVzdGlvbi5cclxuICAgICAqL1xyXG4gICAgdGhpcy5hbnN3ZXJlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiBhbnN3ZXJlZDtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgaGludHMgYXJlIGFsbG93ZWQgZm9yIHRoaXMgcXVlc3Rpb24sIGZhbHNlIGlmIG5vdC5cclxuICAgICAqIElmIGhpbnRzIGhhdmUgbm90IGJlZW4gaW5pdGlhbGl6ZWQgeWV0LCBudWxsIGlzIHJldHVybmVkLlxyXG4gICAgICovXHJcbiAgICB0aGlzLmhpbnRzQWxsb3dlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaGludHMuYWxsb3dlZDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByZW1haW5pbmcgaGludHMuXHJcbiAgICAgKiBJZiBubyBoaW50cyBhcmUgYWxsb3dlZCBmb3IgdGhpcyBxdWVzdGlvbiwgbnVsbCBpcyByZXR1cm5lZC5cclxuICAgICAqL1xyXG4gICAgdGhpcy5oaW50c1JlbWFpbmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIHZhciBhbGxvd2VkID0gdGhpcy5oaW50c0FsbG93ZWQoKTtcclxuXHJcbiAgICAgICAgaWYgKGFsbG93ZWQgPT09IG51bGwgfHwgYWxsb3dlZCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gaGludHMubWF4aW11bSAtIGhpbnRzVXNlZDtcclxuICAgIH07XHJcbn07XHJcblxyXG4vKipcclxuICogUmV0dXJucyBhIHJhbmRvbSBpbnRlZ2VyIGJldHdlZW4gbWluIChpbmNsdXNpdmUpIGFuZCBtYXggKGluY2x1c2l2ZSlcclxuICogVXNpbmcgTWF0aC5yb3VuZCgpIHdpbGwgZ2l2ZSB5b3UgYSBub24tdW5pZm9ybSBkaXN0cmlidXRpb24hXHJcbiAqL1xyXG52YXIgZ2V0UmFuZG9tSW50ID0gZnVuY3Rpb24obWluLCBtYXgpIHtcclxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluICsgMSkpICsgbWluO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgdGhlIHRleHQgYmV0d2VlbiB0d28gZGVsaW1pdGluZyB0ZXh0IG9jY3VycmVuY2VzXHJcbiAqL1xyXG52YXIgZ2V0U3RyaW5nQmV0d2VlbiA9IGZ1bmN0aW9uKHRleHQsIGZpcnN0U3RyaW5nLCBzZWNvbmRTdHJpbmcpIHtcclxuICAgIHZhciBmaXJzdFBvcyA9IHRleHQuaW5kZXhPZihmaXJzdFN0cmluZyk7XHJcbiAgICB2YXIgc2Vjb25kUG9zID0gdGV4dC5pbmRleE9mKHNlY29uZFN0cmluZyk7XHJcblxyXG4gICAgaWYgKGZpcnN0UG9zID49IDAgJiYgc2Vjb25kUG9zID49IDAgJiYgc2Vjb25kUG9zID4gZmlyc3RQb3MpIHtcclxuICAgICAgICByZXR1cm4gdGV4dC5zdWJzdHIoZmlyc3RQb3MgKyAxLCBzZWNvbmRQb3MgLSBmaXJzdFBvcyAtIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG5cclxuLy8gLS0tLS0tLS0tLSBQQVNTV09SRCBSRVFVSVJFTUVOVFMgVkFMSURBVE9SIC0tLS0tLS0tLS1cclxudmFyIFBhc3N3b3JkUmVxdWlyZW1lbnRzVmFsaWRhdG9yID0gZnVuY3Rpb24oKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcblxyXG4gICAgLy8gZGVmYXVsdCBjb25maWd1cmF0aW9uXHJcbiAgICB2YXIgZGVmYXVsdENvbmZpZyA9IHtcclxuICAgICAgICBtaW5MZW5ndGg6IDgsXHJcbiAgICAgICAgbWF4TGVuZ3RoOiB1bmRlZmluZWQsXHJcbiAgICAgICAgbG93ZXJjYXNlQ2hhcnM6IDEsXHJcbiAgICAgICAgdXBwZXJjYXNlQ2hhcnM6IDEsXHJcbiAgICAgICAgc3BlY2lhbENoYXJzOiAxLFxyXG4gICAgICAgIG51bWVyaWNDaGFyczogMVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyB1c2VkIGNvbmZpZ3VyYXRpb25cclxuICAgIHZhciBjb25maWd1cmF0aW9uID0gbnVsbDtcclxuXHJcbiAgICAvLyBwYXNzd29yZCBpbnB1dFxyXG4gICAgdGhpcy5pbnB1dCA9IG51bGw7XHJcblxyXG4gICAgdGhpcy5jaGVjayA9IGZ1bmN0aW9uKF9pbnB1dCkge1xyXG4gICAgICAgIC8vIGNoZWNrIGlmIGFuIGlucHV0IHdhcyBwYXNzZWRcclxuICAgICAgICBpZiAodHlwZW9mIF9pbnB1dCA9PT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIG1hbmRhdG9yeSBpbnB1dCBwYXJhbWV0ZXInKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIGNoZWNrIGlmIHBhc3NlZCBpbnB1dCBpcyBvZiB0eXBlIFwic3RyaW5nXCJcclxuICAgICAgICBpZiAodHlwZW9mIF9pbnB1dCAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGaXJzdCBpbnB1dCBwYXJhbWV0ZXIgbXVzdCBiZSBvZiB0eXBlIFxcXCJzdHJpbmdcXFwiJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBzZXQgaW5wdXQgdmFyaWFibGVcclxuICAgICAgICB0aGlzLmlucHV0ID0gX2lucHV0O1xyXG5cclxuICAgICAgICAvLyBhcnJheSBjb250YWluaW5nIGFsbCBmYWlsZWQgY2hlY2tzXHJcbiAgICAgICAgdmFyIGZhaWxlZENoZWNrcyA9IFtdO1xyXG5cclxuICAgICAgICAvLyBnZXQgYWxsIHNldCBjb25maWcgcHJvcGVydGllc1xyXG4gICAgICAgIHZhciBjb25maWdQcm9wZXJ0aWVzID0gZ2V0Q29uZmlnUHJvcGVydGllcygpO1xyXG5cclxuICAgICAgICBjb25maWdQcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24oY29uZmlnUHJvcCkge1xyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gcGVyZm9ybUNoZWNrKGNvbmZpZ1Byb3ApO1xyXG5cclxuICAgICAgICAgICAgaWYgKHJlc3VsdCAhPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgZmFpbGVkQ2hlY2tzLnB1c2goY29uZmlnUHJvcCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gcmV0dXJuIHJlc3VsdFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHBhc3N3b3JkT2s6IGZhaWxlZENoZWNrcy5sZW5ndGggPT09IDAsXHJcbiAgICAgICAgICAgIGZhaWxlZENoZWNrczogZmFpbGVkQ2hlY2tzXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5zZXRDb25maWcgPSBmdW5jdGlvbihfY29uZmlnKSB7XHJcbiAgICAgICAgY29uZmlndXJhdGlvbiA9IF9jb25maWc7XHJcbiAgICB9O1xyXG5cclxuICAgIHRoaXMuZ2V0Q29uZmlnID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGNvbmZpZ3VyYXRpb24gfHwgZGVmYXVsdENvbmZpZztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGlzQ29uZmlnUHJvcGVydHlTZXQgPSBmdW5jdGlvbihwcm9wKSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBzZWxmLmdldENvbmZpZygpW3Byb3BdICE9PSAndW5kZWZpbmVkJztcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGdldENvbmZpZ1Byb3BlcnRpZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoc2VsZi5nZXRDb25maWcoKSk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBnZXRDb25maWdQcm9wZXJ0eSA9IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICByZXR1cm4gc2VsZi5nZXRDb25maWcoKVtwcm9wXTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHBlcmZvcm1DaGVjayA9IGZ1bmN0aW9uKHByb3ApIHtcclxuICAgICAgICBpZiAodHlwZW9mIHNlbGYuaW5wdXQgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBwcm9wZXJ0eVZhbHVlID0gZ2V0Q29uZmlnUHJvcGVydHkocHJvcCk7XHJcblxyXG4gICAgICAgIGlmICghcHJvcGVydHlWYWx1ZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHN3aXRjaCAocHJvcCkge1xyXG4gICAgICAgICAgICBjYXNlICdtaW5MZW5ndGgnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaW5wdXQubGVuZ3RoID49IHByb3BlcnR5VmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlICdtYXhMZW5ndGgnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuaW5wdXQubGVuZ3RoIDw9IHByb3BlcnR5VmFsdWU7XHJcblxyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICBjYXNlICdsb3dlcmNhc2VDaGFycyc6XHJcbiAgICAgICAgICAgICAgICB2YXIgbnVtTG93ZXIgPSBzZWxmLmlucHV0Lmxlbmd0aCAtIHNlbGYuaW5wdXQucmVwbGFjZSgvW2Etel0vZywgJycpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVtTG93ZXIgPj0gcHJvcGVydHlWYWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgIGNhc2UgJ3VwcGVyY2FzZUNoYXJzJzpcclxuICAgICAgICAgICAgICAgIHZhciBudW1VcHBlciA9IHNlbGYuaW5wdXQubGVuZ3RoIC0gc2VsZi5pbnB1dC5yZXBsYWNlKC9bQS1aXS9nLCAnJykubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1VcHBlciA+PSBwcm9wZXJ0eVZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnc3BlY2lhbENoYXJzJzpcclxuICAgICAgICAgICAgICAgIHZhciBudW1TcGVjaWFscyA9IHNlbGYuaW5wdXQubGVuZ3RoIC0gc2VsZi5pbnB1dC5yZXBsYWNlKC9bIUDCpyQlJiNeKl86Oy4sK1wiJ2DCtFxce1xcfVxcKFxcKVxcW1xcXVxcL1xcXFwtXS9nLCAnJykubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiBudW1TcGVjaWFscyA+PSBwcm9wZXJ0eVZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgY2FzZSAnbnVtZXJpY0NoYXJzJzpcclxuICAgICAgICAgICAgICAgIHZhciBudW1OdW1iZXJzID0gc2VsZi5pbnB1dC5sZW5ndGggLSBzZWxmLmlucHV0LnJlcGxhY2UoL1swLTldL2csICcnKS5sZW5ndGg7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bU51bWJlcnMgPj0gcHJvcGVydHlWYWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcblxyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn07XHJcblxyXG5QYXNzd29yZFJlcXVpcmVtZW50c1ZhbGlkYXRvci5DT05GSUdfUFJPUEVSVElFUyA9IFtcclxuICAgICdtaW5MZW5ndGgnLCAgICAgICAgLy8gbWluaW11bSBsZW5ndGggb2YgcGFzc3dvcmRcclxuICAgICdtYXhMZW5ndGgnLCAgICAgICAgLy8gbWF4aW11bSBsZW5ndGggb2YgcGFzc3dvcmQgKHVuZGVmaW5lZCBmb3Igbm8gbWF4aW11bSBsZW5ndGgpXHJcbiAgICAnbG93ZXJjYXNlQ2hhcnMnLCAgIC8vIG51bWJlciBvZiBtYW5kYXRvcnkgbG93ZXJjYXNlIGNoYXJhY3RlcnNcclxuICAgICd1cHBlcmNhc2VDaGFycycsICAgLy8gbnVtYmVyIG9mIG1hbmRhdG9yeSB1cHBlcmNhc2UgY2hhcmFjdGVyc1xyXG4gICAgJ3NwZWNpYWxDaGFycycsICAgICAvLyBudW1iZXIgb2YgbWFuZGF0b3J5IHNwZWNpYWwgY2hhcmFjdGVyc1xyXG4gICAgJ251bWVyaWNDaGFycycgICAgICAgLy8gbnVtYmVyIG9mIG1hbmRhdG9yeSBudW1iZXIgY2hhcmFjdGVyc1xyXG5dO1xyXG5cclxuaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnICYmIG1vZHVsZS5leHBvcnRzKSB7XHJcbiAgICBtb2R1bGUuZXhwb3J0cy5RdWVzdGlvbiA9IFF1ZXN0aW9uO1xyXG4gICAgbW9kdWxlLmV4cG9ydHMuUXVpeiA9IFF1aXo7XHJcbiAgICBtb2R1bGUuZXhwb3J0cy5QYXNzd29yZFJlcXVpcmVtZW50c1ZhbGlkYXRvciA9IFBhc3N3b3JkUmVxdWlyZW1lbnRzVmFsaWRhdG9yO1xyXG59IiwiYW5ndWxhci5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb25maWcoZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAvLyBlbmFibGUgSFRNTDUgcHVzaHN0YXRlXHJcbiAgICAgICAgJGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG5cclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvaG9tZScpO1xyXG5cclxuICAgICAgICB2YXIgYXV0aG9yaXplID0gZnVuY3Rpb24oQXV0aFNydiwgTG9nU3J2LCAkcSkge1xyXG4gICAgICAgICAgICByZXR1cm4gQXV0aFNydi5nZXRVc2VyKClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHVzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdXNlcjtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxLnJlamVjdCgnTm90IGF1dGhvcml6ZWQnKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9ob21lJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2hvbWUucGFydGlhbC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ3F1aXonLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvcXVpeicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9xdWl6LnBhcnRpYWwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aDogYXV0aG9yaXplXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2NvdW50cmllcycsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9jb3VudHJpZXMucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdjb3VudHJpZXMuZGV0YWlsJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnLzphbHBoYTNDb2RlJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2NvdW50cmllcy1kZXRhaWwucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdsb2dpbicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9sb2dpbicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9sb2dpbi5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnbG9nb3V0Jywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2xvZ291dCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnTG9nb3V0Q3RybCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdyZWdpc3RlcicsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9yZWdpc3RlcicsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9yZWdpc3Rlci5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnc2V0dGluZ3MnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2V0dGluZ3MnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvc2V0dGluZ3MucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdwYXNzd29yZCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9wYXNzd29yZCcsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9wYXNzd29yZC1jaGFuZ2UucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdyZXNldCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9wYXNzd29yZC9yZXNldC86dG9rZW4nLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvcGFzc3dvcmQtcmVzZXQucGFydGlhbC5odG1sJ1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuc3RhdGUoJ2ZvcmdvdCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9wYXNzd29yZC9mb3Jnb3QnLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvcGFzc3dvcmQtZm9yZ290LnBhcnRpYWwuaHRtbCdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdhYm91dCcsIHtcclxuICAgICAgICAgICAgICAgIHVybDogJy9hYm91dCcsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9hYm91dC5wYXJ0aWFsLmh0bWwnXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnaGlnaHNjb3JlJywge1xyXG4gICAgICAgICAgICAgICAgdXJsOiAnL2hpZ2hzY29yZScsXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9idWlsZC92aWV3cy9wYXJ0aWFscy9oaWdoc2NvcmUucGFydGlhbC5odG1sJyxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBhdXRoOiBhdXRob3JpemVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLnN0YXRlKCdmYXEnLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvZmFxJyxcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2J1aWxkL3ZpZXdzL3BhcnRpYWxzL2ZhcS5wYXJ0aWFsLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcGFyYW1zOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBudWxsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5zdGF0ZSgnY291bnRyaWVzLWRpZmZpY3VsdHknLCB7XHJcbiAgICAgICAgICAgICAgICB1cmw6ICcvY291bnRyaWVzLWRpZmZpY3VsdHknLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcvYnVpbGQvdmlld3MvcGFydGlhbHMvY291bnRyeS1kaWZmaWN1bHR5LnBhcnRpYWwuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aDogYXV0aG9yaXplXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignQ291bnRyaWVzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgQ291bnRyeVNydikge1xyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUxldHRlciA9IG51bGw7XHJcbiAgICAgICAgdmFyIGNvdW50cnlLZXlzID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY291bnRyaWVzQnlMZXR0ZXIgPSBDb3VudHJ5U3J2LmdldENvdW50cmllc0J5TGV0dGVyKCk7XHJcbiAgICAgICAgICAgIGNvdW50cnlLZXlzID0gT2JqZWN0LmtleXMoY291bnRyaWVzQnlMZXR0ZXIpLnNvcnQoKTtcclxuXHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cnlLZXlzID0gY291bnRyeUtleXM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllc0J5TGV0dGVyID0gY291bnRyaWVzQnlMZXR0ZXI7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5jb3VudHJ5S2V5cyA9IGNvdW50cnlLZXlzO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvdW50cmllc0J5TGV0dGVyID0gY291bnRyaWVzQnlMZXR0ZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBpZiAoQ291bnRyeVNydi5hcmVDb3VudHJpZXNMb2FkZWQoKSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjb3VudHJpZXMubG9hZGVkJywgZnVuY3Rpb24oKSAge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignQ291bnRyeURldGFpbEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIENvdW50cnlTcnYsICRzdGF0ZVBhcmFtcykge1xyXG4gICAgICAgIHZhciBhbHBoYTNDb2RlID0gJHN0YXRlUGFyYW1zLmFscGhhM0NvZGU7XHJcblxyXG4gICAgICAgIGlmIChDb3VudHJ5U3J2LmFyZUNvdW50cmllc0xvYWRlZCgpKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzQ29kZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjb3VudHJpZXMubG9hZGVkJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuY291bnRyeSA9IENvdW50cnlTcnYuZ2V0Q291bnRyeUJ5QWxwaGEzKGFscGhhM0NvZGUpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyeUZyb21TZXJ2aWNlID0gZnVuY3Rpb24oYWxwaGEzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBDb3VudHJ5U3J2LmdldENvdW50cnlCeUFscGhhMyhhbHBoYTMpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRDb3VudHJ5RnJvbVNlcnZpY2UgPSBnZXRDb3VudHJ5RnJvbVNlcnZpY2U7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignQ291bnRyeURpZmZpY3VsdHlDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBDb3VudHJ5U3J2KSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIGNvdW50cmllcyA9IENvdW50cnlTcnYuZ2V0Q291bnRyaWVzKCk7XHJcbiAgICAgICAgICAgIHZhciBkaWZmaWN1bHRpZXMgPSB7XHJcbiAgICAgICAgICAgICAgICAnZWFzeSc6IFtdLFxyXG4gICAgICAgICAgICAgICAgJ21lZGl1bSc6IFtdLFxyXG4gICAgICAgICAgICAgICAgJ2hhcmQnOiBbXSxcclxuICAgICAgICAgICAgICAgICd1bmFzc2lnbmVkJzogW11cclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIGRldGVybWluZSBkaWZmaWN1bHR5XHJcbiAgICAgICAgICAgIGNvdW50cmllcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBiLnBvcHVsYXRpb24gLSBhLnBvcHVsYXRpb247XHJcbiAgICAgICAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24oYykge1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICBkaWZmaWN1bHRpZXNbYy5kaWZmaWN1bHR5XS5wdXNoKGMpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmRpZmZpY3VsdGllcyA9IGRpZmZpY3VsdGllcztcclxuICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHR5S2V5cyA9IE9iamVjdC5rZXlzKGRpZmZpY3VsdGllcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5kaWZmaWN1bHRpZXMgPSBkaWZmaWN1bHRpZXM7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmRpZmZpY3VsdHlLZXlzID0gT2JqZWN0LmtleXMoZGlmZmljdWx0aWVzKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgaWYgKENvdW50cnlTcnYuYXJlQ291bnRyaWVzTG9hZGVkKCkpIHtcclxuICAgICAgICAgICAgaW5pdCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignY291bnRyaWVzLmxvYWRlZCcsIGZ1bmN0aW9uKGV2ZW50LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGluaXQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdEcm9wZG93bkN0cmwnLCBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgICAgICB2YXIgdmlzaWJsZSA9IGZhbHNlO1xyXG5cclxuICAgICAgICAkc2NvcGUudG9nZ2xlRHJvcGRvd24gPSB0b2dnbGVEcm9wZG93bjtcclxuICAgICAgICAkc2NvcGUuc2hvd0Ryb3Bkb3duID0gc2hvd0Ryb3Bkb3duO1xyXG4gICAgICAgICRzY29wZS5oaWRlRHJvcGRvd24gPSBoaWRlRHJvcGRvd247XHJcbiAgICAgICAgJHNjb3BlLmlzRHJvcGRvd25WaXNpYmxlID0gaXNEcm9wZG93blZpc2libGU7XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2NsaWNrLm91dHNpZGUnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoaXNEcm9wZG93blZpc2libGUoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZURyb3Bkb3duKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpZGVEcm9wZG93bigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHRvZ2dsZURyb3Bkb3duKCkge1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gIXZpc2libGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzaG93RHJvcGRvd24oKSB7XHJcbiAgICAgICAgICAgIHZpc2libGUgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaGlkZURyb3Bkb3duKCkge1xyXG4gICAgICAgICAgICB2aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpc0Ryb3Bkb3duVmlzaWJsZSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2libGU7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0ZhcUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIExvZ1NydiwgJHN0YXRlUGFyYW1zKSB7XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICAvLyBjaGVjayBzdGF0ZSBwYXJhbXNcclxuICAgICAgICBpZiAoJHN0YXRlUGFyYW1zLmFjdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gJHN0YXRlUGFyYW1zLmFjdGlvbjtcclxuXHJcbiAgICAgICAgICAgIHN3aXRjaCAoYWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdyZWdpc3Rlci5zdWNjZXNzZnVsJzpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnR3JhdHVsYXRpb24hIERpZSBBbm1lbGR1bmcgd2FyIGVyZm9sZ3JlaWNoLiBIZXJ6bGljaCB3aWxsa29tbWVuIGJlaSBNYWdlbGxhbi4nXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignRm9yZ290Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgVXNlclNydiwgTG9nU3J2LCBGb2N1c1Nydikge1xyXG4gICAgICAgICRzY29wZS5wYXNzT2JqID0ge307XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7fTtcclxuXHJcbiAgICAgICAgdmFyIGZvcmdvdFBhc3N3b3JkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghJHNjb3BlLnBhc3NPYmouZW1haWwpIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbicpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBVc2VyU3J2LmZvcmdvdFBhc3N3b3JkKHtcclxuICAgICAgICAgICAgICAgIGVtYWlsOiAkc2NvcGUucGFzc09iai5lbWFpbFxyXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWxpZGl0eSA9IGRhdGEudmFsaWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHZhbGlkVGV4dCA9IHZhbGlkaXR5ICE9PSB1bmRlZmluZWQgPyBcIiBEZXIgTGluayBpc3QgXCIgKyB2YWxpZGl0eSArIFwiIFN0dW5kZW4gbGFuZyBnw7xsdGlnLlwiIDogXCJcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdzdWNjZXNzJywgJ0RhcyBFLU1haWwgd3VyZGUgZXJmb2xncmVpY2ggdmVyc2FuZHQuJyArIHZhbGlkVGV4dCk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVyci5tZXNzYWdlID09PSBcIk5vIHVzZXIgd2l0aCB0aGlzIGUtbWFpbCBhZGRyZXNzIGZvdW5kXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdFcyB3dXJkZSBrZWluIEJlbnV0emVyIG1pdCBkaWVzZXIgRS1NYWlsLUFkcmVzc2UgZ2VmdW5kZW4nKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnQmVpbSBWZXJzZW5kZW4gZGVzIExpbmtzIGlzdCBldHdhcyBzY2hpZWZnZWdhbmdlbicpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVsZWdhdGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZm9yZ290UGFzc3dvcmQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc2V0TWVzc2FnZSA9IGZ1bmN0aW9uKHR5cGUsIHRleHQpIHtcclxuICAgICAgICAgICAgaWYgKCRzY29wZS4kJHBoYXNlKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IHRleHRcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBGb2N1c1NydignI2VtYWlsJyk7XHJcblxyXG4gICAgICAgICRzY29wZS5mb3Jnb3RQYXNzd29yZCA9IGZvcmdvdFBhc3N3b3JkO1xyXG4gICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0hpZ2hzY29yZUN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFNjb3JlU3J2LCBMb2dTcnYpIHtcclxuICAgICAgICAkc2NvcGUuc2NvcmVMaXN0ID0gW107XHJcblxyXG4gICAgICAgICRzY29wZS5pc0RhdGFMb2FkaW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgU2NvcmVTcnYuZ2V0SGlnaHNjb3JlTGlzdCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGxpc3QpIHtcclxuICAgICAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5zY29yZUxpc3QgPSBjcmVhdGVSYW5raW5nKGxpc3QpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuc2NvcmVMaXN0ID0gY3JlYXRlUmFua2luZyhsaXN0KTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBzZXRMb2FkaW5nU3RhdGUoZmFsc2UpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZXRMb2FkaW5nU3RhdGUoZmFsc2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdmFyIHNldExvYWRpbmdTdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmlzRGF0YUxvYWRpbmcgPSBzdGF0ZTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmlzRGF0YUxvYWRpbmcgPSBzdGF0ZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGlzTXlzZWxmID0gZnVuY3Rpb24oaWQpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS51c2VyLl9pZCA9PT0gaWQ7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNyZWF0ZVJhbmtpbmcgPSBmdW5jdGlvbihsaXN0KSB7XHJcbiAgICAgICAgICAgIHZhciByYW5rID0gMDtcclxuXHJcbiAgICAgICAgICAgIHZhciBwcmV2aW91c1Njb3JlID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIGxpc3QuZm9yRWFjaChmdW5jdGlvbihlbnRyeSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFwcmV2aW91c1Njb3JlIHx8IGVudHJ5LnNjb3JlICE9PSBwcmV2aW91c1Njb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmFuaysrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBlbnRyeS5yYW5rID0gcmFuayArICcuJztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBwcmV2aW91c1Njb3JlID0gZW50cnkuc2NvcmU7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGxpc3Q7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmlzTXlzZWxmID0gaXNNeXNlbGY7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignTG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2LCBGb2N1c1Nydikge1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIFVzZXJTcnYubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGluZm9ybSBhcHBsaWNhdGlvbiBjb250cm9sIGFib3V0IGxvZ2luIGV2ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdhcHAubG9naW4nLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZVRleHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChlcnIuc3RhdHVzID09PSA0MDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRmFsc2NoZXIgQmVudXR6ZXJuYW1lIG9kZXIgUGFzc3dvcnQnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0JlaW0gRWlubG9nZ2VuIHNjaGVpbnQgZXR3YXMgc2NoaWVmIGdlZ2FuZ2VuIHp1IHNlaW4nO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIGZvY3VzIHVzZXJuYW1lIGZpZWxkXHJcbiAgICAgICAgRm9jdXNTcnYoJyN1c2VybmFtZScpO1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ291dEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTcnYpIHtcclxuICAgICAgICBVc2VyU3J2LmxvZ291dCgpXHJcbiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gaW5mb3JtIGFwcGxpY2F0aW9uIGNvbnRyb2wgYWJvdXQgbG9nb3V0IGV2ZW50XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGVtaXQoJ2FwcC5sb2dvdXQnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignTWFwQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSkge1xyXG5cclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdQYXNzd29yZEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFVzZXJTcnYsIExvZ1NydiwgRm9jdXNTcnYpIHtcclxuICAgICAgICAkc2NvcGUucGFzc09iaiA9IHt9O1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0ge307XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQYXNzd29yZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoISRzY29wZS5wYXNzT2JqLm9sZCB8fCAhJHNjb3BlLnBhc3NPYmoubmV3IHx8ICEkc2NvcGUucGFzc09iai5jb25maXJtYXRpb24pIHtcclxuICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCRzY29wZS5wYXNzT2JqLm5ldyAhPT0gJHNjb3BlLnBhc3NPYmouY29uZmlybWF0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdEaWUgUGFzc3fDtnJ0ZXIgc3RpbW1lbiBuaWNodCDDvGJlcmVpbicpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgVXNlclNydi51cGRhdGVQYXNzd29yZCh7XHJcbiAgICAgICAgICAgICAgICBvbGQ6ICRzY29wZS5wYXNzT2JqLm9sZCxcclxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiAkc2NvcGUucGFzc09iai5uZXdcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdzdWNjZXNzJywgJ0RhcyBuZXVlIFBhc3N3b3J0IHd1cmRlIGVyZm9sZ3JlaWNoIGdlc3BlaWNoZXJ0Jyk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVyci5tZXNzYWdlID09PSBcIk9sZCBwYXNzd29yZCBpbmNvcnJlY3RcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0RhcyBhbHRlIFBhc3N3b3J0IGlzdCBuaWNodCBrb3JyZWt0Jyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldE1lc3NhZ2UoJ2Vycm9yJywgJ0RhcyBuZXVlIFBhc3N3b3J0IGtvbm50ZSBuaWNodCBnZXNwZWljaGVydCB3ZXJkZW4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGRlbGVnYXRlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHVwZGF0ZVBhc3N3b3JkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNldE1lc3NhZ2UgPSBmdW5jdGlvbih0eXBlLCB0ZXh0KSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgRm9jdXNTcnYoJyNwYXNzd29yZC1jdXJyZW50Jyk7XHJcblxyXG4gICAgICAgICRzY29wZS51cGRhdGVQYXNzd29yZCA9IHVwZGF0ZVBhc3N3b3JkO1xyXG4gICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG4gICAgfSk7IiwiXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdRdWl6RGlyZWN0aXZlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzY29wZSwgUXVpelNydiwgTG9nU3J2LCBGb2N1c1NydiwgbmdQcm9ncmVzc0ZhY3RvcnksICRmaWx0ZXIpIHtcclxuICAgICAgICB2YXIgcXVlc3Rpb247XHJcblxyXG4gICAgICAgIHZhciBpbml0Q3RybCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyBQcm9ncmVzcyBiYXIgaW5pdGlhbGl6YXRpb25cclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyID0gbmdQcm9ncmVzc0ZhY3RvcnkuY3JlYXRlSW5zdGFuY2UoKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldFBhcmVudChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncXVpei1wcm9ncmVzcycpKTtcclxuICAgICAgICAgICAgJHNjb3BlLnByb2dyZXNzYmFyLnNldEFic29sdXRlKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5wcm9ncmVzc2Jhci5zZXRDb2xvcihcIiMzMzZlN2JcIik7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgJHNjb3BlLmFjaGlldmVtZW50cyA9IFtdO1xyXG4gICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dCA9IHt9O1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgb3B0aW9ucyBmb3IgbXVsdGlwbGllciBzZWxlY3Rpb25cclxuICAgICAgICAgICAgJHNjb3BlLm11bHRpcGxpZXJPcHRpb25zID0gW1xyXG4gICAgICAgICAgICAgICAgeyB2YWx1ZTogMSwgbGFiZWw6ICcnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfSxcclxuICAgICAgICAgICAgICAgIHsgdmFsdWU6IDEwMDAwMDAsIGxhYmVsOiAnTWlvLid9XHJcbiAgICAgICAgICAgIF07XHJcblxyXG4gICAgICAgICAgICBxdWVzdGlvbiA9IG51bGw7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHVwZGF0ZVVpID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIC8vIGdldCBjdXJyZW50IHF1ZXN0aW9uIGZyb20gcXVpeiBzZXJ2aWNlXHJcbiAgICAgICAgICAgIHF1ZXN0aW9uID0gUXVpelNydi5nZXRDdXJyZW50UXVlc3Rpb24oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSBwcmV2aW91cyBoaW50c1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IG51bGw7XHJcblxyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24gIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIC8vIG11bHRpcGxpZXJzIGZvciBxdWVzdGlvbnMgY29udGFpbmluZyBudW1iZXJzXHJcbiAgICAgICAgICAgICAgICBpZiAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0ICYmIHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dC5pbmRleE9mKCdudW1iZXInKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAocXVlc3Rpb24uZ2V0SW5mbygpLmlucHV0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5oaWdoJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMTAwMDAwMCwgbGFiZWw6ICdNaW8uJ307XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ251bWJlci5tZWRpdW0nOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0Lm11bHRpcGxpZXIgPSB7IHZhbHVlOiAxMDAwLCBsYWJlbDogJ1RzZC4nfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0geyB2YWx1ZTogMSwgbGFiZWw6ICcnIH07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyB1cGRhdGUgcHJvZ3Jlc3MgYmFyXHJcbiAgICAgICAgICAgICAgICB1cGRhdGVQcm9ncmVzc0JhcigpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGZvY3VzIGFuc3dlciBpbnB1dFxyXG4gICAgICAgICAgICAgICAgRm9jdXNTcnYoJy5hbnN3ZXJJbnB1dCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBxdWVzdGlvbjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmdldEN1cnJlbnRRdWVzdGlvbk51bWJlcigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHJlbmRlclF1ZXN0aW9uVGV4dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVuZGVyKGdldFF1ZXN0aW9uKCkucXVlc3Rpb24oKSwgJ3F1ZXN0aW9uLWhpZ2hsaWdodCcpICsgJz8nO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRRdWVzdGlvbk1lZGlhID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghcXVlc3Rpb24gfHwgIXF1ZXN0aW9uLmdldEluZm8oKS5tZWRpYSlcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uLmdldEluZm8oKS5tZWRpYTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgc2hvd1Jlc3VsdHNQYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5pc1Jlc3VsdHNQYWdlVmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhpZGVSZXN1bHRzUGFnZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5pc1Jlc3VsdHNQYWdlVmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXNSZXN1bHRzUGFnZVZpc2libGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGhpbnRzQXZhaWxhYmxlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWVzdGlvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAocXVlc3Rpb24uaGludHNSZW1haW5pbmcoKSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVlc3Rpb24uaGludHNSZW1haW5pbmcoKSA+IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHN1Ym1pdEFuc3dlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmFuc3dlcklucHV0LmFuc3dlciAmJiAhcXVlc3Rpb24uYW5zd2VyZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgLy8gdHJhbnNmb3JtIHN1Ym1pdHRlZCBhbnN3ZXIgdG8gU3RyaW5nIGFuZCB0cmltIGFueSB3aGl0ZXNwYWNlcyBhdCB0aGUgYmVnaW4gb3IgZW5kIG9mIHRoZSBhbnN3ZXJcclxuICAgICAgICAgICAgICAgIHZhciBhbnN3ZXIgPSBTdHJpbmcoJHNjb3BlLmFuc3dlcklucHV0LmFuc3dlcikudHJpbSgpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGlmIGl0IGlzIGEgbnVtYmVyIGlucHV0LCByZXBsYWNlICcsJyB3aXRoICcuJ1xyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uLmdldEluZm8oKS5pbnB1dCAmJiBxdWVzdGlvbi5nZXRJbmZvKCkuaW5wdXQuaW5kZXhPZignbnVtYmVyJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBhbnN3ZXIgPSBhbnN3ZXIucmVwbGFjZSgnLCcsICcuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gaWYgYSBtdWx0aXBsaWVyIGlzIGF2YWlsYWJsZSwgY2FsY3VsYXRlIGFuc3dlclxyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYW5zd2VyICo9ICRzY29wZS5hbnN3ZXJJbnB1dC5tdWx0aXBsaWVyLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICRzY29wZS5hbnN3ZXJJbnB1dC5wb2ludHMgPSBxdWVzdGlvbi5hbnN3ZXIoYW5zd2VyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBzZXQgZm9jdXNcclxuICAgICAgICAgICAgICAgIGlmICghd2FzTGFzdFF1ZXN0aW9uKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bk5leHRRdWVzdGlvbicpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBGb2N1c1NydignI2J0bkNvbnRpbnVlRmluaXNoZWQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBxdWVzdGlvbkFuc3dlcmVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghUXVpelNydi5pc1F1aXpSdW5uaW5nKCkgfHwgcXVlc3Rpb24gPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1ZXN0aW9uLmFuc3dlcmVkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIG5leHRRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBRdWl6U3J2Lm5leHRRdWVzdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLmFuc3dlcklucHV0LmFuc3dlciA9IFwiXCI7XHJcblxyXG4gICAgICAgICAgICB1cGRhdGVVaSgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXF1ZXN0SGludCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaGludCA9IHF1ZXN0aW9uLmhpbnQoKTtcclxuXHJcbiAgICAgICAgICAgIEZvY3VzU3J2KCcuYW5zd2VySW5wdXQnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVuZGVyID0gZnVuY3Rpb24odGV4dCwgY2xhc3NOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIltcIiwgXCI8c3BhbiBjbGFzcz0nXCIgKyBjbGFzc05hbWUgKyBcIic+XCIpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZShcIl1cIiwgXCI8L3NwYW4+XCIpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYW5kbGVLZXlQcmVzcyA9IGZ1bmN0aW9uKGtleUV2ZW50KSB7XHJcbiAgICAgICAgICAgIGlmIChrZXlFdmVudC53aGljaCA9PSAxMykge1xyXG4gICAgICAgICAgICAgICAgc3VibWl0QW5zd2VyKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlUHJvZ3Jlc3NCYXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyIHByb2dyZXNzUGVyY2VudCA9IGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcigpIC8gZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zKCkgKiAxMDA7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUucHJvZ3Jlc3NiYXIuc2V0KHByb2dyZXNzUGVyY2VudCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHdhc0xhc3RRdWVzdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyKCkgPj0gZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHBhcnNlRXZlbnRzID0gZnVuY3Rpb24oZXZlbnRzLCBwZXJzb25hbEJlc3QsIG92ZXJhbGxCZXN0KSB7XHJcbiAgICAgICAgICAgIHZhciBhY2hpZXZlbWVudHMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzaG93QmVzdHMgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdvdmVyYWxsX2Jlc3QnKSA+PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBhY2hpZXZlbWVudHMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0R1IGhhc3QgZWluZW4gbmV1ZW4gYWJzb2x1dGVuIFJla29yZCBnZXNjaGFmZnQhJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2hvd0Jlc3RzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChldmVudHMuaW5kZXhPZignb3ZlcmFsbF9iZXN0X2VxdWFsaXNlZCcpID49IDApIHtcclxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRHUgaGFzdCBkZW4gYWt0dWVsbGVuIGFic29sdXRlbiBSZWtvcmQgZWluZ2VzdGVsbHQhJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2hvd0Jlc3RzID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmIChldmVudHMuaW5kZXhPZigncGVyc29uYWxfYmVzdCcpID49IDAgJiYgZXZlbnRzLmluZGV4T2YoJ292ZXJhbGxfYmVzdCcpIDwgMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGVpbmVuIG5ldWVuIHBlcnPDtm5saWNoZW4gUmVrb3JkIGdlc2NoYWZmdCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCdwZXJzb25hbF9iZXN0X2VxdWFsaXNlZCcpID49IDAgJiYgZXZlbnRzLmluZGV4T2YoJ292ZXJhbGxfYmVzdF9lcXVhbGlzZWQnKSA8IDApIHtcclxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50cy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRHUgaGFzdCBnbGVpY2ggdmllbGUgUHVua3RlIGdlc2NoYWZmdCB3aWUgYmVpIGRlaW5lbSBwZXJzw7ZubGljaGVuIFJla29yZCEnXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzaG93QmVzdHMgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGV2ZW50cy5pbmRleE9mKCduZXdfZGFpbHlfYmVzdCcpID49IDAgJiYgYWNoaWV2ZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgYWNoaWV2ZW1lbnRzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEdSBoYXN0IGVpbmVuIG5ldWVuIHBlcnPDtm5saWNoZW4gVGFnZXNyZWtvcmQgZ2VzY2hhZmZ0ISdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5hY2hpZXZlbWVudHMgPSBhY2hpZXZlbWVudHM7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5hY2hpZXZlbWVudHMgPSBhY2hpZXZlbWVudHM7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHNob3dCZXN0cyAmJiBwZXJzb25hbEJlc3QgJiYgcGVyc29uYWxCZXN0LmlkICYmIHBlcnNvbmFsQmVzdC5kYXRlICYmIHBlcnNvbmFsQmVzdC5zY29yZSAmJiBvdmVyYWxsQmVzdCAmJiBvdmVyYWxsQmVzdC5pZCAmJiBvdmVyYWxsQmVzdC5kYXRlICYmIG92ZXJhbGxCZXN0LnNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgYmVzdHMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICBvdmVyYWxsQmVzdC50eXBlID0gJ292ZXJhbGwnO1xyXG4gICAgICAgICAgICAgICAgYmVzdHMucHVzaChvdmVyYWxsQmVzdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHBlcnNvbmFsQmVzdC5pZCAhPT0gb3ZlcmFsbEJlc3QuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBwZXJzb25hbEJlc3QudHlwZSA9ICdwZXJzb25hbCc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGJlc3RzLnB1c2gocGVyc29uYWxCZXN0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBiZXN0cztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLmJlc3RzID0gYmVzdHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYmVzdHMgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNvbnRpbnVlRmluaXNoZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gcXVpeiBoYXMgZW5kZWQsIHNldCBwcm9ncmVzcyBiYXIgdG8gMFxyXG4gICAgICAgICAgICAkc2NvcGUucHJvZ3Jlc3NiYXIuc2V0KDApO1xyXG5cclxuICAgICAgICAgICAgc2hvd1Jlc3VsdHNQYWdlKCk7XHJcblxyXG4gICAgICAgICAgICBuZXh0UXVlc3Rpb24oKTtcclxuXHJcbiAgICAgICAgICAgIC8vIGNvbmNsdWRlIHRoZSBxdWl6IGFuZCB3cml0ZSByZXN1bHQgdG8gZGF0YWJhc2VcclxuICAgICAgICAgICAgUXVpelNydi5jb25jbHVkZSgpXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VFdmVudHMoZGF0YS5ldmVudHMgfHwgW10sIGRhdGEucGVyc29uYWxCZXN0LCBkYXRhLm92ZXJhbGxCZXN0KTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgTG9nU3J2LmVycm9yKGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0QmVzdFRleHQgPSBmdW5jdGlvbihiZXN0KSB7XHJcbiAgICAgICAgICAgIHZhciB0ZXh0O1xyXG5cclxuICAgICAgICAgICAgaWYgKGJlc3QudHlwZSA9PT0gJ3BlcnNvbmFsJykge1xyXG4gICAgICAgICAgICAgICAgLy8gcGVyc29uYWwgYmVzdFxyXG4gICAgICAgICAgICAgICAgdGV4dCA9IFwiRGVpbiBwZXJzw7ZubGljaGVyIFJla29yZCBsaWVndCBiZWkgPHNwYW4gY2xhc3M9J2JvbGQnPntQT0lOVFN9IFB1bmt0ZW48L3NwYW4+LCBhdWZnZXN0ZWxsdCBhbSB7REFURX0uXCI7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBvdmVyYWxsIGJlc3RcclxuICAgICAgICAgICAgICAgIHZhciBmcm9tTXlzZWxmID0gYmVzdC5pZCA9PT0gJHNjb3BlLnVzZXIuX2lkO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChmcm9tTXlzZWxmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dCA9IFwiRHUgaMOkbHRzdCBkZW4gYWJzb2x1dGVuIFJla29yZCBtaXQgPHNwYW4gY2xhc3M9J2JvbGQnPntQT0lOVFN9IFB1bmt0ZW48L3NwYW4+LCBhdWZnZXN0ZWxsdCBhbSB7REFURX0uXCI7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSBcIjxzcGFuIGNsYXNzPSdoaWdobGlnaHQnPntVU0VSTkFNRX08L3NwYW4+IGjDpGx0IGRlbiBhYnNvbHV0ZW4gUmVrb3JkIG1pdCA8c3BhbiBjbGFzcz0nYm9sZCc+e1BPSU5UU30gUHVua3Rlbjwvc3Bhbj4sIGF1Zmdlc3RlbGx0IGFtIHtEQVRFfS5cIjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSgne1BPSU5UU30nLCAkZmlsdGVyKCdudW1iZXInKShiZXN0LnNjb3JlKSlcclxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKCd7REFURX0nLCBnZXRGb3JtYXR0ZWREYXRlKGJlc3QuZGF0ZSkpXHJcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgne1VTRVJOQU1FfScsIGJlc3QudXNlcm5hbWUpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRGb3JtYXR0ZWREYXRlID0gZnVuY3Rpb24oZGF0ZSkge1xyXG4gICAgICAgICAgICBkYXRlID0gbmV3IERhdGUoZGF0ZSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcGFkKGRhdGUuZ2V0RGF0ZSgpLCAnMDAnKSArICcuJyArIHBhZChkYXRlLmdldE1vbnRoKCkgKyAxLCAnMDAnKSArICcuJyArIChkYXRlLmdldFllYXIoKSArIDE5MDApO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBwYWQgPSBmdW5jdGlvbihzdHIsIHBhZFZhbHVlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcocGFkVmFsdWUgKyBzdHIpLnNsaWNlKC1wYWRWYWx1ZS5sZW5ndGgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXN0YXJ0UXVpeiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBxdWl6ID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS4kZW1pdCgncXVpei5yZXN0YXJ0Jyk7XHJcblxyXG4gICAgICAgICAgICBpbml0Q3RybCgpO1xyXG5cclxuICAgICAgICAgICAgdXBkYXRlVWkoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZW50ZXJMaXN0ZW5lciA9IGZ1bmN0aW9uKGtleVByZXNzLCBmdW5jKSB7XHJcbiAgICAgICAgICAgIGlmIChrZXlQcmVzcy53aGljaCA9PSAxMykge1xyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChmdW5jKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnbmV4dF9xdWVzdGlvbic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5leHRRdWVzdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29udGludWVfZmluaXNoZWQnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZUZpbmlzaGVkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3F1aXouc3RhcnQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBoaWRlUmVzdWx0c1BhZ2UoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICAvLyBjb250cm9sbGVyIGlzIGJlaW5nIGRlc3Ryb3llZCAoaS5lLiB1c2VyIGxlYXZlcyB0aGUgcGFnZSwgc28gd2UgdGVsbCB0aGUgcXVpeiBzZXJ2aWNlIHRvIGRpc3Bvc2Ugb2YgdGhlIHF1aXogb2JqZWN0XHJcbiAgICAgICAgICAgIGlmIChRdWl6U3J2Lmhhc1F1aXpTdGFydGVkKCkgJiYgUXVpelNydi5oYXNRdWl6RW5kZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgUXVpelNydi5kaXNwb3NlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gaW5pdCBjb250cm9sbGVyXHJcbiAgICAgICAgaW5pdEN0cmwoKTtcclxuXHJcbiAgICAgICAgLy8gaW5pdGlhbGx5IHVwZGF0ZSBVSVxyXG4gICAgICAgIHVwZGF0ZVVpKCk7XHJcblxyXG4gICAgICAgICRzY29wZS5nZXRRdWVzdGlvbiA9IGdldFF1ZXN0aW9uO1xyXG4gICAgICAgICRzY29wZS5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIgPSBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXI7XHJcbiAgICAgICAgJHNjb3BlLnJlbmRlclF1ZXN0aW9uVGV4dCA9IHJlbmRlclF1ZXN0aW9uVGV4dDtcclxuICAgICAgICAkc2NvcGUuc3VibWl0QW5zd2VyID0gc3VibWl0QW5zd2VyO1xyXG4gICAgICAgICRzY29wZS5xdWVzdGlvbkFuc3dlcmVkID0gcXVlc3Rpb25BbnN3ZXJlZDtcclxuICAgICAgICAkc2NvcGUubmV4dFF1ZXN0aW9uID0gbmV4dFF1ZXN0aW9uO1xyXG4gICAgICAgICRzY29wZS5oYW5kbGVLZXlQcmVzcyA9IGhhbmRsZUtleVByZXNzO1xyXG4gICAgICAgICRzY29wZS5nZXRRdWVzdGlvbk1lZGlhID0gZ2V0UXVlc3Rpb25NZWRpYTtcclxuICAgICAgICAkc2NvcGUucmVxdWVzdEhpbnQgPSByZXF1ZXN0SGludDtcclxuICAgICAgICAkc2NvcGUud2FzTGFzdFF1ZXN0aW9uID0gd2FzTGFzdFF1ZXN0aW9uO1xyXG4gICAgICAgICRzY29wZS5jb250aW51ZUZpbmlzaGVkID0gY29udGludWVGaW5pc2hlZDtcclxuICAgICAgICAkc2NvcGUuZ2V0QmVzdFRleHQgPSBnZXRCZXN0VGV4dDtcclxuICAgICAgICAkc2NvcGUucmVzdGFydFF1aXogPSByZXN0YXJ0UXVpejtcclxuICAgICAgICAkc2NvcGUuaGludHNBdmFpbGFibGUgPSBoaW50c0F2YWlsYWJsZTtcclxuICAgICAgICAkc2NvcGUuZW50ZXJMaXN0ZW5lciA9IGVudGVyTGlzdGVuZXI7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUXVpekN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIFF1aXpTcnYsIExvZ1Nydikge1xyXG5cclxuICAgICAgICB2YXIgc3RhcnRRdWl6ID0gZnVuY3Rpb24oY2IpIHtcclxuICAgICAgICAgICAgUXVpelNydi5pbml0KClcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjYiAmJiB0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGlzUXVpelJ1bm5pbmcgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuaXNRdWl6UnVubmluZygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6U3RhcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gUXVpelNydi5oYXNRdWl6U3RhcnRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6RW5kZWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFF1aXpTcnYuaGFzUXVpekVuZGVkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFRvdGFsUG9pbnRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBRdWl6U3J2LmdldFRvdGFsUG9pbnRzKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbigncXVpei5yZXN0YXJ0JywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICAgICAgUXVpelNydi5kaXNwb3NlKCk7XHJcblxyXG4gICAgICAgICAgICBzdGFydFF1aXooZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuJGJyb2FkY2FzdCgncXVpei5zdGFydCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnN0YXJ0UXVpeiA9IHN0YXJ0UXVpejtcclxuICAgICAgICAkc2NvcGUuaXNRdWl6UnVubmluZyA9IGlzUXVpelJ1bm5pbmc7XHJcbiAgICAgICAgJHNjb3BlLmhhc1F1aXpTdGFydGVkID0gaGFzUXVpelN0YXJ0ZWQ7XHJcbiAgICAgICAgJHNjb3BlLmhhc1F1aXpFbmRlZCA9IGhhc1F1aXpFbmRlZDtcclxuICAgICAgICAkc2NvcGUuZ2V0VG90YWxQb2ludHMgPSBnZXRUb3RhbFBvaW50cztcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsIExvZ1NydiwgRm9jdXNTcnYsIFVzZXJTcnYsICRzdGF0ZSwgJHdpbmRvdykge1xyXG4gICAgICAgIC8vIG5ldyB1c2VyIG9iamVjdFxyXG4gICAgICAgICRzY29wZS5uZXdVc2VyID0ge307XHJcblxyXG4gICAgICAgIC8vIG1lc3NhZ2Ugb2JqZWN0XHJcbiAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbiAoaXNWYWxpZCkge1xyXG4gICAgICAgICAgICBpZiAoIWlzVmFsaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHZhbGlkYXRlQmVmb3JlU3VibWl0KCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIHBlcmZvcm0gYXBpIGNhbGxcclxuICAgICAgICAgICAgICAgIFVzZXJTcnYucmVnaXN0ZXIoJHNjb3BlLm5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpbmZvcm0gYXBwIGNvbnRyb2xsZXIgYWJvdXQgbG9naW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnYXBwLmxvZ2luJywgcmVzcG9uc2UuZGF0YSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVkaXJlY3QgdG8gaG9tZSBwYWdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2ZhcScsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb246ICdyZWdpc3Rlci5zdWNjZXNzZnVsJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6ICdCZWkgZGVyIEFubWVsZHVuZyBzY2hlaW50IGV0d2FzIHNjaGllZiBnZWdhbmdlbiB6dSBzZWluJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChlcnIubWVzc2FnZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnVXNlcm5hbWUgYWxyZWFkeSBleGlzdHMnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RlciBCZW51dHplcm5hbWUgaXN0IGJlcmVpdHMgaW4gVmVyd2VuZHVuZyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnRW1haWwgYWRkcmVzcyBhbHJlYWR5IGV4aXN0cyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGllIEUtTWFpbC1BZHJlc3NlIGlzdCBiZXJlaXRzIGluIFZlcndlbmR1bmcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1Bhc3N3b3JkIGRvZXMgbm90IG1hdGNoIHJlcXVpcmVtZW50cyc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnRGFzIFBhc3N3b3J0IGVudHNwcmljaHQgbmljaHQgZGVuIFNpY2hlcmhlaXRzcmljaHRsaW5pZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZVRleHQgPSAnQmVpIGRlciBBbm1lbGR1bmcgc2NoZWludCBldHdhcyBzY2hpZWYgZ2VnYW5nZW4genUgc2Vpbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHNjb3BlLiQkcGhhc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiBtZXNzYWdlVGV4dFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHZhbGlkYXRlQmVmb3JlU3VibWl0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSB0d28gcGFzc3dvcmRzIG1hdGNoXHJcbiAgICAgICAgICAgIHZhciBwYXNzd29yZCA9ICRzY29wZS5uZXdVc2VyLnBhc3N3b3JkO1xyXG4gICAgICAgICAgICB2YXIgcGFzc3dvcmQyID0gJHNjb3BlLm5ld1VzZXIucGFzc3dvcmQyO1xyXG5cclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUubmV3VXNlci51c2VybmFtZSB8fCAhJHNjb3BlLm5ld1VzZXIuZW1haWwgfHwgIXBhc3N3b3JkIHx8ICFwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0FsbGUgRmVsZGVyIG3DvHNzZW4gYXVzZ2Vmw7xsbHQgc2VpbidcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFzc3dvcmQgPT09IFwiXCIgfHwgcGFzc3dvcmQyID09PSBcIlwiKSB7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEaWUgUGFzc3fDtnJ0ZXIga8O2bm5lbiBuaWNodCBsZWVyIHNlaW4nXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhc3N3b3JkICE9PSBwYXNzd29yZDIpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6ICdlcnJvcicsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0RpZSBQYXNzd8O2cnRlciBzdGltbWVuIG5pY2h0IMO8YmVyZWluJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuICEkc2NvcGUubWVzc2FnZSA/IHRydWUgOiBmYWxzZTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGVsZWdhdGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmVnaXN0ZXIodHJ1ZSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLmRlbGVnYXRlU3VibWl0ID0gZGVsZWdhdGVTdWJtaXQ7XHJcblxyXG4gICAgICAgICRzY29wZS5yZWdpc3RlciA9IHJlZ2lzdGVyO1xyXG5cclxuICAgICAgICAvLyBmb2N1cyB1c2VyIG5hbWUgZmllbGRcclxuICAgICAgICBGb2N1c1NydignI3VzZXJuYW1lJyk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuY29udHJvbGxlcignUmVzZXRDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBVc2VyU3J2LCBMb2dTcnYsIEZvY3VzU3J2LCAkc3RhdGVQYXJhbXMpIHtcclxuICAgICAgICAkc2NvcGUucGFzc09iaiA9IHt9O1xyXG4gICAgICAgICRzY29wZS5tZXNzYWdlID0ge307XHJcblxyXG4gICAgICAgIHZhciB0b2tlbiA9ICRzdGF0ZVBhcmFtcy50b2tlbjtcclxuXHJcbiAgICAgICAgdmFyIHJlc2V0UGFzc3dvcmQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCEkc2NvcGUucGFzc09iai5uZXcgfHwgISRzY29wZS5wYXNzT2JqLmNvbmZpcm1hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnQWxsZSBGZWxkZXIgbcO8c3NlbiBhdXNnZWbDvGxsdCBzZWluJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUucGFzc09iai5uZXcgIT09ICRzY29wZS5wYXNzT2JqLmNvbmZpcm1hdGlvbikge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnRGllIFBhc3N3w7ZydGVyIHN0aW1tZW4gbmljaHQgw7xiZXJlaW4nKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCF0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnS2VpbiBnw7xsdGlnZXIgWnVyw7xja3NldHplbi1MaW5rJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFVzZXJTcnYucmVzZXRQYXNzd29yZCh7XHJcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4sXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogJHNjb3BlLnBhc3NPYmoubmV3XHJcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnc3VjY2VzcycsICdEYXMgUGFzc3dvcnQgd3VyZGUgZXJmb2xncmVpY2ggZ2VzcGVpY2hlcnQnKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXJyLm1lc3NhZ2UgPT09IFwiSW52YWxpZCB0b2tlblwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0TWVzc2FnZSgnZXJyb3InLCAnRGVyIFp1csO8Y2tzZXR6ZW4tTGluayBpc3QgbGVpZGVyIG5pY2h0IG1laHIgZ8O8bHRpZycpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBzZXRNZXNzYWdlKCdlcnJvcicsICdEYXMgbmV1ZSBQYXNzd29ydCBrb25udGUgbmljaHQgZ2VzcGVpY2hlcnQgd2VyZGVuJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBkZWxlZ2F0ZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXNldFBhc3N3b3JkKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNldE1lc3NhZ2UgPSBmdW5jdGlvbih0eXBlLCB0ZXh0KSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuJCRwaGFzZSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgRm9jdXNTcnYoJyNwYXNzd29yZC1uZXcnKTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnJlc2V0UGFzc3dvcmQgPSByZXNldFBhc3N3b3JkO1xyXG4gICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmNvbnRyb2xsZXIoJ1NldHRpbmdzQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgQXBwQ29uZmlnLCBGb2N1c1NydiwgTG9nU3J2LCBVc2VyU3J2KSB7XHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgLy8gdXNlciBjb2xvdXJzXHJcbiAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcHBDb25maWdbJ3NldHRpbmdzLnVzZXIuY29sb3JzJ107XHJcblxyXG4gICAgICAgICAgICAvLyB1c2VyIG9iamVjdFxyXG4gICAgICAgICAgICAkc2NvcGUudXNlck9iaiA9IHtcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkc2NvcGUudXNlci51c2VybmFtZSxcclxuICAgICAgICAgICAgICAgIGVtYWlsOiAkc2NvcGUudXNlci5lbWFpbCxcclxuICAgICAgICAgICAgICAgIGNvbG9yOiAkc2NvcGUudXNlci5jb2xvclxyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLnVzZXJDb2xvcnMgPSBjb2xvcnM7XHJcblxyXG4gICAgICAgICAgICB2YXIgc2V0Q29sb3IgPSBmdW5jdGlvbihuZXdDb2xvcikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnVzZXJPYmouY29sb3IgPSBuZXdDb2xvcjtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciB1cGRhdGVVc2VyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBVc2VyU3J2LnVwZGF0ZUJhc2ljKCRzY29wZS51c2VyT2JqKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgdXNlciBvYmplY3RcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudXNlci51c2VybmFtZSA9ICRzY29wZS51c2VyT2JqLnVzZXJuYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS51c2VyLmVtYWlsID0gJHNjb3BlLnVzZXJPYmouZW1haWw7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnVzZXIuY29sb3IgPSAkc2NvcGUudXNlck9iai5jb2xvcjtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2UgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRWluc3RlbGx1bmdlbiB3dXJkZW4gZXJmb2xncmVpY2ggZ2VzcGVpY2hlcnQnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBMb2dTcnYuZXJyb3IoJ1VwZGF0ZSB1c2VyJywgZXJyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VUZXh0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGVyci5tZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ1VzZXJuYW1lIGFscmVhZHkgZXhpc3RzJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RlciBCZW51dHplcm5hbWUgaXN0IGJlcmVpdHMgdmVyZ2ViZW4nO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdFbWFpbCBhZGRyZXNzIGFscmVhZHkgZXhpc3RzJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VUZXh0ID0gJ0RpZSBFLU1haWwtQWRyZXNzZSBpc3QgYmVyZWl0cyB2ZXJnZWJlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlVGV4dCA9ICdEaWUgRWluc3RlbGx1bmdlbiBrb25udGVuIG5pY2h0IGdlc3BlaWNoZXJ0IHdlcmRlbic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2Vycm9yJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6IG1lc3NhZ2VUZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIHZhciBkZWxlZ2F0ZVN1Ym1pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlVXNlcih0cnVlKTtcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5zZXRDb2xvciA9IHNldENvbG9yO1xyXG4gICAgICAgICAgICAkc2NvcGUudXBkYXRlVXNlciA9IHVwZGF0ZVVzZXI7XHJcbiAgICAgICAgICAgICRzY29wZS5kZWxlZ2F0ZVN1Ym1pdCA9IGRlbGVnYXRlU3VibWl0O1xyXG5cclxuICAgICAgICAgICAgLy8gZm9jdXMgdXNlcm5hbWUgZmllbGRcclxuICAgICAgICAgICAgRm9jdXNTcnYoJyN1c2VybmFtZScpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGlmICgkc2NvcGUudXNlcikge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBvdGhlcndpc2UsIHdhaXQgZm9yIHVzZXIubG9hZGVkIGV2ZW50XHJcbiAgICAgICAgJHNjb3BlLiRvbigndXNlci5sb2FkZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xyXG4gICAgICAgICAgICBpbml0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmlsdGVyKCdyZW5kZXJIdG1sJywgZnVuY3Rpb24oJHNjZSkge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0ZXh0KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHRleHQpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KTsiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmlsdGVyKCd0ZXh0T3JOdW1iZXInLCBmdW5jdGlvbigkZmlsdGVyKSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGlucHV0LCBmcmFjdGlvblNpemUpIHtcclxuICAgICAgICAgICAgZnJhY3Rpb25TaXplID0gZnJhY3Rpb25TaXplICE9PSB1bmRlZmluZWQgPyAwIDogZnJhY3Rpb25TaXplO1xyXG5cclxuICAgICAgICAgICAgaWYgKGlzTmFOKGlucHV0KSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGlucHV0O1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRmaWx0ZXIoJ251bWJlcicpKGlucHV0LCBmcmFjdGlvblNpemUpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmRpcmVjdGl2ZSgnY2xpY2tPdXRzaWRlJywgZnVuY3Rpb24oJHBhcnNlLCAkZG9jdW1lbnQsICRyb290U2NvcGUpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgJGRvY3VtZW50LmJpbmQoJ2NsaWNrJywgY2xpY2tPdXRzaWRlSGFuZGxlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdyZW1vdmUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAkZG9jdW1lbnQudW5iaW5kKCdjbGljaycsIGNsaWNrT3V0c2lkZUhhbmRsZXIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2xpY2tPdXRzaWRlSGFuZGxlcihldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0UGFyZW50cyA9ICQoZXZlbnQudGFyZ2V0KS5wYXJlbnRzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluc2lkZSA9IHRhcmdldFBhcmVudHMuaW5kZXgoJChlbGVtZW50KSkgIT09IC0xO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvbiA9IGV2ZW50LnRhcmdldCA9PT0gZWxlbWVudFswXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb3V0c2lkZSA9ICFpbnNpZGUgJiYgIW9uO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3V0c2lkZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ2NsaWNrLm91dHNpZGUnLCBldmVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZGlyZWN0aXZlKCdtYXAnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0UnLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2J1aWxkL3ZpZXdzL3RlbXBsYXRlcy9tYXAudGVtcGxhdGUuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdNYXBDdHJsJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gbGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIHZhciBtYXAgPSBuZXcgRGF0YW1hcCh7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcC1jb250YWluZXInKSxcclxuICAgICAgICAgICAgICAgICAgICBmaWxsczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0RmlsbDogJyMyMmE3ZjAnXHJcbiAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICBnZW9ncmFwaHlDb25maWc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0T25Ib3ZlcjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9wdXBvbkhvdmVyOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRGaWxsQ29sb3I6ICcjMDE5ODc1JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0Qm9yZGVyQ29sb3I6ICdyZ2JhKDIwMCwgMjQ3LCAxOTcsIDAuNCknXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KSIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5kaXJlY3RpdmUoJ3F1aXonLCBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2J1aWxkL3ZpZXdzL3RlbXBsYXRlcy9xdWl6LWRpcmVjdGl2ZS50ZW1wbGF0ZS5odG1sJyxcclxuICAgICAgICAgICAgc2NvcGU6IHRydWUsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdRdWl6RGlyZWN0aXZlQ29udHJvbGxlcicsXHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIGxpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSkiLCIndXNlIHN0cmljdCc7XHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCdtYWdlbGxhbicpXHJcbiAgICAuZmFjdG9yeSgnQXV0aEludGVyY2VwdG9yJywgZnVuY3Rpb24oQXV0aFRva2VuU3J2KSB7XHJcbiAgICAgICAgdmFyIGFkZFRva2VuID0gZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IEF1dGhUb2tlblNydi5nZXRUb2tlbigpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRva2VuKSB7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmhlYWRlcnNbJ1gtQXV0aCddID0gdG9rZW47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb25maWc7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWVzdDogYWRkVG9rZW5cclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0F1dGhUb2tlblNydicsIGZ1bmN0aW9uKCR3aW5kb3cpIHtcclxuICAgICAgICB2YXIgc3RvcmUgPSAkd2luZG93LnNlc3Npb25TdG9yYWdlO1xyXG4gICAgICAgIHZhciBrZXkgPSAnYXV0aC10b2tlbic7XHJcblxyXG4gICAgICAgIHZhciBnZXRUb2tlbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gc3RvcmUuZ2V0SXRlbShrZXkpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBzZXRUb2tlbiA9IGZ1bmN0aW9uKHRva2VuKSB7XHJcbiAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgc3RvcmUuc2V0SXRlbShrZXksIHRva2VuKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHN0b3JlLnJlbW92ZUl0ZW0oa2V5KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldFRva2VuOiBnZXRUb2tlbixcclxuICAgICAgICAgICAgc2V0VG9rZW46IHNldFRva2VuXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdBdXRoU3J2JywgZnVuY3Rpb24oVXNlclNydikge1xyXG4gICAgICAgIHZhciB1c2VyID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIGdldFVzZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHVzZXIgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBVc2VyU3J2LmdldFVzZXJGcm9tU3RvcmFnZSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKF91c2VyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gX3VzZXI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShfdXNlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdCgnTm90IGxvZ2dlZCBpbicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIHNldFVzZXIgPSBmdW5jdGlvbihfdXNlcikge1xyXG4gICAgICAgICAgICB1c2VyID0gX3VzZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGNsZWFyVXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB1c2VyID0gbnVsbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXRVc2VyOiBzZXRVc2VyLFxyXG4gICAgICAgICAgICBnZXRVc2VyOiBnZXRVc2VyLFxyXG4gICAgICAgICAgICBjbGVhclVzZXI6IGNsZWFyVXNlclxyXG4gICAgICAgIH1cclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdDb3VudHJ5U3J2JywgZnVuY3Rpb24oJGh0dHAsIEluZGV4ZWREQlNydiwgTG9nU3J2KSB7XHJcbiAgICAgICAgLy8gQ291bnRyaWVzIGFycmF5XHJcbiAgICAgICAgdmFyIGNvdW50cmllcyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUFscGhhMyA9IG51bGw7XHJcbiAgICAgICAgdmFyIGNvdW50cmllc0J5TGV0dGVyID0gbnVsbDtcclxuXHJcbiAgICAgICAgLy8gSW5kZXhlZERCXHJcbiAgICAgICAgdmFyIGRhdGFiYXNlID0gJ21hZ2VsbGFuJztcclxuICAgICAgICB2YXIgc3RvcmUgPSAnY291bnRyeVN0b3JlJztcclxuICAgICAgICB2YXIga2V5Q291bnRyaWVzID0gJ2NvdW50cmllcyc7XHJcbiAgICAgICAgdmFyIGtleVZlcnNpb24gPSAndmVyc2lvbic7XHJcblxyXG4gICAgICAgIHZhciBpbmRleGVkREJBdmFpbGFibGUgPSBJbmRleGVkREJTcnYuaW5kZXhlZERCQXZhaWxhYmxlKCk7XHJcblxyXG4gICAgICAgIHZhciBpbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2FkQ291bnRyaWVzKCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvYWRDb3VudHJpZXMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgLy8gY2hlY2sgaWYgaW5kZXhlZERCIGlzIGF2YWlsYWJsZVxyXG4gICAgICAgICAgICBpZiAoaW5kZXhlZERCQXZhaWxhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIGRhdGFiYXNlIGV4aXN0c1xyXG4gICAgICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5jcmVhdGVEYXRhYmFzZShkYXRhYmFzZSwgc3RvcmUpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGdldEVtcHR5T2JqZWN0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihnZXRJbnRlcm5hbFZlcnNpb24pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGdldEV4dGVybmFsVmVyc2lvbilcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZGV0ZXJtaW5lTG9hZFN0cmF0ZWd5KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihsb2FkRGF0YSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXMgPSBvYmpbJ2NvdW50cmllcyddO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ1Nydi5pbmZvKFwibG9hZGVkIGNvdW50cmllcyBmcm9tXCIsIG9ialsnbG9hZFN0cmF0ZWd5J10udG9VcHBlckNhc2UoKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkaXRpb25hbGx5IG1hcCBjb3VudHJpZXMgYnkgdmFyaW91cyBwcm9wZXJ0aWVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUFscGhhMyA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlMZXR0ZXIgPSB7fTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXMuZm9yRWFjaChmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnkgYWxwaGEzIGNvZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUFscGhhM1tjWydhbHBoYTNDb2RlJ11dID0gYztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYnkgbGV0dGVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0TGV0dGVyID0gY1snbmFtZSddLnN1YnN0cigwLCAxKS50b1VwcGVyQ2FzZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGZpcnN0TGV0dGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ8OEJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpcnN0TGV0dGVyID0gJ0EnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICfDlic6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdExldHRlciA9ICdPJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnw5wnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RMZXR0ZXIgPSAnVSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY291bnRyaWVzQnlMZXR0ZXJbZmlyc3RMZXR0ZXJdID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyaWVzQnlMZXR0ZXJbZmlyc3RMZXR0ZXJdID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJpZXNCeUxldHRlcltmaXJzdExldHRlcl0ucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFscGhhM0NvZGU6IGMuYWxwaGEzQ29kZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogYy5uYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGNvdW50cmllcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcihcImZhaWxlZCB0byBsb2FkIGNvdW50cmllc1wiLCBlcnIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gaWYgbm90LCB3ZSBhbHdheXMgdHJ5IHRvIGRvd25sb2FkIGl0IGZyb20gdGhlIGNvdW50cnkgQVBJIGVuZHBvaW50XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0Q291bnRyaWVzRnJvbUFQSSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGRldGVybWluZUxvYWRTdHJhdGVneSA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgc3RyYXRlZ3k7XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGludGVybmFsVmVyc2lvbiA9IG9ialtcImludGVybmFsVmVyc2lvblwiXTtcclxuICAgICAgICAgICAgICAgIHZhciBleHRlcm5hbFZlcnNpb24gPSBvYmpbXCJleHRlcm5hbFZlcnNpb25cIl07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGludGVybmFsVmVyc2lvbiA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmF0ZWd5ID0gJ2FwaSc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV4dGVybmFsVmVyc2lvbiA+IGludGVybmFsVmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmF0ZWd5ID0gJ2FwaSc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHN0cmF0ZWd5ID0gJ2RiJztcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBvYmpbJ2xvYWRTdHJhdGVneSddID0gc3RyYXRlZ3k7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgbG9hZERhdGEgPSBmdW5jdGlvbihvYmopIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHN0cmF0ZWd5ID0gb2JqWydsb2FkU3RyYXRlZ3knXTtcclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHN0cmF0ZWd5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnYXBpJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q291bnRyaWVzRnJvbUFQSSgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihjb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJjb3VudHJpZXNcIl0gPSBjb3VudHJpZXM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIGNvdW50cmllcyBhbmQgdmVyc2lvbiBudW1iZXIgaW4gZGF0YWJhc2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbmRleGVkREJTcnYucHV0SXRlbShkYXRhYmFzZSwgc3RvcmUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToga2V5Q291bnRyaWVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogIGNvdW50cmllc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbmRleGVkREJTcnYucHV0SXRlbShkYXRhYmFzZSwgc3RvcmUsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToga2V5VmVyc2lvbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG9ialtcImV4dGVybmFsVmVyc2lvblwiXVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG9iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGInOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnZXRDb3VudHJpZXNGcm9tREIob2JqKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oX29iaikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoX29iaik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdVbmtub3duIGxvYWQgc3RyYXRlZ3knKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEVtcHR5T2JqZWN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoe30pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0SW50ZXJuYWxWZXJzaW9uID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5yZXRyaWV2ZUl0ZW0oZGF0YWJhc2UsIHN0b3JlLCBrZXlWZXJzaW9uKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqW1wiaW50ZXJuYWxWZXJzaW9uXCJdID0gaXRlbS52YWx1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqW1wiaW50ZXJuYWxWZXJzaW9uXCJdID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUob2JqKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldEV4dGVybmFsVmVyc2lvbiA9IGZ1bmN0aW9uKG9iaikge1xyXG4gICAgICAgICAgICByZXR1cm4gZ2V0VmVyc2lvbkZyb21BUEkoKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24odmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgIG9ialtcImV4dGVybmFsVmVyc2lvblwiXSA9IHZlcnNpb247XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyaWVzRnJvbURCID0gZnVuY3Rpb24ob2JqKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIEluZGV4ZWREQlNydi5yZXRyaWV2ZUl0ZW0oZGF0YWJhc2UsIHN0b3JlLCBrZXlDb3VudHJpZXMpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24oaXRlbSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmpbXCJjb3VudHJpZXNcIl0gPSBpdGVtLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShvYmopO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDb3VudHJpZXNGcm9tQVBJID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9jb3VudHJpZXMnKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VmVyc2lvbkZyb21BUEkgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL2NvdW50cmllcy92ZXJzaW9uJylcclxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlLmRhdGEudmVyc2lvbiB8fCAwKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgwKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cnlCeUFscGhhMyA9IGZ1bmN0aW9uKGFscGhhMykge1xyXG4gICAgICAgICAgICBpZiAoY291bnRyaWVzQnlBbHBoYTMgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyaWVzQnlBbHBoYTNbYWxwaGEzXTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q291bnRyaWVzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXM7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldENvdW50cmllc0J5TGV0dGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChjb3VudHJpZXNCeUxldHRlciA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXNCeUxldHRlcjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgYXJlQ291bnRyaWVzTG9hZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXMgIT09IG51bGwgJiYgY291bnRyaWVzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgaW5pdDogaW5pdCxcclxuICAgICAgICAgICAgZ2V0Q291bnRyaWVzOiBnZXRDb3VudHJpZXMsXHJcbiAgICAgICAgICAgIGdldENvdW50cnlCeUFscGhhMzogZ2V0Q291bnRyeUJ5QWxwaGEzLFxyXG4gICAgICAgICAgICBnZXRDb3VudHJpZXNCeUxldHRlcjogZ2V0Q291bnRyaWVzQnlMZXR0ZXIsXHJcbiAgICAgICAgICAgIGFyZUNvdW50cmllc0xvYWRlZDogYXJlQ291bnRyaWVzTG9hZGVkXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdFdmVudFNydicsIGZ1bmN0aW9uKCRodHRwLCBMb2dTcnYpIHtcclxuICAgICAgICB2YXIgYWRkID0gZnVuY3Rpb24obmFtZSkge1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL2V2ZW50L2FkZCcsIHtcclxuICAgICAgICAgICAgICAgIG5hbWU6IG5hbWVcclxuICAgICAgICAgICAgfSkuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBubyBuZWVkIHRvIHJlYWN0IHRvIHN1Y2Nlc3MgY2FzZVxyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgIExvZ1Nydi5lcnJvcignZmFpbGVkIHRvIGFkZCBldmVudCcsIGVycik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGFkZDogYWRkXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdGb2N1c1NydicsIGZ1bmN0aW9uKCR0aW1lb3V0LCAkd2luZG93KSB7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHNlbGVjdG9yKSB7XHJcbiAgICAgICAgICAgIC8vIHRpbWVvdXQgbWFrZXMgc3VyZSB0aGF0IGlzIGludm9rZWQgYWZ0ZXIgYW55IG90aGVyIGV2ZW50IGhhcyBiZWVuIHRyaWdnZXJlZC5cclxuICAgICAgICAgICAgLy8gZS5nLiBjbGljayBldmVudHMgdGhhdCBuZWVkIHRvIHJ1biBiZWZvcmUgdGhlIGZvY3VzIG9yXHJcbiAgICAgICAgICAgIC8vIGlucHV0cyBlbGVtZW50cyB0aGF0IGFyZSBpbiBhIGRpc2FibGVkIHN0YXRlIGJ1dCBhcmUgZW5hYmxlZCB3aGVuIHRob3NlIGV2ZW50c1xyXG4gICAgICAgICAgICAvLyBhcmUgdHJpZ2dlcmVkLlxyXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdJbmRleGVkREJTcnYnLCBmdW5jdGlvbigkd2luZG93KSB7XHJcbiAgICAgICAgdmFyIGtleVBhdGggPSAnbmFtZSc7XHJcblxyXG4gICAgICAgIHZhciBpbmRleGVkREIgPSAkd2luZG93LmluZGV4ZWREQiB8fCAkd2luZG93LndlYmtpdEluZGV4ZWREQiB8fCAkd2luZG93Lm1zSW5kZXhlZERCO1xyXG4gICAgICAgIHZhciBJREJLZXlSYW5nZSA9ICR3aW5kb3cuSURCS2V5UmFuZ2UgfHwgJHdpbmRvdy53ZWJraXRJREJLZXlSYW5nZTtcclxuXHJcbiAgICAgICAgdmFyIElEQlRyYW5zYWN0aW9uID0gJHdpbmRvdy5JREJUcmFuc2FjdGlvbiB8fCAkd2luZG93LndlYmtpdElEQlRyYW5zYWN0aW9uO1xyXG5cclxuICAgICAgICBpZiAoSURCVHJhbnNhY3Rpb24pIHtcclxuICAgICAgICAgICAgSURCVHJhbnNhY3Rpb24uUkVBRF9XUklURSA9IElEQlRyYW5zYWN0aW9uLlJFQURfV1JJVEUgfHwgJ3JlYWR3cml0ZSc7XHJcbiAgICAgICAgICAgIElEQlRyYW5zYWN0aW9uLlJFQURfT05MWSA9IElEQlRyYW5zYWN0aW9uLlJFQURfT05MWSB8fCAncmVhZG9ubHknO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGluZGV4ZWREQkF2YWlsYWJsZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gaW5kZXhlZERCID8gdHJ1ZSA6IGZhbHNlO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVEYXRhYmFzZSA9IGZ1bmN0aW9uKGRiTmFtZSwgc3RvcmVOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oZGJOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBlIGlzIGFuIGluc3RhbmNlIG9mIElEQlZlcnNpb25DaGFuZ2VFdmVudFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZGIgPSBlLnRhcmdldC5yZXN1bHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IGlkYi5jcmVhdGVPYmplY3RTdG9yZShzdG9yZU5hbWUsIHsga2V5UGF0aDoga2V5UGF0aCB9KTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkLCB1cGRhdGUsIGRlbGV0ZVxyXG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBoYW5kbGUgZXJyb3JcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZHJvcERhdGFiYXNlID0gZnVuY3Rpb24oZGJOYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0gaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gZHJvcCBzdWNjZXNzZnVsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRyb3AgZmFpbGVkXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGFkZEl0ZW0gPSBmdW5jdGlvbihkYk5hbWUsIHN0b3JlTmFtZSwgaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX1dSSVRFKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBhZGRcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdEFkZCA9IHN0b3JlLmFkZChpdGVtKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdEFkZC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBwdXRJdGVtID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUsIGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZGIgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gaWRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgSURCVHJhbnNhY3Rpb24uUkVBRF9XUklURSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoc3RvcmVOYW1lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3RBZGQgPSBzdG9yZS5wdXQoaXRlbSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBZGQub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RBZGQub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmV0cmlldmVJdGVtID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUsIGl0ZW1OYW1lKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKGRiTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkYiA9IGUudGFyZ2V0LnJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgdHJhbnNhY3Rpb24gPSBpZGIudHJhbnNhY3Rpb24oc3RvcmVOYW1lLCBJREJUcmFuc2FjdGlvbi5SRUFEX09OTFkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKHN0b3JlTmFtZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IElEQktleVJhbmdlLm9ubHkoaXRlbU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzdG9yZS5vcGVuQ3Vyc29yKHJhbmdlKS5vbnN1Y2Nlc3MgPSBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJzb3IgPSBlLnRhcmdldC5yZXN1bHQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vyc29yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gY3Vyc29yLnZhbHVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChlKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXRyaWV2ZUl0ZW1zID0gZnVuY3Rpb24oZGJOYW1lLCBzdG9yZU5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gW107XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihkYk5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpZGIgPSBlLnRhcmdldC5yZXN1bHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRyYW5zYWN0aW9uID0gaWRiLnRyYW5zYWN0aW9uKHN0b3JlTmFtZSwgSURCVHJhbnNhY3Rpb24uUkVBRF9PTkxZKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgc3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZShzdG9yZU5hbWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzdG9yZS5vcGVuQ3Vyc29yKCkub25zdWNjZXNzID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZS50YXJnZXQucmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnNvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMucHVzaChjdXJzb3IudmFsdWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoZSk7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjcmVhdGVEYXRhYmFzZTogY3JlYXRlRGF0YWJhc2UsXHJcbiAgICAgICAgICAgIGRyb3BEYXRhYmFzZTogZHJvcERhdGFiYXNlLFxyXG4gICAgICAgICAgICBhZGRJdGVtOiBhZGRJdGVtLFxyXG4gICAgICAgICAgICBwdXRJdGVtOiBwdXRJdGVtLFxyXG4gICAgICAgICAgICByZXRyaWV2ZUl0ZW06IHJldHJpZXZlSXRlbSxcclxuICAgICAgICAgICAgcmV0cmlldmVJdGVtczogcmV0cmlldmVJdGVtcyxcclxuICAgICAgICAgICAgaW5kZXhlZERCQXZhaWxhYmxlOiBpbmRleGVkREJBdmFpbGFibGVcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ0xvZ1NydicsIGZ1bmN0aW9uKEFwcENvbmZpZykge1xyXG4gICAgICAgIHZhciBsb2dJbmZvID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChBcHBDb25maWdbXCJsb2cuaW5mb1wiXSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBsb2dFcnJvciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAoQXBwQ29uZmlnW1wibG9nLmVycm9yXCJdKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBpbmZvOiBsb2dJbmZvLFxyXG4gICAgICAgICAgICBlcnJvcjogbG9nRXJyb3JcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1F1aXpTcnYnLCBmdW5jdGlvbihBcHBDb25maWcsIENvdW50cnlTcnYsIFNjb3JlU3J2LCBFdmVudFNydikge1xyXG4gICAgICAgIHZhciBjb3VudHJpZXMgPSBudWxsO1xyXG4gICAgICAgIHZhciBjb3VudHJpZXNCeUFscGhhMyA9IG51bGw7XHJcblxyXG4gICAgICAgIHZhciBxdWl6ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdmFyIHNldENvdW50cmllcyA9IGZ1bmN0aW9uKF9jb3VudHJpZXMpIHtcclxuICAgICAgICAgICAgY291bnRyaWVzID0gX2NvdW50cmllcztcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY291bnRyaWVzTG9hZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBjb3VudHJpZXMgIT09IG51bGwgJiYgY291bnRyaWVzLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb3VudHJpZXNMb2FkZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICByZWplY3QoXCJDb3VudHJpZXMgaGF2ZSBub3QgYmVlbiBsb2FkZWRcIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgcXVpeiA9IGNyZWF0ZVF1aXooJ2NvdW50cnknKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgcXVpeiBzdGFydCBldmVudFxyXG4gICAgICAgICAgICAgICAgRXZlbnRTcnYuYWRkKCdxdWl6LnN0YXJ0Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZShxdWl6LnN0YXJ0KCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZGlzcG9zZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBxdWl6ID0gbnVsbDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaXNRdWl6UnVubmluZyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKSAmJiAhcXVpei5oYXNFbmRlZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBoYXNRdWl6U3RhcnRlZCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZiAocXVpeiA9PT0gbnVsbClcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6Lmhhc1N0YXJ0ZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgaGFzUXVpekVuZGVkID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmIChxdWl6ID09PSBudWxsKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHF1aXouaGFzRW5kZWQoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgY3JlYXRlUXVpeiA9IGZ1bmN0aW9uKHF1aXpUeXBlKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocXVpelR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGNhc2UgJ2NvdW50cnknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3JlYXRlQ291bnRyeVF1aXooKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBjcmVhdGVDb3VudHJ5UXVpeiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2YXIgY291bnRyeVF1aXogPSBuZXcgUXVpeigpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGZ1bGxQb2ludHMgPSAxMDA7XHJcbiAgICAgICAgICAgIHZhciBoaW50TWF4aW11bSA9IDM7XHJcbiAgICAgICAgICAgIHZhciBoaW50Q29zdCA9IDI1O1xyXG5cclxuICAgICAgICAgICAgdmFyIGxhc3RRdWVzdGlvbkJvbnVzID0gMi41O1xyXG5cclxuICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVHlwZXMgPSBBcHBDb25maWdbJ3F1aXouY291bnRyeS50eXBlcyddO1xyXG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlc0xlbmd0aCA9IE9iamVjdC5rZXlzKHF1ZXN0aW9uVHlwZXMpLmxlbmd0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdCBjb3VudHJpZXMgZm9yIHF1ZXN0aW9uc1xyXG4gICAgICAgICAgICB2YXIgc2VsZWN0ZWRDb3VudHJpZXMgPSBbXTtcclxuICAgICAgICAgICAgdmFyIG51bWJlck9mUXVlc3Rpb25zID0gQXBwQ29uZmlnWydxdWl6LmNvdW50cnkucXVlc3Rpb25zJ107XHJcblxyXG4gICAgICAgICAgICAvLyB0aGVyZSBhcmUgZml2ZSBlYXN5LCBmaXZlIG1lZGl1bSBhbmQgZml2ZSBoYXJkIHF1ZXN0aW9ucyAobGF0ZXIgdG8gYmUgc2h1ZmZsZWQgcmFuZG9tbHkpXHJcbiAgICAgICAgICAgIC8vIHRoZSAxNnRoIGFuZCBsYXN0IHF1ZXN0aW9uIGlzIGFsd2F5cyBhIGhhcmQgb25lLlxyXG5cclxuICAgICAgICAgICAgdmFyIGVhc3lDb3VudHJpZXMgPSBjb3VudHJpZXMuZmlsdGVyKGZ1bmN0aW9uKGMpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjLmRpZmZpY3VsdHkgPT09ICdlYXN5JztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgbWVkaXVtQ291bnRyaWVzID0gY291bnRyaWVzLmZpbHRlcihmdW5jdGlvbihjKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYy5kaWZmaWN1bHR5ID09PSAnbWVkaXVtJztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgaGFyZENvdW50cmllcyA9IGNvdW50cmllcy5maWx0ZXIoZnVuY3Rpb24oYykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGMuZGlmZmljdWx0eSA9PT0gJ2hhcmQnO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIHNlbGVjdCBjb3VudHJpZXNcclxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1iZXJPZlF1ZXN0aW9uczsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyeU9rID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB2YXIgY291bnRyeTtcclxuXHJcbiAgICAgICAgICAgICAgICB3aGlsZSAoIWNvdW50cnlPaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDwgNSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5ID0gZWFzeUNvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgZWFzeUNvdW50cmllcy5sZW5ndGggLSAxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpIDwgMTApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeSA9IG1lZGl1bUNvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgbWVkaXVtQ291bnRyaWVzLmxlbmd0aCAtIDEpXTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3VudHJ5ID0gaGFyZENvdW50cmllc1tnZXRSYW5kb21JbnQoMCwgaGFyZENvdW50cmllcy5sZW5ndGggLSAxKV07XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBjb3VudHJ5T2sgPSBzZWxlY3RlZENvdW50cmllcy5pbmRleE9mKGNvdW50cnlbJ2FscGhhM0NvZGUnXSkgPCAwO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHNlbGVjdGVkQ291bnRyaWVzLnB1c2goY291bnRyeVsnYWxwaGEzQ29kZSddKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gc2h1ZmZsZSBhcnJheSAoLTIgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHNodWZmbGUgdGhlIGxhc3QgY291bnRyeSAoaXQgaGFzIHRvIHN0YXkgaW4gcGxhY2UpXHJcbiAgICAgICAgICAgIHZhciBhcnJheVRvU2h1ZmZsZSA9IHNlbGVjdGVkQ291bnRyaWVzLnNwbGljZSgwLCBzZWxlY3RlZENvdW50cmllcy5sZW5ndGggLSAxKTtcclxuXHJcbiAgICAgICAgICAgIHZhciBzaHVmZmxlZEFycmF5ID0gc2h1ZmZsZShhcnJheVRvU2h1ZmZsZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBhZGQgbGFzdCBxdWVzdGlvbiB0byBzaHVmZmxlZCBhcnJheVxyXG4gICAgICAgICAgICBzaHVmZmxlZEFycmF5LnB1c2goc2VsZWN0ZWRDb3VudHJpZXNbc2VsZWN0ZWRDb3VudHJpZXMubGVuZ3RoIC0gMV0pO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHF1ZXN0aW9uIHR5cGUgYXJyYXlcclxuICAgICAgICAgICAgdmFyIHF1ZXN0aW9uVHlwZUFycmF5ID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG51bWJlck9mUXVlc3Rpb25zOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goNik7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8qZm9yICh2YXIgaiA9IDA7IGogPCBudW1iZXJPZlF1ZXN0aW9uczsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaiA8IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICBxdWVzdGlvblR5cGVBcnJheS5wdXNoKDEpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChqIDwgNikge1xyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goMik7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGogPCA5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCgzKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaiA8IDEyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCg0KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoaiA8IDE1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb25UeXBlQXJyYXkucHVzaCg1KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG9uZSByYW5kb20gcXVlc3Rpb24gZm9yIHRoZSBsYXN0IG9uZVxyXG4gICAgICAgICAgICAgICAgICAgIHF1ZXN0aW9uVHlwZUFycmF5LnB1c2goZ2V0UmFuZG9tSW50KDEsIHF1ZXN0aW9uVHlwZXNMZW5ndGgpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSovXHJcblxyXG4gICAgICAgICAgICB2YXIgc2h1ZmZsZWRRdWVzdGlvblR5cGVBcnJheSA9IHNodWZmbGUocXVlc3Rpb25UeXBlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgLy8gY3JlYXRlIHF1ZXN0aW9ucyBmb3IgcXVpelxyXG4gICAgICAgICAgICB2YXIgcWNudCA9IDA7XHJcbiAgICAgICAgICAgIHNodWZmbGVkQXJyYXkuZm9yRWFjaChmdW5jdGlvbihhbHBoYTMsIGlkeCkge1xyXG4gICAgICAgICAgICAgICAgcWNudCsrO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciBjb3VudHJ5ID0gQ291bnRyeVNydi5nZXRDb3VudHJ5QnlBbHBoYTMoYWxwaGEzKTtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcXVlc3Rpb25UeXBlID0gcXVlc3Rpb25UeXBlc1tzaHVmZmxlZFF1ZXN0aW9uVHlwZUFycmF5W2lkeF1dO1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gZ2V0UXVlc3Rpb25UZXh0KHF1ZXN0aW9uVHlwZSwgY291bnRyeSk7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBxdWVzdGlvblR5cGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZGlmZmljdWx0eTogY291bnRyeS5kaWZmaWN1bHR5LFxyXG4gICAgICAgICAgICAgICAgICAgIGlucHV0OiBnZXRRdWVzdGlvbklucHV0KHF1ZXN0aW9uVHlwZSksXHJcbiAgICAgICAgICAgICAgICAgICAgdW5pdDogZ2V0UXVlc3Rpb25Vbml0KHF1ZXN0aW9uVHlwZSlcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB2YXIgYW5zd2VyID0gZ2V0UXVlc3Rpb25BbnN3ZXIocXVlc3Rpb25UeXBlLCBjb3VudHJ5KTtcclxuICAgICAgICAgICAgICAgIHZhciBjaGVja0Fuc3dlciA9IGdldENoZWNrQW5zd2VyTGFtYmRhKHF1ZXN0aW9uVHlwZSwgZnVsbFBvaW50cywgbGFzdFF1ZXN0aW9uQm9udXMpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGhpbnRzID0gZ2V0UXVlc3Rpb25IaW50cyhxdWVzdGlvblR5cGUsIGhpbnRNYXhpbXVtLCBoaW50Q29zdCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIGxhc3QgcXVlc3Rpb24gaXMgdGhlIGJvbnVzIHF1ZXN0aW9uXHJcbiAgICAgICAgICAgICAgICBpZiAocWNudCA+PSBudW1iZXJPZlF1ZXN0aW9ucykge1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm9bJ2JvbnVzJ10gPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIGFkZCBpbmZvIGZvciBmbGFnIG9mIGNvdW50cnlcclxuICAgICAgICAgICAgICAgIGlmIChxdWVzdGlvblR5cGUgPT09ICdGTEFHX09GX0NPVU5UUlknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5tZWRpYSA9ICdmbGFnJztcclxuICAgICAgICAgICAgICAgICAgICBpbmZvLmFscGhhMkNvZGUgPSBjb3VudHJ5LmFscGhhMkNvZGUudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBhZGQgaW5mbyBmb3IgbG9jYXRpb24gb2YgY291bnRyeVxyXG4gICAgICAgICAgICAgICAgaWYgKHF1ZXN0aW9uVHlwZSA9PT0gJ0xPQ0FUSU9OX09GX0NPVU5UUlknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5mby5tZWRpYSA9ICdtYXAnO1xyXG4gICAgICAgICAgICAgICAgICAgIGluZm8uYWxwaGEyQ29kZSA9IGNvdW50cnkuYWxwaGEyQ29kZS50b0xvY2FsZUxvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvdW50cnlRdWl6LmFkZFF1ZXN0aW9uKG5ldyBRdWVzdGlvbih7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dCxcclxuICAgICAgICAgICAgICAgICAgICBpbmZvOiBpbmZvLFxyXG4gICAgICAgICAgICAgICAgICAgIGFuc3dlcjogYW5zd2VyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrQW5zd2VyOiBjaGVja0Fuc3dlcixcclxuICAgICAgICAgICAgICAgICAgICBoaW50czogaGludHNcclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gY291bnRyeVF1aXo7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVGV4dCA9IGZ1bmN0aW9uKHR5cGUsIGNvdW50cnkpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdDQVBJVEFMX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBoZWnDn3QgZGllIEhhdXB0c3RhZHQgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiW1wiICsgY291bnRyeS5jYXBpdGFsICsgXCJdIGlzdCBkaWUgSGF1cHRzdGFkdCB2b24gd2VsY2hlbSBMYW5kXCJcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSB2aWVsZSBNZW5zY2hlbiBsZWJlbiBpbiBbXCIgKyBjb3VudHJ5Lm5hbWUgKyBcIl1cIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcIldpZSBncm/DnyBpc3QgZGllIEZsw6RjaGUgdm9uIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0ZMQUdfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiV2VsY2hlcyBMYW5kIGhhdCBkaWVzZSBGbGFnZ2VcIjtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJXbyBiZWZpbmRldCBzaWNoIFtcIiArIGNvdW50cnkubmFtZSArIFwiXVwiO1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiP1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25BbnN3ZXIgPSBmdW5jdGlvbih0eXBlLCBjb3VudHJ5KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYWx0U3BlbGxpbmdzID0gY291bnRyeS5hbHRTcGVsbGluZ3MgIT09IHVuZGVmaW5lZCAmJiBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddICE9PSB1bmRlZmluZWQgPyBjb3VudHJ5LmFsdFNwZWxsaW5nc1snY2FwaXRhbCddIDogW107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcnJlY3Q6IGNvdW50cnkuY2FwaXRhbCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWx0U3BlbGxpbmdzOiBhbHRTcGVsbGluZ3NcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhbHRTcGVsbGluZ3MgPSBjb3VudHJ5LmFsdFNwZWxsaW5ncyAhPT0gdW5kZWZpbmVkICYmIGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gIT09IHVuZGVmaW5lZCA/IGNvdW50cnkuYWx0U3BlbGxpbmdzWyduYW1lJ10gOiBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbHRTcGVsbGluZ3M6IGFsdFNwZWxsaW5nc1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LnBvcHVsYXRpb25cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29ycmVjdDogY291bnRyeS5hcmVhXHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb3JyZWN0OiBjb3VudHJ5LmFscGhhMkNvZGVcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwiP1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25JbnB1dCA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnbnVtYmVyLmhpZ2gnO1xyXG5cclxuICAgICAgICAgICAgICAgIGNhc2UgJ0FSRUFfT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdudW1iZXIubWVkaXVtJztcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdMT0NBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ21hcC5wb2ludCc7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ3RleHQuc3RhbmRhcmQnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGdldFF1ZXN0aW9uVW5pdCA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlICdBUkVBX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAna23Csic7XHJcblxyXG4gICAgICAgICAgICAgICAgY2FzZSAnUE9QVUxBVElPTl9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0VpbndvaG5lcic7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDaGVja0Fuc3dlckxhbWJkYSA9IGZ1bmN0aW9uKHR5cGUsIGZ1bGxQb2ludHMsIGxhc3RRdWVzdGlvbkJvbnVzKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnTE9DQVRJT05fT0ZfQ09VTlRSWSc6XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGFuc3dlciwgc3VibWl0dGVkQW5zd2VyLCBoaW50c1VzZWQsIGhpbnRDb3N0LCBpbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbGxvd2VkU3BlbGxpbmdzO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFuc3dlci5hbHRTcGVsbGluZ3MgJiYgYW5zd2VyLmFsdFNwZWxsaW5ncy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2VkU3BlbGxpbmdzID0gYW5zd2VyLmFsdFNwZWxsaW5ncy5tYXAoZnVuY3Rpb24oc3BlbGxpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3BlbGxpbmcudG9Mb2NhbGVMb3dlckNhc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxsb3dlZFNwZWxsaW5ncyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29ycmVjdCA9IHN1Ym1pdHRlZEFuc3dlci50b0xvY2FsZUxvd2VyQ2FzZSgpID09PSBhbnN3ZXIuY29ycmVjdC50b0xvY2FsZUxvd2VyQ2FzZSgpIHx8IChhbGxvd2VkU3BlbGxpbmdzICYmIGFsbG93ZWRTcGVsbGluZ3MuaW5kZXhPZihzdWJtaXR0ZWRBbnN3ZXIpID49IDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBvaW50cyA9IGNvcnJlY3QgPyBmdWxsUG9pbnRzIDogMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIGhpbnRzIGFyZSBhbGxvd2VkIGFuZCBoYXZlIGJlZW4gdXNlZCwgc3VidHJhY3QgdGhlIHBvaW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGludHNVc2VkID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzIC09IChoaW50c1VzZWQgKiBoaW50Q29zdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJvbnVzIHBvaW50cyBmb3IgbGFzdCBxdWVzdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mbyAhPT0gdW5kZWZpbmVkICYmIGluZm8uYm9udXMgIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgKj0gbGFzdFF1ZXN0aW9uQm9udXM7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwb2ludHM7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oYW5zd2VyLCBzdWJtaXR0ZWRBbnN3ZXIsIGhpbnRzVXNlZCwgaGludENvc3QsIGluZm8pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHBlcmNlbnRhZ2UgZGlmZmVyZW5jZSBmcm9tIGNvcnJlY3QgYW5zd2VyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlcnJvclBlcmNlbnRhZ2UgPSBNYXRoLmFicyhzdWJtaXR0ZWRBbnN3ZXIgLSBhbnN3ZXIuY29ycmVjdCkgLyBhbnN3ZXIuY29ycmVjdCAqIDEwMDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwb2ludHM7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDEwMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gNikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gOTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDgwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxMikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNzA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDE0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSA2MDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMTYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDUwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAxOCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gNDA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JQZXJjZW50YWdlIDw9IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAzMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlcnJvclBlcmNlbnRhZ2UgPD0gMjUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyA9IDIwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVycm9yUGVyY2VudGFnZSA8PSAzMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzID0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb2ludHMgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZiBoaW50cyBhcmUgYWxsb3dlZCBhbmQgaGF2ZSBiZWVuIHVzZWQsIHN1YnRyYWN0IHRoZSBwb2ludHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhpbnRzVXNlZCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvaW50cyAtPSAoaGludHNVc2VkICogaGludENvc3QpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBib251cyBwb2ludHMgZm9yIGxhc3QgcXVlc3Rpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm8gIT09IHVuZGVmaW5lZCAmJiBpbmZvLmJvbnVzICE9PSB1bmRlZmluZWQgJiYgaW5mby5ib251cyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9pbnRzICo9IGxhc3RRdWVzdGlvbkJvbnVzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9pbnRzO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0UXVlc3Rpb25IaW50cyA9IGZ1bmN0aW9uKHR5cGUsIGhpbnRzUG9zc2libGUsIGhpbnRDb3N0KSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnQ0FQSVRBTF9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgIGNhc2UgJ0NPVU5UUllfT0ZfQ0FQSVRBTCc6XHJcbiAgICAgICAgICAgICAgICBjYXNlICdGTEFHX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFsbG93ZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heGltdW06IGhpbnRzUG9zc2libGUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvc3Q6IGhpbnRDb3N0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnaXZlOiBmdW5jdGlvbihoaW50c1VzZWQsIGFuc3dlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFuc3dlci5jb3JyZWN0LnN1YnN0cigwLCBoaW50c1VzZWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICBjYXNlICdQT1BVTEFUSU9OX09GX0NPVU5UUlknOlxyXG4gICAgICAgICAgICAgICAgY2FzZSAnQVJFQV9PRl9DT1VOVFJZJzpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGxvd2VkOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCI/XCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0Q3VycmVudFF1ZXN0aW9uTnVtYmVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRDdXJyZW50UXVlc3Rpb25OdW1iZXIoKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGlmICghaXNRdWl6UnVubmluZygpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXROdW1iZXJPZlF1ZXN0aW9ucygpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBnZXRDdXJyZW50UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBxdWl6LmN1cnJlbnRRdWVzdGlvbigpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciBuZXh0UXVlc3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKCFpc1F1aXpSdW5uaW5nKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcXVpei5uZXh0UXVlc3Rpb24oKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VG90YWxQb2ludHMgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHF1aXogPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcXVpei5nZXRUb3RhbFBvaW50cygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ29uY2x1ZGVzIHRoZSBxdWl6IGFuZCBwdXRzIHRoZSBzY29yZSB0byB0aGUgQVBJIGVuZHBvaW50LlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBjb25jbHVkZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocXVpeiAhPT0gbnVsbCAmJiBxdWl6Lmhhc0VuZGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocXVpei5zdWJtaXR0ZWQgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdRdWl6IGhhcyBhbHJlYWR5IGJlZW4gc3VibWl0dGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBxdWl6LnN1Ym1pdHRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFNjb3JlU3J2LnB1dEhpZ2hzY29yZShxdWl6LmdldFRvdGFsUG9pbnRzKCkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBxdWl6IGZpbmlzaCBldmVudFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnRTcnYuYWRkKCdxdWl6LmZpbmlzaCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCdObyBxdWl6IGlzIGN1cnJlbnRseSBydW5uaW5nJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFNodWZmbGVzIGFuIGFycmF5IHJhbmRvbWx5XHJcbiAgICAgICAgICogQHBhcmFtIGFycmF5ICAgICB0aGUgYXJyYXkgdG8gYmUgc2h1ZmZsZWRcclxuICAgICAgICAgKiBAcmV0dXJucyB7Kn0gICAgIHRoZSBzaHVmZmxlZCBhcnJheVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBzaHVmZmxlID0gZnVuY3Rpb24gKGFycmF5KSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBhcnJheS5sZW5ndGgsIHRlbXBvcmFyeVZhbHVlLCByYW5kb21JbmRleDtcclxuXHJcbiAgICAgICAgICAgIC8vIFdoaWxlIHRoZXJlIHJlbWFpbiBlbGVtZW50cyB0byBzaHVmZmxlLi4uXHJcbiAgICAgICAgICAgIHdoaWxlICgwICE9PSBjdXJyZW50SW5kZXgpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBQaWNrIGEgcmVtYWluaW5nIGVsZW1lbnQuLi5cclxuICAgICAgICAgICAgICAgIHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogY3VycmVudEluZGV4KTtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleCAtPSAxO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIEFuZCBzd2FwIGl0IHdpdGggdGhlIGN1cnJlbnQgZWxlbWVudC5cclxuICAgICAgICAgICAgICAgIHRlbXBvcmFyeVZhbHVlID0gYXJyYXlbY3VycmVudEluZGV4XTtcclxuICAgICAgICAgICAgICAgIGFycmF5W2N1cnJlbnRJbmRleF0gPSBhcnJheVtyYW5kb21JbmRleF07XHJcbiAgICAgICAgICAgICAgICBhcnJheVtyYW5kb21JbmRleF0gPSB0ZW1wb3JhcnlWYWx1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGFycmF5O1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGluaXQ6IGluaXQsXHJcbiAgICAgICAgICAgIHNldENvdW50cmllczogc2V0Q291bnRyaWVzLFxyXG4gICAgICAgICAgICBpc1F1aXpSdW5uaW5nOiBpc1F1aXpSdW5uaW5nLFxyXG4gICAgICAgICAgICBoYXNRdWl6U3RhcnRlZDogaGFzUXVpelN0YXJ0ZWQsXHJcbiAgICAgICAgICAgIGhhc1F1aXpFbmRlZDogaGFzUXVpekVuZGVkLFxyXG4gICAgICAgICAgICBnZXRDdXJyZW50UXVlc3Rpb25OdW1iZXI6IGdldEN1cnJlbnRRdWVzdGlvbk51bWJlcixcclxuICAgICAgICAgICAgZ2V0TnVtYmVyT2ZRdWl6UXVlc3Rpb25zOiBnZXROdW1iZXJPZlF1aXpRdWVzdGlvbnMsXHJcbiAgICAgICAgICAgIGdldEN1cnJlbnRRdWVzdGlvbjogZ2V0Q3VycmVudFF1ZXN0aW9uLFxyXG4gICAgICAgICAgICBuZXh0UXVlc3Rpb246IG5leHRRdWVzdGlvbixcclxuICAgICAgICAgICAgZ2V0VG90YWxQb2ludHM6IGdldFRvdGFsUG9pbnRzLFxyXG4gICAgICAgICAgICBjb25jbHVkZTogY29uY2x1ZGUsXHJcbiAgICAgICAgICAgIGRpc3Bvc2U6IGRpc3Bvc2VcclxuICAgICAgICB9O1xyXG4gICAgfSk7IiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuYW5ndWxhclxyXG4gICAgLm1vZHVsZSgnbWFnZWxsYW4nKVxyXG4gICAgLmZhY3RvcnkoJ1Njb3JlU3J2JywgZnVuY3Rpb24oJGh0dHApIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBlbnRpcmUgaGlnaHNjb3JlIGxpc3QgaW4gYW4gYXJyYXkgZnJvbSB0aGUgQVBJLlxyXG4gICAgICAgICAqIFJldHVybnMgYSBwcm9taXNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHZhciBnZXRIaWdoc2NvcmVMaXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnL2FwaS9zY29yZXMvYWxsJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihsaXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUobGlzdCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGZXRjaGVzIHRoZSBoaWdoc2NvcmUgb2JqZWN0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogSWYgdGhlIHVzZXIgaGFzIG5vIHJlc3VsdCB5ZXQsIGFuIGVtcHR5IG9iamVjdCBpcyByZXR1cm5lZC5cclxuICAgICAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZS5cclxuICAgICAgICAgKi9cclxuICAgICAgICB2YXIgZ2V0VXNlckhpZ2hzY29yZSA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJy9hcGkvc2NvcmVzL3VzZXInKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoc2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRmV0Y2hlcyB0aGUgaGlnaHNjb3JlIG9iamVjdCBmb3IgdGhlIG92ZXJhbGwgaGlnaHNjb3JlLlxyXG4gICAgICAgICAqIElmIHRoZXJlIGlzIGN1cnJlbnRseSBubyByZXN1bHQgeWV0LCBhbiBlbXB0eSBvYmplY3QgaXMgcmV0dXJuZWQuXHJcbiAgICAgICAgICogUmV0dXJucyBhIHByb21pc2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIGdldE92ZXJhbGxIaWdoc2NvcmUgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCcvYXBpL3Njb3Jlcy9oaWdoJylcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihzY29yZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHNjb3JlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFB1dHMgYSBoaWdoc2NvcmUgcmVzdWx0IGZvciB0aGUgbG9nZ2VkIGluIHVzZXIuXHJcbiAgICAgICAgICogQHBhcmFtIHNjb3JlICAgICBOdW1iZXIgd2l0aCB0aGUgYWNoaWV2ZWQgc2NvcmUuXHJcbiAgICAgICAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdmFyIHB1dEhpZ2hzY29yZSA9IGZ1bmN0aW9uKHNjb3JlKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS9zY29yZXMnLCB7IHNjb3JlOiBzY29yZSB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGdldEhpZ2hzY29yZUxpc3Q6IGdldEhpZ2hzY29yZUxpc3QsXHJcbiAgICAgICAgICAgIGdldFVzZXJIaWdoc2NvcmU6IGdldFVzZXJIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIGdldE92ZXJhbGxIaWdoc2NvcmU6IGdldE92ZXJhbGxIaWdoc2NvcmUsXHJcbiAgICAgICAgICAgIHB1dEhpZ2hzY29yZTogcHV0SGlnaHNjb3JlXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyIsIid1c2Ugc3RyaWN0JztcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ21hZ2VsbGFuJylcclxuICAgIC5mYWN0b3J5KCdVc2VyU3J2JywgZnVuY3Rpb24oJGh0dHAsIEF1dGhUb2tlblNydiwgQXBwQ29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXInKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZ2V0VXNlckZyb21TdG9yYWdlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IEF1dGhUb2tlblNydi5nZXRUb2tlbigpO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICh0b2tlbikge1xyXG4gICAgICAgICAgICAgICAgICAgIEF1dGhUb2tlblNydi5zZXRUb2tlbih0b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGdldFVzZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGVyZSBpcyBubyB0b2tlbiwgd2UgcmVqZWN0IHRoZSBwcm9taXNlXHJcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KFwiTm8gdG9rZW4gaW4gc3RvcmFnZVwiKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb24nLCB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZi50b2tlbiA9IHJlc3BvbnNlLmRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2F2ZSB0b2tlbiBsb2NhbGx5XHJcbiAgICAgICAgICAgICAgICBBdXRoVG9rZW5TcnYuc2V0VG9rZW4oc2VsZi50b2tlbik7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldFVzZXIoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgdmFyIGxvZ291dCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnRva2VuID0gbnVsbDtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZW1vdmUgdG9rZW4gbG9jYWxseVxyXG4gICAgICAgICAgICAgICAgQXV0aFRva2VuU3J2LnNldFRva2VuKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbihuZXdVc2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgIC8vIHNlbGVjdCBhIHJhbmRvbSBjb2xvciBmb3IgdGhlIHVzZXJcclxuICAgICAgICAgICAgICAgIHZhciBjb2xvcnMgPSBBcHBDb25maWdbJ3NldHRpbmdzLnVzZXIuY29sb3JzJ107XHJcbiAgICAgICAgICAgICAgICBuZXdVc2VyLmNvbG9yID0gY29sb3JzW2dldFJhbmRvbUludCgwLCBjb2xvcnMubGVuZ3RoIC0gMSldO1xyXG5cclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvdXNlcicsIG5ld1VzZXIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpbW1lZGlhdGVseSBsb2cgdGhlIHVzZXIgaW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbG9naW4obmV3VXNlci51c2VybmFtZSwgbmV3VXNlci5wYXNzd29yZClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkgIDtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgdXBkYXRlQmFzaWMgPSBmdW5jdGlvbih1c2VyKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnB1dCgnL2FwaS91c2VyL2Jhc2ljJywgdXNlcilcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciB1cGRhdGVQYXNzd29yZCA9IGZ1bmN0aW9uKHBhc3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAucHV0KCcvYXBpL3VzZXIvcGFzc3dvcmQnLCBwYXNzKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5lcnJvcihmdW5jdGlvbihlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHZhciByZXNldFBhc3N3b3JkID0gZnVuY3Rpb24oYm9keSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5wb3N0KCcvYXBpL3Bhc3N3b3JkL3Jlc2V0JywgYm9keSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB2YXIgZm9yZ290UGFzc3dvcmQgPSBmdW5jdGlvbihib2R5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvcGFzc3dvcmQvZm9yZ290JywgYm9keSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoZnVuY3Rpb24oZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBnZXRVc2VyOiBnZXRVc2VyLFxyXG4gICAgICAgICAgICBnZXRVc2VyRnJvbVN0b3JhZ2U6IGdldFVzZXJGcm9tU3RvcmFnZSxcclxuICAgICAgICAgICAgbG9naW46IGxvZ2luLFxyXG4gICAgICAgICAgICBsb2dvdXQ6IGxvZ291dCxcclxuICAgICAgICAgICAgcmVnaXN0ZXI6IHJlZ2lzdGVyLFxyXG4gICAgICAgICAgICB1cGRhdGVCYXNpYzogdXBkYXRlQmFzaWMsXHJcbiAgICAgICAgICAgIHVwZGF0ZVBhc3N3b3JkOiB1cGRhdGVQYXNzd29yZCxcclxuICAgICAgICAgICAgcmVzZXRQYXNzd29yZDogcmVzZXRQYXNzd29yZCxcclxuICAgICAgICAgICAgZm9yZ290UGFzc3dvcmQ6IGZvcmdvdFBhc3N3b3JkXHJcbiAgICAgICAgfTtcclxuICAgIH0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
